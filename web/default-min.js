var arrGerarCustom=[],uploadFile="",draft="",chartAnimation=!0,chartRenderer="canvas",sticky="N",ace_editor,timer_rel="",mousedown=!1,v_shift=!1,vision="in",touchdrag=1,touchdragY=0,respostaAjax="",tela="DEFAULT",textTalk="",dscript="",error="false",time="",msgtime="",cursorx="",cursory="",colunas="",timeout=0,tr="",auto_refresh="",notify=new Object,lasturl="",alpha="",dashlocation="",dashorder="",projecoes="",selectedb="";const PACKAGES=["UPLOAD","FCL","BRO","FUN","UPQUERY","IMP","GBL","OBJ","UP_REL","AUX","COM","CORE"],FILES=["JS","CSS"];var pell,xmlhttp;xmlhttp=new XMLHttpRequest;var completo=new Array,down,up,cliq;function eventos2(e){if(e.classList.contains("relatorio")){clearInterval(timer_rel);var t=e.id.replace("trl","");-1!=document.getElementById(t+"_button").innerHTML.indexOf("EXECUTANDO")&&(timer_rel=setInterval(function(){call("lista_rel","prm_objeto="+t+"&prm_screen="+tela+"&prm_cod=&prm_lista=check","up_rel").then(function(e){document.getElementById(t+"_button").innerHTML=e,-1==e.indexOf("EXEC")&&(clearInterval(timer_rel),setTimeout(function(){document.getElementById(t+"_button").classList.remove("loading"),alerta("feed-fixo",TR_RG),call("lista_rel","prm_objeto="+t+"&prm_screen="+tela+"&prm_cod="+t+"&prm_lista=file","up_rel").then(function(e){document.getElementById(t+"_lista").innerHTML=e})},1e3))})},1e3))}if(e.querySelector(".wd_move")){var n=e.querySelector(".wd_move");-1!=e.id.indexOf("trl")||-1!=e.id.indexOf("temp")?(n.addEventListener("mousedown",function(){e.style.setProperty("opacity","0.7")}),n.addEventListener("mouseup",function(){e.style.setProperty("opacity","1")}),n.addEventListener("touchstart",function(){e.style.setProperty("opacity","0.7")}),n.addEventListener("touchend",function(){e.style.setProperty("opacity","1")})):(n.addEventListener("mousedown",function(){invisible_touch(this.parentNode.id,"start")}),n.addEventListener("mouseup",function(){invisible_touch(this.parentNode.id,"stop")}),n.addEventListener("touchstart",function(){invisible_touch(this.parentNode.id,"start")}),n.addEventListener("touchend",function(){invisible_touch(this.parentNode.id,"stop")})),n.addEventListener("dblclick",function(){curtain(""),scale(this.id.replace("_ds",""))})}}function appendar(e,t,n){loading("x");var a="";call("show_objeto",e,"obj").then(function(r){MAIN;0!=dashlocation.length&&-1==e.indexOf("prm_drill=Y")&&(document.getElementById(dashlocation),dashlocation="");var o=document.createElement("div");o.innerHTML=r,a=o.children[0].id;var l=MAIN;t?l=document.getElementById(t):n.length>0?l=document.getElementById(n):document.querySelector(".movingarticle")&&-1==e.indexOf("prm_drill=Y")&&(l=document.querySelector(".movingarticle")),l.appendChild(o.children[0])}).then(function(){LAYER&&LAYER.classList.contains("ativo")&&loading(),alerta("feed-fixo",TR_OC),dashorder="";let e=get(a);e.getAttribute("data-left"),e.getAttribute("data-top");(e.classList.contains("front")||e.classList.contains("file"))&&ajustar(a),(e.classList.contains("grafico")||e.classList.contains("medidor")||e.classList.contains("dados"))&&renderChart(a)}).then(function(){let e=get(a);(e.classList.contains("front")||e.classList.contains("full"))&&topDistance(a),eventos(e)})}function ajustar(e){if(void 0!==e&&document.getElementById(e+"c")){if(document.getElementById(e+"c").classList.add("sticky"),document.getElementById(e+"_ds")){var t=document.getElementById(e+"_ds"),n=t.innerHTML;t.innerHTML="_",t.innerHTML=n,document.getElementById(e+"c").addEventListener("click",click_evento),document.getElementById(e+"c").addEventListener("dblclick",dbl_click_evento),document.getElementById(e+"c").addEventListener("mouseenter",function(){imgurlOver(e+"c")});var a=document.getElementById(e+"c").querySelectorAll(".print");for(let e=0;e<a.length;e++)a[e].parentNode.setAttribute("style",a[e].innerHTML)}delete window.obj}}function imgurlOver(e){var t=document.getElementById(e).querySelectorAll("[data-url]:not([data-imglinked]");for(let e=0;e<t.length;e++)t[e].addEventListener("mouseenter",over_evento),t[e].addEventListener("mouseleave",out_evento),t[e].setAttribute("data-imglinked","true")}function ajustaIframe(e){document.getElementById(e+"header")||(startTimer=setInterval(function(){if(null!=document.getElementById(e+"c")){var t=document.getElementById(e+"c").cloneNode(!0);t.id="";var n=document.getElementById(e+"c").getElementsByTagName("thead");if(n[0]){for(let e=0;e<n.length;e++)n[e].style.visibility="collapse";document.getElementById(e+"header").appendChild(t)}if(document.getElementById(e+"ds")){var a=document.getElementById(e+"_ds"),r=a.innerHTML;a.innerHTML="_",a.innerHTML=r}clearInterval(startTimer),document.getElementById(e+"c").addEventListener("click",click_evento),document.getElementById(e+"c").addEventListener("dblclick",dbl_click_evento),smartScroll(e)}},10))}function smartScroll(e){if(document.getElementById(e+"dv2")){var t=new Array;t[0]=document.getElementById(e+"dv2"),t[1]=document.getElementById(e+"fixed"),t[2]=document.getElementById(e+"c"),t[3]=document.getElementById(e+"header"),t[4]=document.getElementById(e);var n=t[0].getAttribute("data-maxwidth"),a=t[1].children.length,r=t[0].getAttribute("data-maxheight"),o=t[0].clientHeight+t[3].clientHeight,l=o-19+"px",i=o-3+"px";if(a>0){var d=t[1].querySelectorAll("ul"),s=d.length;t[0].addEventListener("scroll",function(){for(let e=0;e<s;e++)d[e].style.marginTop="-"+t[0].scrollTop+"px"})}t[1].addEventListener("scroll",function(){t[0].style.setProperty("margin-top","-"+this.scrollTop+"px")}),(t[2].clientWidth>n||t[2].clientWidth>t[0].clientWidth)&&(t[0].addEventListener("scroll",function(){t[3].scrollLeft=t[0].scrollLeft,this.scrollLeft>"210"&&-1==t[0].parentNode.className.indexOf("scaled")?t[1].getAttribute("data-width")>t[3].clientWidth?t[1].style.setProperty("width",t[3].clientWidth+"px"):t[1].style.setProperty("width",parseInt(t[1].getAttribute("data-width"))+1+"px"):t[1].style.setProperty("width","0")}),t[2].addEventListener("mouseenter",function(){t[0].classList.add("flow"),r<t[2].clientHeight&&-1==t[4].className.indexOf("expand")&&t[1].style.setProperty("max-height",l)}),t[4].addEventListener("mouseleave",function(){t[0].classList.remove("flow"),r<t[2].clientHeight&&-1==this.className.indexOf("expand")&&t[1].style.setProperty("max-height",i)})),r<t[2].clientHeight&&(t[2].addEventListener("mouseenter",function(){t[0].style.setProperty("overflow-y","auto"),-1==PRINCP.className.indexOf("mac")&&-1==PRINCP.className.indexOf("mobile")?(t[2].clientWidth&&r<t[2].clientHeight&&t[2].clientWidth>n&&t[0].classList.add("padding"),document.getElementById(e+"dv2").getAttribute("data-maxheight")<t[2].clientHeight&&t[2].clientWidth<n&&t[3].classList.add("margin")):-1==navigator.userAgent.indexOf("Chrome")?t[2].clientWidth<parseInt(t[0].style.maxWidth)&&t[0].classList.remove("padding"):(t[2].clientWidth>n&&t[0].classList.add("padding"),t[2].clientWidth<n&&t[3].classList.add("margin"))}),t[4].addEventListener("mouseleave",function(){t[0].style.setProperty("overflow-y","hidden"),t[0].classList.remove("padding"),t[2].clientWidth<n&&t[3].classList.remove("margin")}))}}function apscreen(e,t){var n,a=new XMLHttpRequest;a.open("get",e,"false"),n="in"==t?"in":t,a.onreadystatechange=function(){if(4==a.readyState){if(-1!=a.responseText.indexOf("LOGOUT"))return void logout();MAIN.innerHTML=a.responseText,icarrega("dwu.fcl.ajscreen?prm_screen="+n),MAIN.children[0]&&"data_list"==MAIN.children[0].id&&ajustar(MAIN.children[0].className)}},a.send(null)}function apOthers(e,t){var n=new XMLHttpRequest;n.open("get",e,"true"),n.onreadystatechange=function(){switch(t){case"space":document.getElementById("space")?document.getElementById("space").innerHTML=n.responseText:(document.getElementById("space-options").innerHTML=n.responseText,0==n.responseText.length?document.getElementById("space-options").parentNode.style.setProperty("display","none"):document.getElementById("space-options").parentNode.style.setProperty("display","inline"));break;case"float":-1!=n.responseText.indexOf("div")&&(document.getElementById("float-icon").className="visible")}},n.send(null)}function mac(){-1!=navigator.userAgent.toString().toLowerCase().indexOf("mac")&&PRINCP.setAttribute("class","mac"),(-1!=navigator.userAgent.toString().toLowerCase().indexOf("iphone")||-1!=navigator.userAgent.toString().toLowerCase().indexOf("ipod")||-1!=navigator.userAgent.toString().toLowerCase().indexOf("android"))&&PRINCP.setAttribute("class","mobile")}function callnotify(e,t,n){notify.obj.body=t,new Notification(e,notify.obj)}function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.body.mozRequestFullScreen.call(document.body):document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}document.getElementById("princp")&&("mobile"==document.getElementById("princp").className?(down="touchstart",up="touchend",cliq="touchend"):(down="mousedown",up="mouseup",cliq="click")),document.addEventListener(cliq,clickStart),Notification.requestPermission(function(){notify.obj={body:"",icon:"dwu.fcl.download?arquivo=ipad.png"},notify.permission=Notification.permission});var orient="";function toexcel(e){var t=document.createElement("a");t.id="excel",MAIN.appendChild(t);var n="data:application/vnd.ms-excel;base64,",a='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>\x3c!--[if gte mso 9]><xml "encoding=utf-8"><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',r=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},o=document.getElementById(e+"dv2"),l=document.createElement("table");l.innerHTML=o.innerHTML;var i=l.querySelectorAll(".invisible"),d=i.length;for(let e=0;e<d;e++)i[e].parentNode.removeChild(i[e]);if(document.getElementById(e)){var s=document.getElementById(e).getElementsByTagName("style"),c=s.length,m="";for(let e=0;e<c;e++)s[e]&&-1!=s[e].innerHTML.indexOf("display: none;")&&(m+=s[e].innerHTML);var u=l.getElementsByTagName("tr"),p=u.length;for(let t=0;t<p;t++)u[t]&&("custom-conteudo"!=document.getElementById(e).parentNode.id&&(!u[t].children[0].hasAttribute("style")||u[t].children[0].getAttribute("colspan")>1||0!=u[t].className.indexOf("nivel"))&&(u[t].children[0].hasAttribute("data-ordem")||(u[t].children[0].getAttribute("colspan")<2?u[t].children[0].remove():u[t].children[0].setAttribute("colspan",parseInt(u[t].children[0].getAttribute("colspan"))-1))),u[t].classList.contains("total")?(-1!=m.indexOf("li.total { display: none; }")||-1!=m.indexOf("tr.total { display: none; }")||u[t].classList.contains("st-S"))&&(u[t].className="remove"):u[t].classList.contains("total normal")&&(-1==m.indexOf("li.total.normal { display: none; }")&&-1==m.indexOf("tr.total.normal { display: none; }")||(u[t].className="remove")))}var g=l.querySelectorAll(".remove, .inv"),f=g.length;for(let e=0;e<f;e++)g[e].remove();var v=l.getElementsByTagName("td"),y=v.length;for(let e=0;e<y-1;e++)v[e]&&(!(v[e].title.length>v[e].innerHTML.length)||v[e].classList.contains("setadown")&&v[e].classList.contains("seta")||(v[e].innerHTML=v[e].title),-1!=v[e].innerHTML.indexOf("background")&&(v[e].innerHTML=""),-1==v[e].innerHTML.indexOf("-")&&-1==v[e].innerHTML.indexOf(".")||v[e].setAttribute("style","mso-number-format:\\@"),v[e].setAttribute("onclick",""),v[e].removeAttribute("data-i"),v[e].removeAttribute("data-p"),v[e].removeAttribute("data-subquery"),v[e].removeAttribute("data-ordem"),v[e].removeAttribute("data-valor"),-1!=v[e].innerHTML.indexOf("!important")&&v[e].parentNode.removeChild(v[e]));for(let e=0;e<y-1;e++)v[e]&&(v[e].classList.contains("setadown")||v[e].classList.contains("seta"))&&v[e].remove();var h={worksheet:"Consulta",table:l.innerHTML};if(navigator.msSaveBlob)return navigator.msSaveBlob(new Blob([r(a,h)],{type:n}),e.substr(0,e.length-1)+".xls");document.getElementById("excel").href=n+window.btoa(unescape(encodeURIComponent(r(a,h).replace(/&amp;/g,"E").replace(/&/g,"E").replace(/onclick="" class="dir" data-p=""/g,"").replace(/´/g," ").replace(/onclick=""/g,"").replace(/class="setadown" data-subquery=""/g,"")))),document.getElementById("excel").download=e.substr(0,e.length-1)+".xls",document.getElementById("excel").click(),setTimeout(function(){MAIN.removeChild(t)},1e3)}function scale(e,t){var n=document.getElementById(e);if(document.getElementsByTagName("ARTICLE").length>0&&"A"==ADMIN){if(-1==e.indexOf("trl"))if(MAIN.querySelector(".selected"))if(MAIN.querySelector(".selected").id!=e){if(n.parentNode.id==MAIN.querySelector(".selected").parentNode.id){var a=MAIN.querySelector(".selected"),r=a.style.getPropertyValue("order"),o=n.style.getPropertyValue("order");n.style.setProperty("order",r),a.style.setProperty("order",o);var l=n.parentNode.children;for(let e=0;e<l.length;e++)ajax("fly","salva_posicao","prm_objeto="+l[e].id+"&prm_screen="+n.parentNode.id+"&prm_posx="+l[e].style.getPropertyValue("order")+"&prm_posy=&prm_zindex=",!1);MAIN.querySelector(".selected").classList.toggle("selected")}}else n.classList.toggle("selected");else n.classList.toggle("selected")}else if(-1!=n.className.indexOf("scaled")||-1!=n.className.indexOf("img")||-1!=n.className.indexOf("icone")||-1!=n.className.indexOf("texto")||-1!=n.className.indexOf("float"))n.getAttribute("data-left")&&n.style.setProperty("left",n.getAttribute("data-left")),n.getAttribute("data-top")&&n.style.setProperty("top",n.getAttribute("data-top")),n.classList.remove("scaled"),n.style.transform="",n.style.webkitTransform="",n.style.zIndex=n.getAttribute("data-zindex"),localStorage.setItem("pos",0),"direct"==t&&(PRINCP.style.setProperty("overflow","visible"),PRINCP.style.removeProperty("height"),document.getElementById("html").style.setProperty("overflow","visible"),document.getElementById("layer3").style.setProperty("height","0"),document.getElementById("prev").style.setProperty("display","none"),document.getElementById("next").style.setProperty("display","none"));else if(-1!=n.className.indexOf("front")){for(;"STYLE"==document.getElementById(e).lastElementChild.tagName;)document.getElementById(e).lastElementChild.remove();setTimeout(function(){topDistance(e)},1e3),-1==n.className.indexOf("expand")?n.className=n.className+" expand":n.className=n.className.replace(" expand","")}else-1!=n.className.indexOf("relatorio")||n.classList.contains("drill")||(n.classList.add("scaled"),setTimeout(function(){for(let e=35;e>12;e--)if(n.offsetWidth*(e/10)+e/10*80<window.innerWidth&&n.offsetHeight*(e/10)+15<window.innerHeight){n.style.transform="scale("+e/10+")",n.style.webkitTransform="scale("+e/10+")";break}n.style.setProperty("left",window.innerWidth/2-n.offsetWidth/2+"px"),n.style.setProperty("top",window.innerHeight/2-n.offsetHeight/2+"px"),n.style.zIndex="800",curtain("only"),"direct"==t&&(PRINCP.style.setProperty("overflow","hidden"),PRINCP.style.setProperty("height","inherit"),document.getElementById("html").style.setProperty("overflow","hidden"),document.getElementById("layer3").style.setProperty("height","100%"),document.getElementById("prev").style.setProperty("display","flex"),document.getElementById("next").style.setProperty("display","flex"))},100))}function upload(e){var t=document.getElementById(e).files;for(let e=0;e<t.length;e++){var n=new Blob([t[e]]),a=new FormData;a.append("prm_arquivo",n,"123"),ajax("upload","painel",a,!1,t[e].type,t[e].size)}}function destaque(e,t,n){var a,r=document.getElementById("destaque-usuario-"+e).title,o=document.getElementById("destaque-objeto-"+e).title,l=document.getElementById("destaque-coluna-"+e).title,i=document.getElementById("destaque-condicao-"+e).title,d=encodeURIComponent(document.getElementById("destaque-conteudo-"+e).title.trim()),s=document.getElementById("destaque-tipo-"+e).getAttribute("data-default"),c=document.getElementById("destaque-icorfundo-"+e).getAttribute("data-default"),m=document.getElementById("destaque-icorfonte-"+e).getAttribute("data-default");if("DELETE"!=t){var u=document.getElementById(n);if(a=encodeURIComponent(u.value.trim()),u.setAttribute("data-default",u.value.trim()),"SELECT"==u.tagName)for(let e=0;e<u.children.length;e++)u.children[e].value.trim()==u.value.trim()?u.children[e].setAttribute("selected","selected"):u.children[e].removeAttribute("selected")}else a="";call("edit_blink","prm_usuario="+r+"&prm_objeto="+o+"&prm_coluna="+l+"&prm_condicao="+i+"&prm_conteudo="+d+"&prm_valor="+a+"&prm_tipo="+s+"&prm_corfundo="+c+"&prm_corfonte="+m+"&prm_alter="+t).then(function(n){document.getElementById("fechar_sup").setAttribute("data-reloado",o),alerta("feed-fixo",n),-1==n.indexOf("FAIL")&&"DELETE"==t&&document.getElementById("destaque-usuario-"+e).parentNode.parentNode.remove()})}function input(e,t){var n,a=e.which,r=e.keyCode;switch(t){case"rotulo":return!0;case"default":return 92!=a;case"integer":return 13==a?(e.target.blur(),!1):0==a&&37!=r&&39!=r||(0==a||8==a||-1!="0123456789".indexOf(String.fromCharCode(a)));case"hora":return 13==a?(e.target.blur(),!1):0==a&&37!=r&&39!=r||(0==a||8==a||-1!="0123456789:".indexOf(String.fromCharCode(a)));case"volume":return 0==a||8==a||46==a||44==a||-1!="0123456789".indexOf(String.fromCharCode(a));case"valor":return 0==a||8==a||44==a||-1!="0123456789".indexOf(String.fromCharCode(a));case"number":return 13==a?(e.target.blur(),!1):0==a&&37!=r&&39!=r?(e.target.blur(),!0):0==a||8==a||44==a&&-1==e.target.innerHTML.indexOf(",")||45==a||-1!="0123456789".indexOf(String.fromCharCode(a));case"nobr":return n=new RegExp("^[<*>]+"),0==a||8==a||46==a||0==n.test(String.fromCharCode(a));case"email":return n=new RegExp("^[a-zA-Z0-9-_@!&#]+"),0==a||8==a||46==a||1==n.test(String.fromCharCode(a));case"login":return n=new RegExp("^[a-zA-Z0-9]+"),0==a||8==a||46==a||1==n.test(String.fromCharCode(a));case"ID":return n=new RegExp("^[a-zA-Z0-9_]+"),0==a||8==a||46==a||1==n.test(String.fromCharCode(a))}}window.addEventListener("resize",function(){window.orientation!=orient&&(setTimeout(function(){for(var e=document.querySelectorAll(".dragme"),t=e.length,n=0;n<t;n++)document.getElementById("dados_"+e[n].id)&&renderChart(e[n].id)},10),orient=window.orientation)}),document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState?(vision="out",clearInterval(msgtime)):(vision="in",clearInterval(msgtime),ajax("data-","check_text_post","",!0,"verify-post"))});var zindex_abs=5;function mask(e,t,n){var a=document.getElementById(e),r=String.fromCharCode(t.which),o=a.selectionEnd,l=a.selectionEnd,i=a.selectionStart,d=new RegExp("^[a-zA-Z0-9]+"),s=n.split(""),c=a.value.split(""),m=s.length,u=[];for(let e=0;e<m;e++)if(o==e){if("8"==t.which){if(","==c[e-1]||"."==c[e-1])return a.selectionEnd=a.selectionEnd-1,t.preventDefault(),!1;i=l-=1}else if("46"==t.which){if(","==c[e]||"."==c[e])return a.selectionEnd=a.selectionEnd+1,a.selectionStart=a.selectionStart+1,t.preventDefault(),!1;i=l}else"G"==s[e]&&(u[e]=".",i=l+=1,e+=1),"D"==s[e]&&(u[e]=",",i=l+=1,e+=1);d.test(r)?(u[e]=r,i=","==c[e+1]||"."==c[e+1]?l+=2:l+=1):(u[e]=c[e],u[e-1]=c[e-1])}else u[e]=c[e];a.value=u.join(""),(t.which<36||t.which>41)&&(a.selectionEnd=l,a.selectionStart=i)}function mascara(e,t,n,a,r,o,l,i){i&&(38!=i.which&&40!=i.which||i.preventDefault());a=a||"999",o=o||"999999999999",l=l||"999999999999",r=r||"2",t=t||"R$",n=n||",";var d=e.value.replace(n,"").replace(t,"").trim(),s=e.selectionEnd;if(d.length<parseInt(r)+1)d.length<=1?e.value=(t+" 0"+n+"0"+d).trim():e.value=(t+" 0"+n+d).trim();else{var c=d.slice(0,e.value.replace(t,"").trim().length-(parseInt(r)+1)),m=d.slice(d.length-parseInt(r));"00"!=c&&""!=c||(c="0"),c.length>parseInt(a)&&(c=d.slice(1,c.length)),i&&(38==i.which&&(e.selectionEnd>e.value.indexOf(n)&&(m=("000000000"+(parseInt(m)+1)).substr(-r)),e.selectionEnd<=e.value.indexOf(n)&&(c=parseInt(c)+1)),40==i.which&&(e.selectionEnd>e.value.indexOf(n)&&parseInt(m)>0&&(m=("000000000"+(parseInt(m)-1)).substr(-r)),e.selectionEnd<=e.value.indexOf(n)&&parseInt(c)>0&&(c=parseInt(c)-1))),parseInt(c)>parseInt(o)&&(c=o),parseInt(m)>parseInt(l)&&(m=l),e.value=(t+" "+[parseInt(c),n,m].join("")).trim()}t.trim().length>0?s<t.length+1?(e.selectionEnd=t.length+1,e.selectionStart=t.length+1):d.length<1?e.selectionEnd=e.value.length:e.selectionEnd=s:e.selectionEnd=s}function titulo(e,t){document.getElementById("titulo").innerHTML=e.title,e.parentNode.parentNode.id&&"prefdrop"!=e.parentNode.parentNode.id&&(document.getElementById("info").innerHTML=e.parentNode.parentNode.id),"c"==t&&(document.getElementById("painel").innerHTML="")}function enc(e){return encodeURIComponent(e.replace(/\\/g,"").replace(/"/g,""))}function carrega(e){if(document.getElementById("content").innerHTML="",0!=e.length){loader("content");var t="dwu.fcl."+e;document.getElementById("frame").src=t}}function carregaPainel(e,t){document.getElementById("painel");call("menu","prm_menu="+e+"&prm_default="+(t=t||"")).then(function(e){document.getElementById("painel").innerHTML=e})}function carregaPainel_frame(e,t){var n=document.createElement("iframe");n.id="newframe",n.src=e,t.trim().length>1&&(n.className=t),n.style.setProperty("width","800px"),n.style.setProperty("height","26px"),document.getElementById("painel").innerHTML="",document.getElementById("painel").appendChild(n)}function icarrega2(){var e,t="",n=document.querySelectorAll(".dragme.front"),a=n.length;for(e=0;e<a;e++){if(t=n[e].id,document.getElementById(t)){if(document.getElementById(t+"c")){var r=(c=document.getElementById(t+"c").querySelectorAll(".print")).length;for(let e=0;e<r;e++)c[e].parentNode.setAttribute("style",c[e].innerHTML)}if(document.getElementById(t+"c")){var o=document.getElementById(t+"c");o.addEventListener("click",click_evento),o.addEventListener("dblclick",dbl_click_evento),o.addEventListener("mouseenter",function(){imgurlOver(this.id)})}}if(topDistance(t),document.getElementById(t+"_ds")){var l=document.getElementById(t+"_ds"),i=l.innerHTML;l.innerHTML="_",l.innerHTML=i}if("undefined"!=typeof ajuste&&ajuste.children[3]){var d=ajuste.children[3].getElementsByTagName("td"),s=d.length;for(let e=0;e<s;e++)d[e].removeAttribute("id"),d[e].removeAttribute("data-valor");if(document.getElementById(t+"c")&&(document.getElementById(t+"c").addEventListener("click",click_evento),document.getElementById(t+"c").addEventListener("dblclick",dbl_click_evento),document.getElementById(t+"c").addEventListener("mouseleave",out_evento),document.getElementById(t+"c").addEventListener("dblclick",dbl_click_evento)),smartScroll(t),document.getElementById(t+"c")){var c,m=(c=document.getElementById(t+"c").querySelectorAll(".print")).length;for(let e=0;e<m;e++)c[e].parentNode.setAttribute("style",c[e].innerHTML)}document.getElementById(t).getAttribute("data-left"),document.getElementById(t).getAttribute("data-top")}}document.querySelector(".full")?setTimeout(fullscreen,100):(dashAjuste(),renderizaGraficos());var u=document.getElementsByClassName("dragme geomapa");for(let e=0;e<u.length;e++)initMap(u[e].id);try{LAYER&&"ativo"==LAYER.className&&loading("x")}catch(e){console.log("nolayer")}}function renderizaGraficos(){var e=document.querySelectorAll(".dragme.grafico, .dragme.dados, .dragme.medidor"),t=e.length;for(let n=0;n<t;n++)renderChart(e[n].id)}function curtain(e){var t=document.getElementById("layer2");"enabled"==e?(document.getElementById("msg").style.opacity=0,t.classList.add("ativo"),telasup.style.setProperty("overflow","visible"),telasup.style.setProperty("transform","scale(1)")):"only"==e?t.className="ativo":(t.classList.remove("ativo"),telasup.style.setProperty("overflow","hidden"),telasup.style.setProperty("transform","scale(0)"),document.getElementById("content").innerHTML="",document.getElementById("painel").innerHTML="")}const ABOUT="Sistema desenvolvido por, Upquery do Brasil - Luiz Fabiano dos Santos(back-end), João Henrique Rocha Machado(front-end)";function dashAjuste(e){var t;if(e)(t=document.getElementById(e)).addEventListener("mousedown",dashSectionDown),t.addEventListener("mouseenter",dashSectionEnter),t.addEventListener("mouseleave",dashSectionLeave),articleAjuste(e);else{var n=(t=document.getElementsByTagName("SECTION")).length;if(n>0)for(let e=0;e<n;e++)"A"==ADMIN&&(t[e].addEventListener("mousedown",dashSectionDown),t[e].addEventListener("mouseenter",dashSectionEnter),t[e].addEventListener("mouseleave",dashSectionLeave)),articleAjuste(t[e].id)}}function articleAjuste(e){var t=document.getElementById(e).getElementsByTagName("ARTICLE"),n=t.length;for(let e=0;e<n;e++){var a=t[e];"A"==ADMIN&&(a.addEventListener("mousedown",dashArticleDown),a.addEventListener("mouseenter",dashArticleEnter),a.addEventListener("mouseleave",dashArticleLeave))}}var objatual="";function chart(e){var t=document.getElementById("gxml_"+e),n=document.getElementById("dados_"+e);if(get("prm_clear")&&(chartAnimation=!1),document.getElementById(e+"_ERR"))document.getElementById("ctnr_"+e).innerHTML=document.getElementById(e+"_ERR").innerHTML;else if(document.getElementById("dados_"+e)&&document.getElementById("gxml_"+e)){var a,r="bar";"BARRAS"==n.getAttribute("data-tipoobj")?a="bar":"COLUNAS"==n.getAttribute("data-tipoobj")?a="column":(r="line",a="line");var o=document.getElementById("atributos_"+e),l="",i="";o.getAttribute("data-stacked")&&(l=o.getAttribute("data-stacked"),o.getAttribute("data-stacked_total")&&(i=o.getAttribute("data-stacked_total")));var d=echarts.init(document.getElementById("ctnr_"+e),null,{renderer:chartRenderer,height:document.getElementById("ctnr_"+e).clientHeight,width:document.getElementById("ctnr_"+e).clientWidth});if(t.children[0]){var s=t.children[0].innerHTML.replace(/(\r\n|\n|\r)/g," ");s=s.substr(0,s.trim().length-1);var c=JSON.parse("{"+s+"}"),m=[],u=[],p=[];for(let e in c)m.push(c[e].valores),u.push(c[e].colunas),p.push(c[e].cod);var g=JSON.parse("{"+t.children[1].innerHTML.replace(/(\r\n|\n|\r)/gm,"")+"}"),f=n.getAttribute("data-coluna").replace("(BR)"," ").replace("<BR>"," "),v=n.getAttribute("data-agrupadores").replace("<BR>"," ").indexOf("|"),y=n.getAttribute("data-sec").replace("<BR>"," "),h=o.getAttribute("data-rotacao"),_=o.getAttribute("data-decimal"),b=o.getAttribute("data-abreviacao"),E=o.getAttribute("data-cursor"),I=o.getAttribute("data-xpos"),x=o.getAttribute("data-cor-coluna").split("|"),B=n.getAttribute("data-ccoluna-hex").split("|"),L=o.getAttribute("data-nodesc"),A=o.getAttribute("data-posicao"),N=o.getAttribute("data-cor"),T=o.getAttribute("data-mark-max"),S=o.getAttribute("data-mark-min"),k=o.getAttribute("data-mark-media"),w=o.getAttribute("data-zoom");w="S"==w;var C="";o.getAttribute("data-espacamento")&&o.getAttribute("data-espacamento").replace("|||","").length>0&&(C=o.getAttribute("data-espacamento"));var j,R,M=o.getAttribute("data-hidden");for("line"==r&&(j=-1==v?o.getAttribute("data-cor_linha")||"#000000":o.getAttribute("data-cor_linha")||"#87CEFA"),R=o.getAttribute("data-cores").length<1?["#87CEFA","#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0","#FF7F50","#00D878","#AAAAAA","#DDDD55","#065182","#DA70D6","#FF6347","#AA5511","#CCCC44","#DA7400","#6663BB","#FAE982","#F5C65D","#AAA43B","#6055DD"]:o.getAttribute("data-cores").split("|");R.length<100;)R.push(R[R.length-1]);var O=(n.getAttribute("data-agrupadores").replace(/(\r\n|\n|\r)/g," ")+"|"+n.getAttribute("data-sec").replace(/(\r\n|\n|\r)/g," ")).replace("<BR>"," ").split("|");O=O.filter(e=>e);var P="";-1==v&&0==y.length&&(P=n.getAttribute("data-agrupadores").replace("<BR>"," "));var H,q,D=new Object,F=new Object;F.nameLocation=I,F.nameGap=20,o.getAttribute("data-ymin").trim().length>0&&(D.min=o.getAttribute("data-ymin")),H="S"==L?p:u,"bar"==r&&"bar"==a?(D.type="category",D.name=f,D.axisLabel={interval:0,rotate:h,textStyle:{fontSize:10}},D.data=H,F.type="value",F.name=P):(F.type="category",F.name=f,F.axisLabel={interval:0,rotate:h,textStyle:{fontSize:10}},F.data=H,D.type="value",D.name=P),q=parseInt(h)>80?[30,80,120,80]:parseInt(h)>40?[30,80,80,80]:[30,80,40,80];var U=C.split("|");if(C.length>0&&U.length<5)for(let e=0;e<U.length;e++)q[e]=2==e&&1==w?parseInt(U[e])+50:U[e];var z=[l,M,a,_,R,B,y,o.getAttribute("data-cascata"),g,j,b,A,"","",T,S,k,N],W={dataZoom:{show:w,bottom:"6px",handleIcon:"path://M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z"},grid:{y:q[0],x2:q[1],y2:q[2],x:q[3]},color:R,tooltip:{trigger:"axis",formatter:function(e){var t=[],n=0;if(e.length>1){t.push(e[0].name);for(let a=0;a<e.length;a++)t.push(e[a].seriesName+": "+Number(e[a].data).toLocaleString(void 0,{minimumFractionDigits:parseInt(_)})),n+=parseFloat(e[a].value);i.length>0&&t.push(i+": "+Number(n).toLocaleString(void 0,{minimumFractionDigits:parseInt(_)}))}else e[0]&&t.push(e[0].name+": "+Number(e[0].data).toLocaleString(void 0,{minimumFractionDigits:parseInt(_)}));return t.join("<br>")},axisPointer:{type:E}},legend:{data:O},noDataLoadingOption:{text:"inválido",effect:7},xAxis:[F],yAxis:[D],bottom:10,series:stackLista(m,v,O,a,p,x,f,H,z)};if(d.setOption(W,{notMerge:!0}),d.on("click",clicker),document.getElementById(e+"more")){var Y=document.createElement("a");Y.classList.add("download_button"),document.getElementById(e.replace("trl","")+"_ds")?Y.setAttribute("download",document.getElementById(e.replace("trl","")+"_ds").innerText.replace(/ /g,"_").toLowerCase()):Y.setAttribute("download",document.getElementById(e+"_ds").innerText.replace(/ /g,"_").toLowerCase()),setTimeout(function(){Y.href=d.getDataURL({type:"png",pixelRatio:1,backgroundColor:"#fff"})},5e3),document.getElementById(e+"more")&&document.getElementById(e+"more").querySelector(".page_png").appendChild(Y)}}}}function clicker(e){isNaN(e.value)||setTimeout(function(){var t,n=document.getElementById("dados_"+objatual),a=document.getElementById("gxml_"+objatual);if(e.data.sigla)t=e.data.sigla;else{var r=a.children[0].innerHTML.replace(/(\r\n|\n|\r)/g," ");r=r.substr(0,r.trim().length-1);var o=JSON.parse("{"+r+"}"),l=[];for(let e in o)l.push(o[e].cod);t=l[e.dataIndex]}var i=n.getAttribute("data-colunareal")+"|"+t+"|"+n.getAttribute("data-filtro");i=i.replace("||","|");var d=n.getAttribute("data-drill");if(-1!=i.indexOf("ACUMULADO")){let e=[],t=JSON.parse("{"+document.getElementById("gxml_"+objatual).children[0].innerText.substr(0,document.getElementById("gxml_"+objatual).children[0].innerText.trim().length-1)+"}");for(let n in t)"ACUMULADO"!=t[n].cod&&e.push(t[n].cod);var s=[];let a=n.getAttribute("data-colunareal");e.forEach(function(e){s.push(a+"|$[DIFERENTE]"+e)}),i=s.join("|")}-1==d.indexOf("MULTI")?d>0&&(get("drill_go").value=i,drillfix(e,objatual,i)):d.length>0&&(remover(d+"trl"),loading(),ajax("append","show_objeto","prm_drill=Y&prm_objeto="+d+"&prm_posx="+cursorx+"px&prm_zindex="+zindex_abs+"&prm_posy="+cursory+"px&prm_parametros="+encodeURIComponent(i.replace(/%2D/g,"-").replace(/%2B/g,"+"))+"&prm_screen="+tela+"&prm_track="+d+"&prm_objeton=",!0,"main","",d.replace("trl","")+"trl","obj"))},100)}function efeitoCondicoes(e,t,n,a,r,o,l,i){for(let a in e){let d=e[a].coluna.replace(/(\r\n|\n|\r)/gm,"").replace(/ /g,""),s=t.join("||").replace(/(\r\n|\n|\r)/gm,"").replace(/ /g,"").split("||"),c=o.replace(/(\r\n|\n|\r)/gm,"");if(-1!=s.indexOf(d)){let t;switch(t=isNaN(parseInt(e[a].valor,1))?e[a].valor:parseFloat(e[a].valor),e[a].condicao){case"IGUAL":if(t==n||-1!=r.indexOf(t))return e[a].cor;break;case"MAIOR":if(n>t)return e[a].cor;break;case"MENOR":if(n<t)return e[a].cor;break;case"DIFERENTE":if(n!=t)return e[a].cor;break;case"MAIOROUIGUAL":if(n>=t)return e[a].cor;break;case"MENOROUIGUAL":if(n<=t)return e[a].cor;break;case"COLUNA":return e[a].cor}}if(-1!=c.indexOf(d)||-1!=i.indexOf(d)){let t;t=isNaN(parseInt(e[a].valor,1))?e[a].valor:parseFloat(e[a].valor);let n=l;switch(e[a].condicao){case"IGUAL":if(t==n||-1!=r.indexOf(t))return e[a].cor;break;case"MAIOR":if(n>t)return e[a].cor;break;case"MENOR":if(n<t)return e[a].cor;break;case"DIFERENTE":if(n!=t)return e[a].cor;break;case"MAIOROUIGUAL":if(n>=t)return e[a].cor;break;case"MENOROUIGUAL":if(n<=t)return e[a].cor;break;case"COLUNA":return e[a].cor}}}return a}function stackLista(e,t,n,a,r,o,l,i,d){var s,c=d[0],m=d[1],u=(a=d[2],d[3]),p=d[4],g=(d[5],d[6]),f=d[7],v=d[8],y=d[9],h=d[10],_=d[11];meta=d[12],meta_cor=d[13],markMax=d[14],markMin=d[15],markMedia=d[16],cor=d[17],m=m.replace(/(\r\n|\n|\r)/g," ")+"|",s="line"==a?"top":"column"!=a?_||"inside":"S"==c?"inside":_||"top";var b=function(e,t,a,o,d,s){let c={label:{}};return"line"!=o&&(-1==d&&0==s.length?c.color=function(e){var t=p[e.dataIndex];let a=parseFloat(e.data),o=[];o.push(e.name),o.push(r[e.dataIndex]);let d=[];return d.push(...n),d.push(l),t=efeitoCondicoes(v,d,a,t,o,l,i[e.dataIndex],r)}:c.color=function(e){let t=p[e.dataIndex],n=[e.seriesName],a=parseFloat(e.data),o=e.name;return t=efeitoCondicoes(v,n,a,p[e.seriesIndex],o,l,i[e.dataIndex],r)}),c.barBorderColor="#333",c.barBorderWidth=1,c.label.formatter=function(e){return labelTooltip(e.name,e,u,a,"N",0,"N")},c.label.show=e,c.label.position=t,c.label.textStyle={color:cor,fontWeight:"bold"},c},E=function(e,t){let n={label:{}};return n.label.show=e,n.label.position=t,n.label.textStyle={color:cor,fontWeight:"bold"},n};if(-1==t&&0==g.length){var I=[];(T=new Object).type="column"==a?"bar":a,k=e;for(let e=0;e<k.length;e++)k[e]=parseFloat(k[e]).toFixed(u);T.data=k,"S"==f&&(T.areaStyle="{}"),T.dataZoom={},T.dataZoom.type="slider";var x="";get("menup")&&(x=window.getComputedStyle(get("menup")).getPropertyValue("background-color"));var B=[],L={};"S"==markMax&&(L.type="max",L.label={formatter:"MAX",color:"#FFF"},B.push(L));var A={};"S"==markMin&&(A.type="min",A.label={formatter:"MIN",color:"#FFF"},B.push(A));var N={};"S"==markMedia&&(N.type="average",N.symbol="none",N.emphasis={label:{show:!0}},N.label={show:!1,position:"insideStartTop",formatter:function(e){return"MED: "+e.data.value}});let r=!1;return m&&(r=-1==m.indexOf(n+"|")||"S"==m),T.markPoint={itemStyle:{color:x},data:B},"S"==markMedia&&(T.markLine={lineStyle:{type:"dashed"},itemStyle:{color:x},symbol:"none",data:[N]}),"line"!=a?T.itemStyle={normal:b(r,s,h,a,t,g),emphasis:E(r,s)}:(-1==t&&(T.lineStyle={normal:{color:y}}),"S"==f&&(T.areaStyle={normal:{color:y,opacity:"0.2"}}),T.itemStyle={normal:b(r,s,h,a,t,g),emphasis:E(r,s)}),T.animation=chartAnimation,I.push(T),I}I=[];for(let r=0;r<n.length;r++){var T=new Object,S=[],k=e.flat();for(let e=0;e<k.length;e++)k[e].grupo==n[r]&&S.push(parseFloat(k[e].valor).toFixed(u));T.dataZoom={},T.name=n[r].replace("[","").replace("]","");let o=!1;m&&(o=-1==m.indexOf(T.name+"|")||"S"==m),-1!=g.replace(/(\r\n|\n|\r)/g," ").split("|").indexOf(n[r].replace(/(\r\n|\n|\r)/g," "))?"bar"==a||"column"==a?(s="top",T.type="line"):T.type="bar":T.type="column"==a?"bar":a,"bar"==a&&(T.barMinHeight="1"),"bar"!=a&&"column"!=a||(T.stack="S"==c?"SAME":n[r].replace("[","").replace("]","")),T.data=S,"line"!=a?T.itemStyle={normal:b(o,s,h,a,t,g),emphasis:E(o,s)}:("S"==f&&(T.areaStyle={normal:{opacity:"0.2"}}),-1==t&&(T.lineStyle={normal:{color:y}}),T.itemStyle={normal:b(o,s,h,a,t,g),emphasis:E(o,s)}),T.animation=chartAnimation,I.push(T)}return I}function labelTooltip(e,t,n,a,r,o,l){var i=abreviacaoNumerica(t,a),d=(e=e.replace("&amp;","&"),"");return"S"==l&&(d=e+": "),"A"==r?0==n?d+i+" - "+parseFloat(Number(t.value/(o/100))).toFixed(n)+"%":d+i+","+t.value.replace(/-/g,"").split(".")[1]+" - "+parseFloat(Number(t.value/(o/100))).toFixed(n)+"%":"S"==r?e+": "+parseFloat(Number(t.value/(o/100))).toFixed(n)+"%":0==n?d+i:d+i+","+t.value.replace(/-/g,"").split(".")[1]}function abreviacaoNumerica(e,t){var n="";-1!=(a=e.value.toString()).indexOf("-")&&(n="-");var a,r=(a=Number(a).toLocaleString().replace(/-/g,"").split(",")[0]).replace(/\./g,"").length;return"S"==t&&(a=-1!=a.indexOf(".")?parseFloat(a.substr(0,a.indexOf(".")+2))+"":parseFloat(a)+"",r>12?a+="T":r>9?a+="B":r>6?a+="M":r>3&&(a+="K")),n+a}function chartSlice(e,t){var n=document.getElementById("gxml_"+e),a=document.getElementById("dados_"+e);call("charout","prm_parametros="+n.getAttribute("data-parametros")+"&prm_micro_visao="+a.getAttribute("data-visao")+"&prm_objeto="+e.replace("trl","")+"&prm_screen="+tela).then(function(e){n.innerHTML=e}).then(function(){if(document.getElementById(e+"_ERR"))document.getElementById("ctnr_"+e).innerHTML=document.getElementById(e+"_ERR").innerHTML;else if(a&&document.getElementById("gxml_"+e)){var t=echarts.init(document.getElementById("ctnr_"+e),null,{renderer:chartRenderer}),n=document.getElementById("gxml_"+e),r=document.getElementById("atributos_"+e);if(n.children[0]){var o=JSON.parse("{"+n.children[1].innerHTML.replace(/(\r\n|\n|\r)/gm,"")+"}"),l=n.children[0].innerHTML;l=l.substr(0,l.trim().length-1);var i=JSON.parse("{"+l+"}"),d=[],s=[],c=[];for(let e in i)d.push(i[e].valores),s.push(i[e].colunas),c.push(i[e].cod);var m=a.getAttribute("data-coluna"),u=a.getAttribute("data-agrupadores"),p=document.getElementById("ctnr_"+e).clientWidth,g=document.getElementById("ctnr_"+e).clientHeight,f=r.getAttribute("data-cor-coluna").split("|");let M=a.getAttribute("data-ccoluna-hex").split("|");r.getAttribute("data-nodesc");var v=r.getAttribute("data-abreviacao"),y=r.getAttribute("data-cor"),h=r.getAttribute("data-tipo"),_=a.getAttribute("data-funil-sort"),b="";a.getAttribute("data-labelspace")&&(b=a.getAttribute("data-labelspace"));var E,I=r.getAttribute("data-decimal");r.getAttribute("data-hidden")&&(E=-1==r.getAttribute("data-hidden").indexOf("S"));var x="N";r.getAttribute("data-fracao")&&(x=r.getAttribute("data-fracao"));var B,L=[],A=0;switch(B="donut"==h?"pie":h,h){case"funnel":for(let e=1;e<d.length+1;e++){var N=new Object;N.name=s[e-1],N.value=parseFloat(d[e-1]).toFixed(I),N.order=5*e,L.push(N),"S"!=x&&"A"!=x||(A=parseFloat(d[e-1])+parseFloat(A))}L.sort(function(e,t){return e.order>t.order?1:-1});break;default:for(let e=0;e<d.length;e++){let t=new Object;t.name=s[e],t.value=parseFloat(d[e]).toFixed(I),L.push(t),"S"!=x&&"A"!=x||(A=parseFloat(d[e])+parseFloat(A))}}var T,S=function(e){return labelTooltip(e.name,e,I,v,x,A,"S")},k=[30,80,50,80],w=b.split("|");if(b.length>0&&w.length<5)for(let e=0;e<w.length;e++)k[e]=w[e];T=r.getAttribute("data-cores").length<1?["#87CEFA","#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0","#FF7F50","#00D878","#AAAAAA","#DDDD55","#065182","#DA70D6","#FF6347","#AA5511","#CCCC44","#DA7400","#6663BB","#FAE982","#F5C65D","#AAA43B","#6055DD","#81CE55","#A9532B","#5BC114","#CFCE19","#E23C85","#42227B","#EE7443","#9B9113","#F1D890","#53A49B"]:r.getAttribute("data-cores").split("|");for(let e=0;e<c.length;e++)for(let t=0;t<f.length;t++)c[e]==f[t]&&(T[e]=M[t]);var C=[];for(let e=0;e<L.length;e++){let t=[];t.push(m),t.push(u);let n=efeitoCondicoes(o,t,L[e].value,T[e],L[e].name,c[e],c[e],m);C.push(n)}var j={itemStyle:{}};j.itemStyle.normal={},j.itemStyle.emphasis={},j.itemStyle.normal.borderWidth=2,j.itemStyle.normal.label={},j.itemStyle.normal.label.textStyle={},j.itemStyle.normal.label.textStyle.color="#333",j.itemStyle.normal.label.show=E,j.itemStyle.normal.label.formatter=S,j.itemStyle.normal.labelLine={},j.itemStyle.normal.labelLine.show=E,j.itemStyle.emphasis.itemStyle={},j.itemStyle.emphasis.itemStyle.shadowBlur=5,j.itemStyle.emphasis.itemStyle.shadowOffsetX=0,j.itemStyle.emphasis.itemStyle.shadowColor="rgba(0, 0, 0, 0.5)",j.data=L,j.type=B,[].push(j);var R={legendHoverLink:!0,grid:{y:k[0],x2:k[1],y2:k[2],x:k[3]},tooltip:{show:!0,confine:!0,trigger:"item",formatter:function(e){if(e)return labelTooltip(e.name,e,I,v,x,A,"S")}},noDataLoadingOption:{text:"inválido",effect:7},color:C,series:[{type:B,data:L,itemStyle:{normal:{label:{textStyle:{color:y},show:E,formatter:S},labelLine:{show:E}},emphasis:{label:{textStyle:{borderColor:"#333"}}}}}]};switch(h){case"funnel":R.series[0].width="50%",R.series[0].left="25%",R.series[0].sort=_;case"donut":R.series[0].radius=["30%",(p+g)/10.56+"px"],R.series[0].itemStyle.borderRadius=20,R.series[0].itemStyle.borderColor="#FFF",R.series[0].itemStyle.borderWidth=4;break;default:R.series[0].radius=(p+g)/10.56+"px"}t.setOption(R),t.on("click",clicker),setTimeout(function(){if(document.getElementById(e+"more")){var n=document.createElement("a");n.classList.add("download_button"),n.setAttribute("download",document.getElementById(e+"_ds").innerText.replace(/ /g,"_").toLowerCase()),n.href=t.getDataURL({type:"png",pixelRatio:1,backgroundColor:"#FFF"}),document.getElementById(e+"more")&&document.getElementById(e+"more").querySelector(".page_png").appendChild(n)}},5e3)}}})}function chartDonut(e){var t=document.getElementById("dados_"+e),n=echarts.init(document.getElementById("ctnr_"+e),null,{renderer:chartRenderer}),a=document.getElementById("gxml_"+e),r=a.children[0].innerHTML.replace("|","").split("|"),o=a.children[1].innerHTML.replace("|","").split("|");parseInt(t.getAttribute("data-meta")),t.getAttribute("data-coluna");if(atributos.getAttribute("data-hidden"))if(-1!=atributos.getAttribute("data-hidden").indexOf("S"));else;var l=[];for(let e=0;e<r.length;e++){var i=new Object;i.name=o[e],i.value=parseFloat(r[e]).toFixed(2),l.push(i)}var d={tooltip:{show:!0,confine:!0,trigger:"item"},noDataLoadingOption:{text:"inválido",effect:7},color:["#87CEFA","#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0","#FF7F50","#00D878","#AAAAAA","#DDDD55","#065182","#DA70D6","#FF6347","#F3A82F","#4A95C6","#9F9F9f","#3984A5","#CC9900","#115599","#81CE55","#A9532B","#5BC114","#CFCE19","#E23C85","#42227B","#EE7443","#9B9113","#F1D890","#53A49B"],series:[{type:"pie",radius:["50%","70%"],data:l,itemStyle:{}}]};n.setOption(d),n.on("click",clicker)}function chartMap(e){var t=document.getElementById("gxml_"+e),n=document.getElementById("dados_"+e);call("charout","prm_parametros="+t.getAttribute("data-parametros")+"&prm_micro_visao="+n.getAttribute("data-visao")+"&prm_objeto="+e.replace("trl","")+"&prm_screen="+tela).then(function(e){t.innerHTML=e}).then(function(){if(document.getElementById(e+"_ERR"))document.getElementById("ctnr_"+e).innerHTML=document.getElementById(e+"_ERR").innerHTML;else{var a=echarts.init(document.getElementById("ctnr_"+e),null,{renderer:chartRenderer});if(t.children[0]&&!t.children[1].classList.contains("err")){var r=t.children[0].innerHTML;r=r.substr(0,r.trim().length-1);var o=JSON.parse("{"+r+"}"),l=[],i=[],d=[];for(let e in o)l.push(o[e].valores),i.push(o[e].colunas),d.push(o[e].cod);var s=document.getElementById("atributos_"+e);if("S"==s.getAttribute("data-max"))var c=0;else c=parseInt(n.getAttribute("data-maximo"));var m,u,p,g=n.getAttribute("data-agrupadores"),f=(n.getAttribute("data-formato"),n.getAttribute("data-heatmap"),s.getAttribute("data-decimal")),v=[],y=[],h=!0,_=s.getAttribute("data-abreviacao");s.getAttribute("data-hidden")&&-1!=s.getAttribute("data-hidden").indexOf("S")&&(h=!1),get(e).querySelector(".lista_cidades")?(m=get(e).querySelector(".lista_cidades").children,u="cidade",p=!1):(m=get(e).querySelector(".lista_estados").children,u="estado",p=h);for(let e=0;e<m.length;e++){var b=new Object;isNaN(d[0])&&"cidade"==u?v.push(m[e].innerHTML.trim().replace("name","cod").replace("nome","name")):v.push(m[e].innerHTML.trim());var E=m[e].getAttribute("data-sigla"),I=m[e].getAttribute("data-sigla2"),x=m[e].getAttribute("data-nome");isNaN(d[0])&&"cidade"==u?(b.name=I,-1!=d.indexOf(I)&&(b.value=parseFloat(l[d.indexOf(I)]).toFixed(2)),b.sigla=I):(b.name=E,b.value=parseFloat(l[d.indexOf(E)]).toFixed(2),b.sigla=E),b.nome=x,"S"==s.getAttribute("data-max")&&parseInt(l[d.indexOf(E)])>c&&(c=parseInt(l[d.indexOf(E)])),y.push(b)}var B='{ "type": "FeatureCollection", "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } }, "features": ['+v.join(",").replace(/[\n\t]+/g,"")+'], "UTF8Encoding":false }';echarts.registerMap("mapa",B);var L=s.getAttribute("data-cores").split("|"),A=L.length;A<2&&(A=(L="#87CEFA|#B5C334|#FF6347|#C1232B".split("|")).length);var N={tooltip:{show:!0,trigger:"item",formatter:function(e){if(e)return e.data.nome?labelTooltip(e.data.nome,e.data,f,_,"N",0,"S"):labelTooltip(e.name,e,f,_,"N",0,"S")}},noDataLoadingOption:{text:"inválido",effect:7},dataRange:{left:"left",top:"bottom",min:0,max:c,splitNumber:A,inRange:{color:L},text:[g,""],calculable:!0},visualMap:{min:0,max:c,splitNumber:A,inRange:{color:L},text:[g,""],calculable:!0,formatter:function(e){return e.toLocaleString()}},series:[{name:g,type:"map",map:"mapa",roam:!0,label:{normal:{show:p,formatter:function(e){return e.data.sigla}},emphasis:{show:p,formatter:function(e){return"estado"==u?e.data.sigla?e.data.sigla:e.data.nome:""}}},data:y}]};if(a.setOption(N),a.on("click",clicker),a.dispatchAction({type:"dataZoom"}),document.getElementById(e+"more")){var T=document.createElement("a");T.style.setProperty("width","18px"),T.style.setProperty("height","18px"),T.style.setProperty("float","left"),T.style.setProperty("margin","4px 0 0 4px"),T.setAttribute("download",document.getElementById(e+"_ds").innerText.replace(/ /g,"_").toLowerCase()),T.href=a.getDataURL({type:"png",pixelRatio:1,backgroundColor:"#fff"}),document.getElementById(e+"more")&&document.getElementById(e+"more").querySelector(".page_png").appendChild(T)}}}})}function chartMapMultiplo(e){var t=document.getElementById("dados_"+e),n=echarts.init(document.getElementById("ctnr_"+e)),a=document.getElementById("gxml_"+e);if(a.children[1]){var r=a.children[0].innerHTML.replace("|",""),o=a.children[1].innerHTML.replace("|","").split("|"),l=parseInt(t.getAttribute("data-maximo")),i=t.getAttribute("data-json"),d=a.children[2].innerHTML.replace("|","").split("|"),s=t.getAttribute("data-agrupadores").replace("<BR>"," ").indexOf("|");if(atributos.getAttribute("data-hidden"))if(-1!=atributos.getAttribute("data-hidden").indexOf("S"));else;if(-1!=s){s=r.match(/\[[a-zA-Z0-9$_ ().\%\\\/\u00C0-\u017F]+\]/g);var c=[],m=0;for(let e=0;e<s.length;e++)-1==c.indexOf(s[e].replace("[","").replace("]",""))&&(c[m]=s[e].replace("[","").replace("]","").replace("(BR)"," ").replace("<BR>"," "),m+=1)}ajax("return","download","arquivo="+i+".json",!1),echarts.registerMap("mapa",respostaAjax);var u=[];for(let e=0;e<c.length;e++){var p=[];for(let t=0;t<r.length;t++){var g=new Object;g.agrupador=c[e],g.name=o[t],g.value=parseFloat(r[t]).toFixed(2),p.push(g)}u.push(p)}var f={tooltip:{show:!0,confine:!0,trigger:"item",formatter:function(e){if(e)return"NaN"!=Number(e.value).toLocaleString()?e.name+": "+Number(e.value).toLocaleString():e.name}},noDataLoadingOption:{text:"inválido",effect:7},dataRange:{left:"left",top:"bottom",min:0,max:l,calculable:!0},series:[{name:c,type:"map",map:"mapa",roam:!1,label:{normal:{show:!0,formatter:function(e){return d[e.dataIndex]?d[e.dataIndex]:" "}},emphasis:{show:!0}},data:p}]};n.setOption(f),n.on("click",clicker)}}function chartPercent(e){if(document.getElementById("valores_"+e).getAttribute("data-meta").length>0){var t=document.getElementById("valores_"+e),n=echarts.init(document.getElementById("ctnr_"+e),null,{renderer:chartRenderer}),a=(document.getElementById(e+"_vl"),parseInt(t.getAttribute("data-meta").replace(/\'/g,"")));0==a&&(a=1);var r=t.getAttribute("data-color"),o=document.getElementById(e+"_mt").style.getPropertyValue("color"),l=parseInt(t.getAttribute("data-valor")),i=[];0==o.trim().length&&(o=r);var d={normal:{color:"#dedede",borderColor:"#777",borderWidth:1,label:{textStyle:{color:o,fontWeight:"bold",fontSize:1,baseline:"top"},show:!1,position:"top"},labelLine:{show:!1}},emphasis:{color:"#cdcdcd"}},s={normal:{color:o,borderColor:"#777",borderWidth:1,label:{show:!0,position:"center",formatter:"{c}%",textStyle:{color:o,fontWeight:"bold",fontSize:15,baseline:"top"}},labelLine:{show:!1}}},c={normal:{color:o,label:{formatter:function(e){return parseFloat(e.value).toFixed(2)+"%"},textStyle:{baseline:"top"}}}},m=new Object;m.name="outro",m.value=l<a?100-parseFloat(l/a*100).toFixed(2):0,m.itemStyle=d,i.push(m);var u=new Object;u.name="",u.value=parseFloat(l/a*100).toFixed(2),u.itemStyle=s,i.push(u);var p={noDataLoadingOption:{text:"inválido",effect:7},series:[{type:"pie",radius:["50%","70%"],data:i,itemStyle:c}]};n.setOption(p)}}function chartGauge(e){var t=document.getElementById("ctnr_"+e),n=echarts.init(t,null,{renderer:chartRenderer}),a=document.getElementById("atributos_"+e),r=parseFloat(document.getElementById("valor_"+e).title),o=parseInt(a.getAttribute("data-raio")),l=parseFloat(a.getAttribute("data-min")),i=parseFloat(a.getAttribute("data-max")),d=a.getAttribute("data-valores").split("|"),s=a.getAttribute("data-cores").split("|"),c=["#87CEFA","#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0","#FF7F50","#00D878","#AAAAAA","#DDDD55","#065182","#DA70D6","#FF6347","#AA5511","#CCCC44","#DA7400","#6663BB","#FAE982","#F5C65D","#AAA43B","#6055DD"],m=!0;"S"==a.getAttribute("data-hidden")&&(m=!1);var u=5;d.length>0&&(u=d.length);var p,g,f,v=[],y=[];if(0==a.getAttribute("data-valores").length)y=[.25,c[0]],v.push(y),y=[.5,c[1]],v.push(y),y=[.75,c[2]],v.push(y),y=[1,c[3]],v.push(y);else for(let e=0;e<u;e++)p=parseFloat(d[e])/(i+l),y=s[e]?[p,s[e]]:[p,c[e]],v.push(y);p<1&&(y=[1,"#999"],v.push(y)),o<190?(g=t.clientWidth/3,f="70%"):(g=t.clientWidth/4,f="50%");var h={series:[{splitNumber:u,type:"gauge",startAngle:o,endAngle:0,center:["50%",f],radius:g,min:l,max:i,axisLine:{lineStyle:{width:50,color:v}},axisTick:{distance:-30,length:8,lineStyle:{color:"#EEE",width:2,opacity:"0.5"},show:!1},splitLine:{distance:-30,length:40,lineStyle:{color:"#EEE",width:4,opacity:"0.2"},show:!1},axisLabel:{color:"auto",distance:46,fontSize:12,formatter:function(e){return Number(parseInt(e)).toLocaleString()},show:m},pointer:{icon:"triangle",itemStyle:{color:"#333"},length:"80%",width:14,offsetCenter:[0,"0%"]},anchor:{show:!0,showAbove:!0,size:16,itemStyle:{borderWidth:7,color:"#333",borderColor:"#333"}},detail:{show:!1},data:[{value:r,name:""}]}]};n.setOption(h)}var resizerDelay=0;function renderChart(e){if(document.getElementById(e)&&document.getElementById("dados_"+e))switch(document.getElementById("dados_"+e).getAttribute("data-tipo")){case"ORGANOGRAMA":chartGauge(e),activeorga(e,"","");break;case"PONTEIRO":chartGauge(e);break;case"BARRAS":case"COLUNAS":case"LINHAS":chart(e);break;case"PIZZA":chartSlice(e);break;case"ROSCA":chartDonut(e);break;case"VALOR":chartPercent(e);break;case"MAPA":chartMap(e)}}function renderChartDirect(e){var t,n;if(document.getElementById(e)&&document.getElementById("dados_"+e))switch(document.getElementById("dados_"+e).getAttribute("data-tipo")){case"ORGANOGRAMA":chartGauge(e),activeorga(e,"","");break;case"PONTEIRO":chartGauge(e);break;case"BARRAS":case"COLUNAS":case"LINHAS":t=document.getElementById("gxml_"+e),n=document.getElementById("dados_"+e),call("charout","prm_parametros="+t.getAttribute("data-parametros")+"&prm_micro_visao="+n.getAttribute("data-visao")+"&prm_objeto="+e.replace("trl","")+"&prm_screen="+tela).then(function(e){t.innerHTML=e}).then(function(){chart(e)});break;case"PIZZA":chartSlice(e);break;case"ROSCA":chartDonut(e);break;case"VALOR":chartPercent(e);break;case"MAPA":chartMap(e)}}function heatmap(e){if(document.getElementById(e)){var t={};t.objeto=document.getElementById(e),t.valores=document.getElementById("gxml_"+e).children[0].innerHTML.replace("|","").split("|"),t.zoom=3,t.coluna=t.objeto.getAttribute("data-colunavalor"),t.colunadesc=t.objeto.getAttribute("data-colunadesc"),t.tipo="HEATMAP",t.centro="-28.680601666666668,-49.365805",t.coor=[],t.lastx="",t.lasty="";var n="",a="";if(-1==t.tipo.indexOf("MARCADOR")){for(let e=0;e<t.valores.length;e++)n=t.valores[e].split(",")[1],a=t.valores[e].split(",")[0],n.length>0&&a.length>0&&t.coor.push(new google.maps.LatLng(a,n)),t.lastx=parseFloat(n),t.lasty=parseFloat(a);t.coor}0==t.centro.length?t.centro=new google.maps.LatLng(t.lastx,t.lasty):t.centro=new google.maps.LatLng(t.centro.split(",")[0],t.centro.split(",")[1]),(map=new google.maps.Map(t.objeto.children[t.objeto.children.length-1],{center:t.centro,zoom:t.zoom,mapTypeId:"terrain",panControl:!1,streetViewControl:!1,zoomControl:!1})).addListener("zoom_changed",function(){setTimeout(function(){t.zoom=map.getZoom(),t.objeto.setAttribute("data-zoom",t.zoom)},2e3)}),map.addListener("center_changed",function(){setTimeout(function(){t.centro=(""+map.getCenter()).replace(/[\)\(]/g,""),t.objeto.setAttribute("data-center",t.centro)},2e3)}),new google.maps.visualization.HeatmapLayer({data:t.coor}).setMap(map)}}function removeTrash(){var e=document.querySelectorAll("._SmartLabel_Container"),t=e.length;for(let n=0;n<t;n++)e[n].parentNode.removeChild(e[n])}function dashboard(e,t,n,a){switch(t){case"insert":call("inserir_objeto","prm_objeto=ARTICLE&prm_screen="+n+"&prm_screen_ant="+document.getElementById(n).getElementsByTagName("article").length).then(function(e){var t=document.createElement("div");t.innerHTML=e,document.getElementById(n).appendChild(t.children[0])}).then(function(){document.querySelector(".moving")&&(document.querySelector(".moving").className="")}).then(function(){dashAjuste(n)});break;case"insertnv2":ajax("main","inserir_objeto","prm_objeto=ARTICLENV2&prm_screen="+n+"&prm_screen_ant="+document.getElementById(n).getElementsByTagName("article").length,!1,n),shscr(tela),document.querySelector(".moving")&&(document.querySelector(".moving").className=""),setTimeout(function(){dashAjuste()},100);break;case"rowcolumn":ajax("fly","salva_posicao","prm_objeto="+n+"&prm_screen="+e+"&prm_posx=&prm_posy=&prm_zindex="+a,!1),document.getElementById(n).style.setProperty("-webkit-flex-direction",a),document.getElementById(n).style.setProperty("flex-direction",a),document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").classList.remove("movingarticle");break;case"porcentagem":document.getElementById(n).style.setProperty("-webkit-flex-basis","calc("+a+" - 6px)"),document.getElementById(n).style.setProperty("flex-basis","calc("+a+" - 6px)"),ajax("fly","salva_posicao","prm_objeto="+n+"&prm_screen="+e+"&prm_posx=&prm_posy=&prm_zindex="+encodeURIComponent(a)+"&prm_tipo=porcentagem",!0),"false"==error&&alerta("feed-fixo",TR_AL),document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").classList.remove("movingarticle");break;case"ordem":document.getElementById(n).style.setProperty("order",a),ajax("fly","salva_posicao","prm_objeto="+n+"&prm_screen="+e+"&prm_posx="+encodeURIComponent(a)+"&prm_posy=&prm_zindex=&prm_tipo=ordem",!0),"false"==error&&alerta("feed-fixo",TR_AL),document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").classList.remove("movingarticle");break;case"newsection":call("inserir_objeto","prm_objeto=SECTION&prm_screen="+e+"&prm_screen_ant="+document.getElementsByTagName("section").length).then(function(e){var t=document.createElement("div");t.innerHTML=e,MAIN.appendChild(t.children[0])}).then(function(){dashAjuste(MAIN.lastElementChild.id)});break;case"align":ajax("fly","salva_posicao","prm_objeto="+n+"&prm_screen="+e+"&prm_posx=&prm_posy="+a+"&prm_zindex=",!1),document.getElementById(n).style.setProperty("justify-content",a),document.getElementById(n).style.setProperty("align-items",a),document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").classList.remove("movingarticle")}}function dashSectionDown(e){if(3!=e.which&&"noline"!=this.className)if("moving"!=this.className)if("hoverchange"==this.className){var t=this.style.getPropertyValue("order"),n=document.querySelector(".moving"),a=n.style.getPropertyValue("order");n.style.setProperty("order",t),n.style["-webkit-order"]=t,this.style.setProperty("order",a),this.style["-webkit-order"]=a,ajax("fly","dashboardmove","prm_objeto="+n.id+"&prm_target="+this.id+"&prm_last="+tela,!1),n.className="",this.className=""}else document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").classList.remove("movingarticle"),this.className="moving";else this.className=""}function dashSectionEnter(){"moving"!=this.className&&"noline"!=this.className&&(document.querySelector(".selectedcolumn")&&(this.className="hover"),document.querySelector(".moving")&&(this.className="hoverchange"))}function dashSectionLeave(){"moving"!=this.className&&"noline"!=this.className&&(this.className="")}function dashArticleDown(e){if(e.stopPropagation(),3!=e.which&&"noline"!=this.parentNode.className)if("movingarticle"!=this.className)if(MAIN.querySelector(".selected")){var t,n=MAIN.querySelector(".selected");t="main"==n.parentNode.id?tela:n.parentNode.id;var a=n.id,r=n.parentNode,o=e.target;if(r.id==o.id){var l=o.children,i=1;for(let e=1;e<l.length;e++)parseInt(window.getComputedStyle(l[e]).getPropertyValue("order"))>i&&(i=parseInt(window.getComputedStyle(l[e]).getPropertyValue("order"))+1),l[e].style.getPropertyValue("order")&&(i=parseInt(l[e].style.getPropertyValue("order"))+1);n.style.setProperty("order",i+1),ajax("fly","salva_posicao","prm_objeto="+a+"&prm_screen="+o.id+"&prm_posx="+(i+1)+"&prm_posy=&prm_zindex=",!0),MAIN.querySelector(".selected").classList.remove("selected")}else n.remove(),ajax("fly","dashboardmove","prm_objeto="+a+"&prm_target="+o.id+"&prm_last="+t,!0),call("show_objeto","prm_objeto="+a+"&PRM_ZINDEX=&prm_posx=99&prm_posy=&prm_screen="+tela+"&prm_dashboard=true","obj").then(function(e){var t=document.createElement("div");t.innerHTML=e,o.appendChild(t.children[0]),"N"==sticky?document.getElementById("dados_"+a)?renderChart(a):ajustar(a):document.getElementById(a+"c").classList.add("sticky")}).then(function(){eventos(document.getElementById(a))}).then(function(){var e=o.children,t=1;for(let n=1;n<e.length;n++)e[n].id!=a?(parseInt(e[n].style.getPropertyValue("order"))<t&&(t=parseInt(e[n].style.getPropertyValue("order"))),ajax("fly","salva_posicao","prm_objeto="+e[n].id+"&prm_screen="+o.id+"&prm_posx="+t+"&prm_posy=&prm_zindex=",!0)):ajax("fly","salva_posicao","prm_objeto="+e[n].id+"&prm_screen="+o.id+"&prm_posx="+e.length+"1&prm_posy=&prm_zindex=",!0),t+=1})}else if("hoverchangearticle"==this.className){var d=this.style.getPropertyValue("order"),s=document.querySelector(".movingarticle"),c=document.querySelector(".movingarticle").style.getPropertyValue("order");document.querySelector(".movingarticle").style.setProperty("order",d),document.querySelector(".movingarticle").style["-webkit-order"]=d,document.getElementById(document.querySelector(".movingarticle").id+"ordem").value=d,this.style.setProperty("order",c),document.getElementById(this.id+"ordem").value=c,"mac"==PRINCP.className&&(this.style["-webkit-order"]=c),ajax("fly","dashboardmove","prm_objeto="+s.id+"&prm_target="+this.id+"&prm_last="+this.parentNode.id,!1),s.className="",this.className=""}else document.querySelector(".moving")&&document.querySelector(".moving").classList.remove("moving"),this.className="movingarticle";else this.className=""}function dashArticleEnter(e){"movingarticle"!=this.className&&"noline"!=this.parentNode.className&&document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").parentNode.id==this.parentNode.id&&(this.className="hoverchangearticle"),e.stopPropagation(e)}function dashArticleLeave(e){"movingarticle"!=this.className&&"noline"!=this.parentNode.className&&(this.className=""),e.stopPropagation()}function debug(e){if("13"==e){var t=document.getElementById("debug").firstElementChild.value.toLowerCase();if(-1!=t.indexOf("query")){let e=document.getElementsByClassName("faketitle");if(e[0])if("inline"==e[0].style.display)for(let t=0;t<e.length;t++)e[t].style.display="none";else for(let t=0;t<e.length;t++)e[t].style.display="inline"}if(-1!=t.indexOf("json"))if(document.querySelector(".fakedados")){var n=document.querySelectorAll(".fakedados");for(let e=0;e<n.length;e++)n[e].remove()}else{let e=document.createElement("textarea");e.classList.add("fakedados");var a=document.querySelectorAll(".json");for(let t=0;t<a.length;t++){let n=e.cloneNode(!0),r=a[t].innerHTML.trim();n.value="{"+r.substring(0,r.length-1)+"}",a[t].parentNode.parentNode.appendChild(n)}}if(-1!=t.indexOf("rearrange")){var r=MAIN.children;for(let e=0;e<r.length;e++)"DIV"==r[e].tagName?(r[e].style.left="100px",r[e].style.top="100px"):"SPAN"==r[e].tagName&&(r[e].firstElementChild.style.left="100px",r[e].firstElementChild.style.top="100px")}if(-1!=t.indexOf("clearlog"))ajax("fly","clearlog","prm_programa="+t.split(".")[1],!1);if(-1!=t.indexOf("screen")&&("inline"==document.getElementById("screenres").style.display?document.getElementById("screenres").style.display="none":document.getElementById("screenres").style.display="inline"),-1!=t.indexOf("lang")&&(curtain("enabled"),carrega("lang_table"),document.getElementById("debug").setAttribute("class","")),-1!=t.indexOf("padrao")&&(call_save(""),document.getElementById("titulo").innerHTML="OBJECT PADRAO",curtain("enabled"),carregaPainel(""),carrega("object_padrao"),document.getElementById("debug").setAttribute("class","")),-1!=t.indexOf("upload")&&(document.getElementById("titulo").innerHTML="UPLOAD",call_save(""),curtain("enabled"),carregaPainel("upload"),carrega("uploaded"),document.getElementById("debug").setAttribute("class","")),-1!=t.indexOf("help")&&alert("[query]: mostra ou esconde a query de cada consulta \n[export]: exporta dados das tabelas do tables_to_export, (pipe) seguido da letra do tipo(U usuario, O objeto) para especificar a exportação  \n[rearrange]: realoca todos os objetos pra posição 100/100 \n[clearlog.X]: Limpa log_eventos de dados de X(JS para javascript, EL para error line e PAR para parametro de usu&aacute;rio) \n[screen]: mostra as resoluções de tela \n[rule]: mostra a posição do cursor com reguas \n[grid(px)]: tela dividida em pixels \n[fun.lang]: lista as traduções \n[sandbox]: Libera uso da screen sandbox para testes \n[exec=]: executa comandos \n[dashboard]: Esconde/mostra as linhas do dashboard para o dwu \n[padrao]: Abre a tela de padroes do sistema \n[upload]: Abre a tela de upload \n[admin]: Tela com as permissões de usuários"),-1!=t.indexOf("rule")){var o=document.getElementById("rule");"visible"==o.className?(o.className="invisible",document.removeEventListener("mousemove",rulemove,!1)):(o.className="visible",document.addEventListener("mousemove",rulemove,!1))}if(-1!=t.indexOf("find"))ajax("list","screen_list","prm_objeto="+t.replace("find(","").replace(")",""),!0,"floatops");if(-1!=t.indexOf("painel")&&(call_save(""),curtain("enabled"),carrega("painel")),-1!=t.indexOf("admin")&&(call_save(""),document.getElementById("titulo").innerHTML="OPÇÕES DE ADMINISTRAÇÃO",curtain("enabled"),carrega("admin_options"),document.getElementById("debug").setAttribute("class","")),-1!=t.indexOf("dashboard")){var l=document.getElementsByTagName("SECTION");if("noline"==l[0].className)for(let e=0;e<l.length;e++)l[e].className="";else for(let e=0;e<l.length;e++)l[e].className="noline"}if(-1!=t.indexOf("grid")){var i=document.querySelectorAll(".rlinha");for(let e=0;e<i.length;e++)i[e].parentNode.removeChild(i[e]);var d=t.replace("grid(","");if(d=d.replace(")",""),"number"==typeof(d=parseInt(d))&&0!=(d=Math.abs(parseInt(d)))){altura=document.getElementById("html").clientHeight,largura=document.getElementById("html").clientWidth,line=document.createElement("div");for(let e=d;e<largura;){let t=line.cloneNode("true");t.style.setProperty("left",e+"px"),t.className="rlinha horizontal",document.body.appendChild(t),e+=d}for(let e=d;e<altura;){let t=line.cloneNode("true");t.style.setProperty("top",e+"px"),t.className="rlinha vertical",document.body.appendChild(t),e+=d}}}if(-1!=t.indexOf("sandbox")){var s=document.getElementById("floatops").lastElementChild;"none"==s.style.getPropertyValue("display")?s.style.setProperty("display","inline"):s.style.setProperty("display","none")}if(-1!=t.indexOf("exec="))if(confirm(TR_CM))ajax("fly","executar","prm_acao="+t.replace("exec=",""),!1);-1!=t.indexOf("prefixo")&&(call_save(""),document.getElementById("titulo").innerHTML="PREFIXO DE COLUNA",curtain("enabled"),carregaPainel("prefixo"),carrega("prefixo_lista"),document.getElementById("debug").setAttribute("class","")),document.getElementById("debug").firstElementChild.value=""}}function fakeValue(e,t){document.getElementById(e).innerHTML=t.innerHTML;var n=t.getAttribute("title");document.getElementById(e).setAttribute("title",n)}function remover(e,t){var n;if(n=document.getElementById(e+"trl")?document.getElementById(e+"trl"):document.getElementById(e),"excluir"==t&&void 0!==t){var a=n.parentNode.id;"main"!=n.parentNode.id&&"space-options"!=n.parentNode.id||(a=tela),call("dl_obj","prm_cod="+e+"&prm_tela="+a).then(function(e){-1!=e.indexOf("OK")&&alerta("msg",TR_EX)})}n&&(document.getElementById("filterlist").title==n.id+"-filterlist"&&(document.getElementById("filterlist").className="filtro hidden"),void 0===t||"excluir"==t?(n.style.setProperty("opacity","0"),setTimeout(function(){n.parentNode&&(n.style.setProperty("display","none"),n.remove())},200)):n.parentNode&&n.remove())}function loading(e,t){var n=LAYER.children[1],a=LAYER.children[0];""==LAYER.className?(document.querySelector(".slide-N")&&MAIN.style.setProperty("filter","blur(14px)"),LAYER.classList.add("ativo"),setTimeout(function(){a.classList.add("open")},100),document.querySelector(".slide-S")||setTimeout(function(){LAYER.children[1].classList.add("visivel"),LAYER.children[2].classList.add("visivel"),LAYER.children[3].classList.add("visivel"),LAYER.children[4].classList.add("visivel"),LAYER.children[5].classList.add("visivel")},100),get("jumpdrill")&&get("jumpdrill").remove()):(n.classList.remove("open"),document.querySelector(".slide-N")&&MAIN.style.setProperty("filter","blur(14px)"),setTimeout(function(){MAIN.style.removeProperty("filter")},300),void 0!==e?setTimeout(function(){n.classList.remove("visivel"),a.classList.remove("open"),LAYER.classList.remove("ativo")},500):LAYER.classList.remove("ativo"),get("jumpdrill")&&get("jumpdrill").remove())}function loadAttrib(e,t){document.getElementById("attriblist").classList.remove("horizontal"),document.getElementById(e)&&document.getElementById("attriblist").classList.remove("open"),setTimeout(function(){document.getElementById("attriblist").innerHTML=""},200),setTimeout(function(){document.getElementById(e)?(document.getElementById("attriblist").classList.toggle("open"),document.getElementById("attriblist").classList.toggle("vertical")):(document.getElementById("attriblist").classList.add("open"),document.getElementById("attriblist").classList.add("vertical")),loader("attriblist"),ajax("list",e,t,!0,"attriblist"),document.querySelector(".destacada")&&document.querySelector(".destacada").classList.remove("destacada")},400)}function alerta(e,t,n){var a;if(t)if("granted"==notify.permission&&"out"==vision){a=t.split("!");for(let e=0;e<a.length;e++)callnotify("ATENÇÃO",a[e])}else if("alert"==e)alert(t);else{a=t.split("!");for(let e=0;e<a.length;e++)if(a[e].trim().length>0){var r=document.getElementById("alerta-template").children[0].cloneNode(!0);r.children[0].innerHTML=a[e]+"!",n&&(r.children[2].style.setProperty("display","initial"),r.children[3].innerHTML=n),document.getElementById("feed-fixo").appendChild(r),function(e){setTimeout(function(){e.classList.add("show")},100),setTimeout(function(){e&&e.classList.remove("show")},4700),setTimeout(function(){e&&e.parentNode&&e.remove()},5e3)}(r)}}}function invisible_touch(e,t){var n,a,r=document.getElementById(e);if(0==MAIN.getElementsByTagName("section").length&&-1==r.className.indexOf("scaled"))if("start"==t)var o=setTimeout(function(){r.classList.add("dragging")},200);else{clearTimeout(o),setTimeout(function(){r.classList.remove("dragging")},200);var l=r.style.top,i=r.style.left;l==r.getAttribute("data-top")&&i==r.getAttribute("data-left")||(parseInt(i)%5!=0?(n=parseInt(i)/10,n=Math.round(n),n*=10):n=parseInt(i),parseInt(l)%5!=0?(a=parseInt(l)/10,a=Math.round(a),a*=10):a=parseInt(l),ajax("pos","salva_posicao","prm_objeto="+e+"&prm_screen="+tela+"&prm_posx="+n+"px&prm_posy="+a+"px&prm_zindex=",!0),r.setAttribute("data-top",l),r.setAttribute("data-left",i))}}function fakeClickScript(){document.querySelector(".fakelistbox.open")&&0==document.querySelector(".fakelistbox.open").previousElementSibling.contentEditable&&document.querySelector(".fakelistbox.open").click()}function logout(e){e?(ajax("fly","xlogout","prm_sessao="+e,!0),alerta("x",TR_SE)):(ajax("fly","xlogout","",!0),alerta("x",TR_SE),setTimeout(function(){window.location.reload(!0)},2e3))}window.addEventListener("resize",function(){if((resizerDelay+=1)>10){for(var e=document.querySelectorAll(".dragme"),t=e.length,n=0;n<t;n++)document.getElementById("dados_"+e[n].id)&&renderChart(e[n].id),document.getElementById(e[n].id).classList.contains("front")&&topDistance(e[n].id);resizerDelay=0}}),rulemove=function(e){rule.style.setProperty("left",cursorx-10+"px"),rule.style.setProperty("top",cursory-10+"px"),rule.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;X = "+cursorx+"px Y = "+cursory+"px"};var msgs=0;call("countCheckPost","").then(e=>{msgs=parseInt(e)});const TICK=setInterval(function(){get("login-menu")||get("verify-post")&&call("countCheckPost","").then(function(e){if(get("verify-post").setAttribute("data-ajax",e.trim()),parseInt(e)>0&&get("text-talk").classList.contains("open")&&parseInt(e)!=msgs){let e=get("text-talk").querySelector(".selected");call("listContainer","").then(function(e){document.querySelector(".list_container").innerHTML=e}).then(function(){e.click()})}})},3e4),LOGGED=setInterval(function(){get("login-menu")||call("refresh_session","").then(function(e){if(0==document.cookie.length&&"N"==get("xe").value||-1!=e.indexOf("0"))return logout(""),!1;-1!=e.indexOf("1")&&window.location.reload(!0)})},6e4);function call(e,t,n,a){a=a||"POST";return fakeClickScript(),new Promise(function(r,o){var l=new XMLHttpRequest;if("PROCEDURE"==n)l.open(a,"dwu."+e,!0);else{var i=n||"fcl";"POST"==a?l.open(a,"dwu."+i+"."+e,!0):l.open(a,"dwu."+i+"."+e+"?"+t,!0)}"POST"==a?l.send(t):l.send(null),l.onload=function(){200==l.status?(r(l.responseText.trim()),document.getElementById("content")&&document.getElementById("content").classList.remove("loading")):(document.getElementById("content").classList.remove("loading"),o(alerta("feed-fixo",TR_XC)))},l.onerror=function(){document.getElementById("content").classList.remove("loading"),0==navigator.onLine&&alerta("msg",TR_OFF)}})}var slice=[];function ajax(e,t,n,a,r,o,l,i){i=i||"fcl";var d=l,s=new XMLHttpRequest;s.onerror=ajaxError,s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status)switch(e){case"return":respostaAjax=s.responseText.trim();break;case"data-":"LOGOFF"!=s.responseText.trim()&&document.getElementById(r).setAttribute("data-ajax",s.responseText.trim());break;case"append":if(-1==s.responseText.indexOf("#alert")){var t;t=document.createElement("div");var n=s.responseText;t.innerHTML=n,(v=t.children[0]).style.setProperty("order",document.getElementById(r).children.length+1),new Promise(function(e,t){e(n)}).then(function(){d&&v.style.setProperty("opacity","0")}).then(function(){document.getElementById(r).appendChild(v)}).then(function(){eventos(v),setTimeout(function(){d&&document.getElementById(d)&&document.getElementById(d).style.setProperty("opacity",""),LAYER.classList.contains("ativo")&&loading(),topDistance(d)},100),d&&(centerDrill(d),ajustar(d),renderChart(d))})}break;case"input":document.getElementById(r).className=s.responseText.trim();break;case"value":document.getElementById(r).value=s.responseText.trim();break;case"list":document.getElementById(r).innerHTML=s.responseText,lasturl.length<3&&x&&(lasturl=x);break;case"inject":if(s.responseText.length>0){var a=document.createElement("tbody");a.innerHTML=s.responseText;var i=a.children[1].children.length,c=0;for(let e=0;e<document.getElementById(r).querySelectorAll("td:not(.print)").length;e++)document.getElementById(r).children[e].hasAttribute("colspan")?c+=parseInt(document.getElementById(r).children[e].getAttribute("colspan")):c++;if(i<c)for(let e=1;e<a.children.length;e++)a.children[e].children[1].setAttribute("colspan",c-i+1);var m=a.children.length;for(let e=0;e<m;e++)document.getElementById(r).parentNode.insertBefore(a.lastElementChild,document.getElementById(r).nextElementSibling)}else alerta("feed-fixo",TR_NR);loading();break;case"script":(dscript=document.createElement("script")).innerHTML=s.responseText,document.head.appendChild(dscript);break;case"lang":tr=s.responseText;break;case"time":countdown=s.responseText;break;case"double":document.getElementById(r+"2").innerHTML=s.responseText,document.getElementById(r).innerHTML=s.responseText,document.getElementById("count-result")&&(document.getElementById("count").innerHTML=document.getElementById("count-result").children[0].innerHTML);break;case"slice":s.responseText.length>1&&(slice[o]=s.responseText),20==o&&ace_editor.setValue(slice.join());break;case"order":if(null==(u=document.getElementById(r))){var u;document.getElementById(r+"trl").parentNode.setAttribute("name",""),(u=document.getElementById(r+"trl")).style.getPropertyValue("order")&&(dashorder="&prm_dashboard=true",dashlocation=u.parentNode.id);var p=u.offsetLeft,g=u.offsetTop;u.parentNode.removeChild(u),appendar("prm_drill=N&prm_objeto="+r+"&PRM_ZINDEX=&prm_posx="+p+"px&prm_posy="+g+"px&prm_parametros="+l+"&prm_zindex="+o+"&prm_screen="+tela+dashorder)}else u.style.getPropertyValue("order")&&(dashorder="&prm_dashboard=true",dashlocation=u.parentNode.id),u.parentNode.getAttribute("data-parent")?shscr(tela):(u.parentNode.setAttribute("name",""),p=u.getAttribute("data-left"),g=u.getAttribute("data-top"),u&&u.parentNode.removeChild(u),document.getElementById("drill_obj").setAttribute("value",r),appendar("prm_drill=N&prm_objeto="+r+"&PRM_ZINDEX=&prm_posx="+p+"&prm_posy="+g+"&prm_screen="+tela+dashorder),remover(r+"trl"));break;case"query":document.getElementById(r)?(document.getElementById(r).parentNode.innerHTML=s.responseText,ajustar(r)):(v=document.getElementById(r+"trl")).parentNode.removeChild(v),LAYER.setAttribute("class","");break;case"main":if(-1==s.responseText.indexOf("#alert")&&document.getElementById(r)){var f=document.getElementById(r);f.innerHTML=f.innerHTML+s.responseText}break;case"quick":var v;if("NONE"!=(v=s.responseText.trim())){if(document.querySelector(".movingarticle")){var y=document.querySelector(".movingarticle").id,h=document.querySelector(".movingarticle").querySelectorAll(".dragme"),_=3;for(let e=0;e<h.length;e++)parseInt(h[e].style.getPropertyValue("ordem"))>=_&&(_=parseInt(h[e].style.getPropertyValue("ordem"))+1);var b="&prm_dashboard=true"}else y=tela,_=cursorx+"px",b="&prm_dashboard=false";if(ajax("fly","inserir_objeto","prm_objeto="+v+"&prm_screen="+y,!1),appendar("prm_objeto="+v+"&prm_zindex=999&prm_posx="+_+"&prm_posy="+cursory+"px&prm_screen="+tela+b,"",""),document.getElementById(v)&&-1!=document.getElementById(v).className.indexOf("texto")){var E=document.getElementById(v),I=window.innerWidth/2-E.clientWidth-60+"px",x=window.innerHeight/2-E.clientHeight-60+"px";E.style.setProperty("left",I),E.style.setProperty("top",x)}carrega("ajobjeto?prm_objeto="+v);document.getElementById(v+"_ds");get("jumpdrill")&&(get("jumpdrill").innerHTML="",get("jumpdrill").style.removeProperty("opacity"))}}else telasup&&(0==navigator.onLine?alerta("msg",TR_OFF):0!=parseInt(telasup.style.getPropertyValue("height"))?(alerta("msg",TR_FC_NF),document.querySelector(".load")&&setTimeout(function(){document.querySelector(".load").innerHTML=TR_XC},500)):alerta("feed-fixo",TR_FC_NF))},s.open("POST","dwu."+i+"."+t,a),s.send(n);var c=s.responseText;-1!=c.indexOf("!alert")?(alerta("feed-fixo",c.substr(c.indexOf("!alert")+6,100)),error="true"):-1!=c.indexOf("#alert")?(alerta("msg",c.substr(c.indexOf("#alert")+6,100)),error="true"):error="false"}function ajaxExt(x){call("load_external","prm_screen="+x).then(function(url){var ajaxRequestExt;url.trim().length>0&&(ajaxRequestExt=new XMLHttpRequest,ajaxRequestExt.onreadystatechange=function(){4==ajaxRequestExt.readyState&&200==ajaxRequestExt.status&&(document.getElementById("main-ext").innerHTML=ajaxRequestExt.responseText,eval(document.getElementById("main-ext").getElementsByTagName("DIV")[0].getAttribute("data-scriptload")))},ajaxRequestExt.open("GET","dwu."+url,!1),ajaxRequestExt.send(null))})}function ajaxError(e){console.log("ERRO: "+e+"!!!")}function noerror(e,t,n){"false"==error&&(e&&(e.parentNode.parentNode.setAttribute("class","removing"),setTimeout(function(){e.parentNode.parentNode.style.display="none",e.parentNode.parentNode.id="",e.parentNode.id=""},200)),alerta(n,t))}function agrupadorChange(e,t,n){if(remover("jumpmed"),"N/A"!=n){var a,r,o,l,i,d;document.getElementById("drill_obj").value=e,document.getElementById(e)?(a=document.getElementById(e).parentNode.id,r=document.getElementById("par_"+e).value,o=document.getElementById("agp_"+e).value,d="N"):(a=document.getElementById(e+"trl").parentNode.id,r=document.getElementById("par_"+e+"trl").value,o=document.getElementById("agp_"+e+"trl").value,d="Y"),"main"==a?(l="&prm_dashboard=false",i=""):(dashlocation=a,l="&prm_dashboard=true",i=document.getElementById(e).style.getPropertyValue("order"));var s=o.replace(t,n);remover(e),appendar("prm_drill="+d+"&prm_objeto="+e+"&prm_zindex=&prm_parametros="+r+"&prm_posx="+i+"&prm_posy=&prm_screen="+tela+"&prm_track="+e+"&prm_objeton="+e+"&prm_alt_med="+s+l,a,e),setTimeout(function(){centerDrill(e)},100)}}function fixCol(e){if(document.getElementById(e+"fixed")&&document.getElementById(e+"c").children.length>1){document.getElementById(e+"fixed").innerHTML="";var t="",n=1,a=1,r=0,o=0,l=0,i=0,d=new Array,s="",c=0,m="";if(document.getElementById(e)){if(document.getElementById(e+"c").children[0])s=document.getElementById(e+"c").children[0];else{if("TBODY"!=document.getElementById(e+"c").children[1].tagName)return;s=document.getElementById(e+"c").children[1],c=1}var u=s.getElementsByTagName("th"),p=u.length;if(parseInt(document.getElementById(e+"fixed").getAttribute("data-number"))>0){r=parseInt(document.getElementById(e+"fixed").getAttribute("data-number"))<=document.getElementById(e+"c").children[0].children[0].childElementCount?parseInt(document.getElementById(e+"fixed").getAttribute("data-number")):document.getElementById(e+"c").children[1].children[0].childElementCount,1==c&&(r=2,minus=0);for(let t=0;t<r-1;t++)o+=1,m=document.getElementById(e+"c").children[0].children[0].children[t+1],a=parseInt(m.colSpan)+parseInt(a),d[t]=document.createElement("span"),d[t].className="fixed",d[t].innerHTML=m.innerHTML,d[t].style.color=m.parentNode.style.color,d[t].style.width=0==t?m.clientWidth+13+"px":m.clientWidth-5+"px",1==c?(d[t].style.padding="0 4px",d[t].style.lineHeight=m.clientHeight+"px",d[t].style.setProperty("min-height",m.clientHeight-8+"px"),d[t].style.textAlign="left"):(d[t].style.backgroundColor=m.parentNode.style.backgroundColor,d[t].style.height=m.clientHeight-8+"px",d[t].style.lineHeight=m.clientHeight-8+"px"),parseInt(m.clientWidth)+parseInt(l)<document.getElementById(e+"dv2").clientWidth&&(l=parseInt(m.clientWidth)+parseInt(l)),o=o+parseInt(m.colSpan)-1,document.getElementById(e+"fixed").innerHTML=document.getElementById(e+"fixed").innerHTML+d[t].outerHTML;-1==navigator.userAgent.indexOf("Trident")?document.getElementById(e+"fixed").setAttribute("data-width",l-1):document.getElementById(e+"fixed").setAttribute("data-width",l+1),document.getElementById(e+"fixed").style.setProperty("white-space","nowrap");for(var g=n;g<a;g++){for(var f=0;f<p;f++)if(i>1&&1==c||0==c){if(("total duplicado"!=u[f].className||"total geral"!=v.className)&&u[f].cellIndex==g){var v=document.createElement("li");v.innerHTML=u[f].outerHTML,u[f].parentNode.style.background.length>2?v.style.background=u[f].parentNode.style.background:document.getElementById(e+"fixed").style.background=document.getElementById(e+"dv2").style.background,"seta"!=u[f].className?v.className=u[f].parentNode.className:v.className=u[f].className+" "+u[f].parentNode.className,"total duplicado"!=v.className&&"total geral"!=v.className||(v.innerHTML=""),null!=u[f-1].getAttribute("data-valor")&&v.setAttribute("data-valor",u[f-1].getAttribute("data-valor")),null!=u[f-1].getAttribute("data-ordem")&&v.setAttribute("data-ordem",u[f-1].getAttribute("data-ordem")),v.style.backgroundImage=u[f].style.backgroundImage,v.style.paddingLeft=u[f].style.paddingLeft,g==n?13==parseInt(u[f].style.paddingLeft)?(v.style.width=u[g].clientWidth+2+"px",-1!=u[f-1].className.indexOf("nivel")&&v.style.setProperty("width",u[f].clientWidth+18+"px")):(v.style.width=u[g].clientWidth+10+"px",-1!=u[f-1].className.indexOf("nivel")&&v.style.setProperty("width",u[f].clientWidth+18+"px")):13==parseInt(u[f].style.paddingLeft)?(v.style.width=u[g].clientWidth-16+"px",-1!=u[f-1].className.indexOf("nivel")&&v.style.setProperty("width",u[f].clientWidth+"px")):(v.style.width=u[g].clientWidth-8+"px",-1!=u[f-1].className.indexOf("nivel")&&v.style.setProperty("width",u[f].clientWidth+"px")),u[f].parentNode.className,v.style.height=u[g].clientHeight-8+"px",v.style.paddingLeft=u[f].style.paddingLeft,null!=u[f].getAttribute("onclick")&&v.setAttribute("onclick",u[f].getAttribute("onclick")),v.setAttribute("data-linha",i),i+=1,t+=v.outerHTML}}else i+=1;var y=document.createElement("ul");y.className="fixed",y.setAttribute("data-i",g),y.style.setProperty("margin-top",0),y.innerHTML=t,document.getElementById(e+"fixed").innerHTML=document.getElementById(e+"fixed").innerHTML+y.outerHTML,t="",i=0}n=g,document.getElementById(e+"fixed").style.maxHeight=document.getElementById(e+"dv2").clientHeight+document.getElementById(e+"header").clientHeight-2+"px",document.getElementById(e+"fixed").clientWidth>document.getElementById(e+"dv2").clientWidth&&(alerta("feed-fixo",TR_LCF),document.getElementById(e+"fixed").innerHTML="")}}}}function popupmenu(e,t,n){if(document.getElementById("popupmenu")){var a=document.getElementById("popupmenu");if(a.classList.contains("visible")&&0==t.length)a.classList.remove("visible"),a.innerHTML="";else if(0==t.length)if(a.classList.add("visible"),sessionStorage.getItem("popupMenu")){var r=document.createElement("div");r.innerHTML=sessionStorage.getItem("popupMenu"),a.innerHTML="",a.appendChild(r.children[0])}else call("popupMenu","prm_tipo="+e+"&prm_cond="+t).then(function(e){sessionStorage.setItem("popupMenu",e);var t=document.createElement("div");t.innerHTML=e,a.innerHTML="",a.appendChild(t.children[0])});else{var o=document.getElementById("screengroup").children[n-1].offsetTop-document.getElementById("screengroup").scrollTop;document.getElementById("screenlist")?(document.getElementById("screenlist").classList.remove("show"),setTimeout(function(){if(sessionStorage.getItem(e+"-"+t)){document.getElementById("screenlist").remove();var n=document.createElement("div");n.innerHTML=sessionStorage.getItem(e+"-"+t),a.appendChild(n.children[0]),setTimeout(function(){document.getElementById("screenlist").style.setProperty("top",o+"px"),document.getElementById("screenlist").classList.add("show")},200)}else call("popupMenu","prm_tipo="+e+"&prm_cond="+t).then(function(n){sessionStorage.setItem(e+"-"+t,n),document.getElementById("screenlist").remove();var r=document.createElement("div");r.innerHTML=n,a.appendChild(r.children[0]),setTimeout(function(){document.getElementById("screenlist").style.setProperty("top",o+"px"),document.getElementById("screenlist").classList.add("show")},200)})},100)):sessionStorage.getItem(e+"-"+t)?(a.innerHTML=a.innerHTML+sessionStorage.getItem(e+"-"+t),setTimeout(function(){document.getElementById("screenlist").style.setProperty("top",o+"px"),document.getElementById("screenlist").classList.add("show")},200)):call("popupMenu","prm_tipo="+e+"&prm_cond="+t).then(function(n){sessionStorage.setItem(e+"-"+t,n),a.innerHTML=a.innerHTML+n,setTimeout(function(){document.getElementById("screenlist").style.setProperty("top",o+"px"),document.getElementById("screenlist").classList.add("show")},200)})}}}function fakeOption(e,t,n,a,r){var o=document.getElementById("fakelist");document.getElementById("attriblist").classList.contains("open")?(o.classList.remove("noattrib"),o.classList.add("attrib")):(o.classList.remove("attrib"),o.classList.add("noattrib")),document.getElementById("fakelist").classList.toggle("visible"),o.classList.contains("visible")&&call("fakelist","prm_ident="+e+"&prm_titulo="+t+"&prm_campo="+n+"&prm_visao="+a+"&prm_ref="+r).then(function(e){var t=document.querySelector(".closer").cloneNode(!0);o.innerHTML=e,o.appendChild(t)}).then(function(){document.getElementById("filter-value")&&document.getElementById("filter-value").focus()})}sessionStorage.clear(),document.addEventListener("mousedown",function(e){mousedown=!0}),document.addEventListener("mouseup",function(e){if(mousedown=!1,e.target.parentNode&&!(e.target.classList.contains("opt")||e.target.classList.contains("search")||e.target.parentNode.classList.contains("search")||e.target.parentNode.classList.contains("custom"))){var t=this.querySelectorAll(".fakelistbox.open");for(let n=0;n<t.length;n++){let a=t[n].parentNode;if(a.id!=e.target.id&&a.id!=e.target.parentNode.id&&a.parentNode.id!=e.target.parentNode.id&&!e.target.classList.contains("opt")){a.click(),t[n].classList.remove("open"),t[n].style.removeProperty("height");let e=t[n].previousElementSibling;0==e.innerHTML.length&&(e.innerHTML=e.getAttribute("data-placeholder"),e.setAttribute("data-custom","N"))}}}});var fake_conteudo="";function fakeListBox(e,t,n,a,r,o,l,i,d){var s=document.getElementById(e),c=s.children[0].getAttribute("data-fixed").length;if(s.querySelector(".fakelistbox").classList.contains("open")){if(s.classList.remove("open"),s.title!=s.getAttribute("data-default")){if(s.getAttribute("data-children")){var m=s.getAttribute("data-children");m.length>0&&fakeReset(m.split("|"))}s.setAttribute("data-default",s.title),s.previousElementSibling&&"script"==s.previousElementSibling.className&&s.previousElementSibling.click()}if(s.querySelector(".fakelistbox").querySelector(".selected"))var u=s.querySelector(".fakelistbox").querySelector(".selected").title,p=s.querySelector(".fakelistbox").querySelector(".selected").textContent;if(s.children[0].getAttribute("contentEditable")&&"mouseleave"!=i.type||(s.querySelector(".fakelistbox").style.removeProperty("height"),s.querySelector(".fakelistbox").classList.remove("open"),0==s.children[0].innerHTML.trim().length&&"N"==a&&(0==c&&(void 0===u?s.children[0].innerHTML=s.children[0].getAttribute("data-placeholder"):(s.children[0].innerHTML=p,s.children[0].title=u,s.title=u)),s.children[0].blur())),"S"==a&&"click"==i.type&&0==c){var g=s.querySelector(".fakelistbox").querySelectorAll(".selected, .reverse"),f=[];if(g.length>0){for(let e=0;e<g.length;e++)f.push(g[e].innerHTML);s.children[0].innerHTML=f.join(", ")}else s.children[0].innerHTML=""}0!=c&&s.children[0].getAttribute("data-fixed").length>0&&(s.children[0].innerHTML=s.children[0].getAttribute("data-fixed"))}else s.classList.add("open"),s.classList.add("loading"),fakeboxevent(e,t,n,a,r,o,s,c,"",l,d)}function fakeReset(e){for(let t=0;t<e.length;t++){let n=document.getElementById(e[t]),a=n.children[0];n.title="",n.setAttribute("data-default",""),n.setAttribute("data-ant",""),a.getAttribute("data-placeholder")?a.innerText=a.getAttribute("data-placeholder"):a.innerText=""}}function fakeboxReorder(e,t,n,a,r,o,l){var i,d="",s=e.parentNode.parentNode.title.indexOf("$[NOT]"),c=e.parentNode.parentNode.title.indexOf("|"),m=(e.parentNode.parentNode.title.trim().length,e.classList.contains("reverse"));if(l)var u=e.parentNode.querySelectorAll(".opt");e.classList.contains("selected")&&-1==s?-1!=c?(d="remove",i=[]):-1!=r.indexOf("true")?(d="add",i=[]):(d="remove",i=[]):m?(d="remove",i=[]):(d="add",i=e.parentNode.parentNode.title.split("|"));if(-1!=r.indexOf("true")){if(0==e.parentNode.parentNode.title.length){if(l){var p=[];for(let e=0;e<u.length;e++)u[e].classList.add("selected"),p.push(u[e].title);return e.parentNode.parentNode.title=p.join("|"),!1}e.classList.toggle("selected")}else{if(l){for(let e=0;e<u.length;e++)u[e].classList.remove("selected"),u[e].classList.remove("reverse");return e.parentNode.parentNode.title="",!1}-1==c?e.classList.contains("selected")||e.classList.contains("reverse")?-1!=s||"mouseover"==o?(e.classList.remove("selected"),e.classList.remove("reverse")):e.classList.add("reverse"):(-1!=s&&e.classList.add("reverse"),e.classList.add("selected")):m?(e.classList.remove("selected"),e.classList.remove("reverse")):-1==s?e.classList.toggle("selected"):(e.classList.toggle("selected"),e.classList.toggle("reverse"))}m=e.classList.contains("reverse")}else if(0==e.parentNode.parentNode.title.length){if(l){p=[];for(let e=0;e<u.length;e++)u[e].classList.add("selected"),p.push(u[e].title);return e.parentNode.parentNode.title=p.join("|"),!1}e.classList.toggle("selected")}else{if(l){for(let e=0;e<u.length;e++)u[e].classList.remove("selected");return e.parentNode.parentNode.title="",!1}e.classList.toggle("selected")}var g=e.parentNode.querySelectorAll(".selected"),f=!1;if(e.getAttribute("data-ordem"))if(e.classList.contains("selected"))switch(g.length){case 10:e.setAttribute("data-ordem","A");break;case 11:e.setAttribute("data-ordem","B");break;case 12:e.setAttribute("data-ordem","C");break;case 13:e.setAttribute("data-ordem","D");break;case 14:e.setAttribute("data-ordem","E");break;case 15:e.setAttribute("data-ordem","F");break;default:e.setAttribute("data-ordem",g.length)}else n=parseInt(e.getAttribute("data-ordem")),e.setAttribute("data-ordem",0),f=!0;var v,y="",h=[],_=[],b=e.parentNode.parentNode.title.split("|");if(v=-1!=s||m?"$[NOT]":"","remove"==d)for(let t=0;t<b.length;t++)b[t].replace("$[NOT]","")!=e.title&&i.push(b[t]);else e.classList.contains("selected")&&(m?i.push(v+e.title):i.push(e.title));g=e.parentNode.querySelectorAll(".selected");for(let e=0;e<g.length;e++)1==f?g[e].getAttribute("data-ordem")>=n&&g[e].setAttribute("data-ordem",g[e].getAttribute("data-ordem")-1):g[e].getAttribute("data-ordem")&&(y=g[e].getAttribute("data-ordem")+"#"),h.push(y+g[e].textContent),_.push(y+v+g[e].title);h=h.sort(),_=_.sort(),0==a&&0==document.getElementById(t).children[0].innerHTML.length&&(document.getElementById(t).children[0].innerHTML=""),document.getElementById(t).title=i.filter(e=>e).join("|").replace(/[0-9A-Z]+#/g,"")}var holdoption="",reversingoption="";function fakeboxevent(e,t,n,a,r,o,l,i,d,s,c){l.classList.remove("errorinput"),l.classList.add("loading");var m="";r.length>0&&(m=document.getElementById(r)?document.getElementById(r).title:r),o.length>0&&document.getElementById(o)&&(document.getElementById(o).classList.contains("dragme")||(o=document.getElementById(o).title));if(t.split("$").length>1){l.querySelector(".fakelistbox").innerHTML="";var u=fakeListCustom[t.replace("$","")],p=JSON.parse(u);for(let e in p)l.querySelector(".fakelistbox").appendChild(fakeTag(p[e].value,p[e].text,p[e].type,n));fakeEvent(l,e,n,a,r,o,i,d,s),l.classList.remove("loading")}else call("fakelistoptions","prm_ident="+e+"&prm_campo="+t+"&prm_visao="+m+"&prm_ref="+encodeURIComponent(n)+"&prm_adicional="+encodeURIComponent(o)+"&prm_search="+d).then(function(e){l.querySelector(".fakelistbox").innerHTML=e}).then(function(){fakeEvent(l,e,n,a,r,o,i,d,s)}).then(function(){l.classList.remove("loading")})}function fakeTag(e,t,n,a){var r=document.createElement("li");return r.className=n,a==e&&(r.className=n+" selected"),r.title=e,r.innerHTML=t||e,r}function fakeEvent(e,t,n,a,r,o,l,i,d){if(e.querySelector(".fakelistbox").children[0]){var s=e.querySelector(".fakelistbox").children.length;s>7&&(s=7);var c=e.querySelector(".fakelistbox").children[0].clientHeight+2,m=s*c,u=e.getBoundingClientRect().top,p=e.clientHeight;if("painel"==e.parentNode.id)var g=e.parentNode.clientHeight;else g=PRINCP.clientHeight;m+u+c>g&&!document.querySelector(".mobile")?u<m?(m=u-p,e.querySelector(".fakelistbox").style.setProperty("bottom",p+"px")):e.querySelector(".fakelistbox").style.setProperty("bottom",p+"px"):e.querySelector(".fakelistbox").style.setProperty("top",p+"px"),e.querySelector(".fakelistbox").style.setProperty("height",m+"px"),e.querySelector(".search")&&i.length>0&&(e.querySelector(".search").value=i,e.querySelector(".search").focus()),e.classList.remove("loading"),e.querySelector(".fakelistbox").classList.add("open");var f=e.querySelector(".fakelistbox").querySelectorAll(".opt"),v=f.length;for(let e=0;e<v;e++){if(linhai=f[e],"S"!=a||document.querySelector(".mobile")||linhai.addEventListener("mouseover",function(e){1==mousedown&&fakeboxReorder(this,t,0,l,d,"mouseover",!1)}),document.getElementById(t).children[0].setAttribute("data-custom","N"),"S"==a){linhai.addEventListener("click",function(e){e.stopPropagation()});var y=down}else y=up;linhai.addEventListener(y,function(e){if(1==e.which&&(mousedown=!0),"S"==a){var n;if(PRINCP.classList.contains("mac"))try{n=e.metaKey}catch(t){n=e.ctrlKey}else n=e.ctrlKey;fakeboxReorder(this,t,0,l,d,y,n)}else this.parentNode.parentNode.getAttribute("data-min")>0?(this.parentNode.querySelector(".selected")&&this.parentNode.querySelector(".selected").classList.remove("selected"),this.classList.add("selected")):this.classList.contains("selected")?this.classList.remove("selected"):(this.parentNode.querySelector(".selected")&&this.parentNode.querySelector(".selected").classList.remove("selected"),this.classList.add("selected")),this.parentNode.querySelector(".selected")?(0==l&&(document.getElementById(t).children[0].innerHTML=this.parentNode.querySelector(".selected").innerHTML),document.getElementById(t).title=this.parentNode.querySelector(".selected").title):(0==l&&(document.getElementById(t).children[0].innerHTML=""),document.getElementById(t).title=""),document.getElementById(t).setAttribute("data-ant",document.getElementById(t).title),this.classList.contains("opt")&&(document.querySelector(".custom")&&(document.querySelector(".custom").children[0].value,document.querySelector(".custom").children[0].removeAttribute("value")),this.parentNode.parentNode.click())})}}else alerta("feed-fixo",TR_NR)}function loader(e){if(!document.getElementById(e).querySelector(".load")){var t=document.getElementById(e);if("TBODY"==t.tagName)(n=document.createElement("td")).setAttribute("colspan","99"),n.style.setProperty("text-align","center");else var n=document.createElement("div");t.innerHTML="",n.className="load",n.innerHTML=LAYER.children[1].innerHTML,document.getElementById(e).appendChild(n)}document.getElementById("content").classList.add("loading")}function ordem(e,t){document.getElementById(e)?(ajax("order","alterorder","prm_objeto="+e+"&prm_valor="+t,!1,e),document.getElementById(e).style.zindex=""):(parametro=document.getElementById(e+"trl").value,ajax("order","alterorder","prm_objeto="+e+"&prm_valor="+t,!1,e,document.getElementById(e+"trl").style.zIndex,parametro),document.getElementById(e+"trl").style.zindex="")}function menuLink(e,t){if("FILE"!=this.parentNode.className){e=this.parentNode.id.replace("menu","");t=this.innerHTML,remover(e+"trl"),-1==e.indexOf("ORG")?(document.getElementById(e)&&-1!=document.getElementById(e).className.indexOf("relatorio")&&document.getElementById(e).remove(),document.getElementById("drill_obj").value=e,cleardrill(),appendar("prm_drill=Y&prm_objeto="+e+"&PRM_POSX=200PX&PRM_POSY=100PX&PRM_ZINDEX=2&prm_screen="+tela+"&prm_track="+e+"&prm_objeton="+t,"",""),centerDrill(e),carrega("ajobjeto?prm_objeto="+e+"trl")):(appendar("prm_drill=Y&prm_objeto="+e+"&PRM_POSX="+cursorx+"PX&PRM_POSY="+cursory+"PX&PRM_ZINDEX=2&prm_screen="+tela+"&prm_track="+e+"&prm_objeton="+t,"",""),setTimeout(function(){carrega("ajobjeto?prm_objeto="+e)},6e3))}}function donut(e){if("slide-S"!=PRINCP.className){e.stopPropagation();e.target;var t=document.getElementById("donut");t.classList.contains("open")?t.classList.remove("open"):(e.clientY+t.clientHeight>window.innerHeight?t.style.setProperty("top",e.clientY-t.clientHeight+"px"):t.style.setProperty("top",e.clientY+"px"),t.style.setProperty("left",e.clientX+10+"px"),t.classList.add("open"))}}function cycle(e,t){var n=new Array,a=MAIN.querySelectorAll(".dragme.dados, .dragme.grafico, .dragme.medidor"),r=a.length;for(let e=0;e<r;e++)n[e]=a[e].id;scale(e,"indirect"),setTimeout(function(){var r=n.indexOf(e);r="next"==t?parseInt(r)+1<a.length?parseInt(r)+1:0:parseInt(r)-1>-1?parseInt(r)-1:a.length-1,scale(a[parseInt(r)].id,"indirect")},100)}function savepwd(){document.getElementById("salvar").setAttribute("class",""),document.getElementById("salvar").setAttribute("onclick","var senha1 = document.getElementById('senha1').value;  ajax('fly', 'save_pwd', 'prm_senha='+encodeURIComponent(senha1)+'&prm_email='+document.getElementById('email').value+'&prm_number='+document.getElementById('number').value+'&prm_nome='+document.getElementById('completo').value); curtain(); setTimeout(function(){ window.location.reload(true); },4000); ")}function send_textPost(e,t){var n="",a=get("campo");document.getElementById("par_"+e)&&(n=document.getElementById("par_"+e).value),document.getElementById("par_"+e+"trl")&&(n=document.getElementById("par_"+e+"trl").value);var r="";if(document.getElementById("mvs_"+e)&&(r=document.getElementById("mvs_"+e).value),document.getElementById("mvs_"+e+"trl")&&(r=document.getElementById("mvs_"+e+"trl").value),(o=document.getElementById("fieldmsg").value.replace(/<.*?>/g,"")).length>1){var o=encodeURIComponent(o);document.getElementById("sendmail").classList.contains("selected")?email="S":email="N",document.getElementById("sendsms").classList.contains("selected")?sms="S":sms="N";var l=document.querySelector(".list_container").querySelector(".selected").title;call("insert_post","prm_objeto="+e+"&prm_screen="+tela+"&prm_visao="+r+"&prm_usuario="+l+"&prm_msg="+o+"&prm_time="+document.getElementById("tempo-msg").title+"&prm_line="+t+"&prm_email="+email+"&prm_sms="+sms+"&prm_filtro="+n).then(function(e){-1==e.indexOf("FAIL")?call("text_post","prm_objeto=&prm_line=&prm_group="+l).then(function(e){a.innerHTML=e,a.scrollTop=a.scrollHeight}):alerta("msg",TR_ER_MS)}),document.getElementById("fieldmsg").value=""}}function selectTextPost(e){e.parentNode.querySelector(".selected")&&e.parentNode.querySelector(".selected").classList.remove("selected"),e.classList.add("selected"),e.classList.remove("msgs"),call("text_post","prm_objeto=&prm_line=&prm_group="+e.title).then(function(e){let t=get("campo");t.innerHTML=e,t.scrollTop=t.scrollHeight})}function fakeLang(e,t,n){var a=document.getElementById("fakelist");if(""==a.className){"open"==document.getElementById("attriblist").className&&a.style.setProperty("left","330px"),attReopen(function(){ajax("list","fakelist","prm_ident="+e+"&prm_titulo="+n+"&prm_campo=lang&prm_visao="+t,!1,"attriblist")},"attriblist")}a.classList.toggle("visible")}var fallback="";"undefined"!=typeof ADMIN&&("A"==ADMIN&&("undefined"==typeof ace&&(console.log("fallback ace cdn"),fallback+='<script src="dwu.fcl.download?arquivo=ace.js"><\/script>'),fallback+='<script src="dwu.fcl.download?arquivo=mode-sql.js"><\/script>'),document.write(fallback)),paste="";var clickGlobal=new Object;function start(){if(window.addEventListener("scroll",function(){get("jumpdrill")&&get("jumpdrill").remove(),get("jumpmed")&&get("jumpmed").remove(),get("selecteddata")&&(get("selecteddata").id=""),document.querySelector(".optionbox.obsbox.open")&&(document.querySelector(".optionbox").classList.remove("open"),setTimeout(function(){document.querySelector(".optionbox").remove()},200))}),document.addEventListener("mousedown",selectmouse),document.addEventListener("touchstart",selectmouse),document.addEventListener("mouseup",function(){isdrag=!1,xdrag=0,ydrag=0}),document.addEventListener("touchend",function(){isdrag=!1,xdrag=0,ydrag=0}),document.addEventListener("mousemove",movemouse),document.addEventListener("touchmove",movemouse),document.getElementById("show_comandos")&&(document.getElementById("show_comandos").addEventListener("click",function(e){if("backward"==e.target.className||"backward"==e.target.parentNode.className||"backward"==e.target.parentNode.parentNode.className){clearInterval(sobbar),clearTimeout(activeshow),document.getElementById("show_only_bar").style.setProperty("width",0);var t=document.getElementById("active-show").previousElementSibling;"show_only"==t.className?(document.getElementById("active-show").id="",t.id="active-show",removeTrash(),shscr(t.value)):(document.getElementById("active-show").id="",projecoes[projecoes.length-1].id="active-show",removeTrash(),shscr(projecoes[projecoes.length].value))}if("forward"==e.target.className||"forward"==e.target.parentNode.className||"forward"==e.target.parentNode.parentNode.className){clearInterval(sobbar),clearTimeout(activeshow),document.getElementById("show_only_bar").style.setProperty("width",0);var n=document.getElementById("active-show").nextElementSibling;"show_only"==n.className?(document.getElementById("active-show").id="",n.id="active-show",removeTrash(),shscr(n.value)):(document.getElementById("active-show").id="",projecoes[0].id="active-show",removeTrash(),shscr(projecoes[0].value))}e.target.className}),document.addEventListener("keyup",function(e){if(!LAYER.classList.contains("ativo")){var t,n=e.keyCode;if("39"==n)if(document.getElementById("show_only_bar"))clearInterval(sobbar),clearTimeout(activeshow),document.getElementById("show_only_bar").style.setProperty("width",0),"show_only"==(t=document.getElementById("active-show").nextElementSibling).className?(document.getElementById("active-show").id="",t.id="active-show",removeTrash(),shscr(t.value)):(document.getElementById("active-show").id="",projecoes[0].id="active-show",removeTrash(),shscr(projecoes[0].value));if("37"==n)if(document.getElementById("show_only_bar"))clearInterval(sobbar),clearTimeout(activeshow),document.getElementById("show_only_bar").style.setProperty("width",0),"show_only"==(t=document.getElementById("active-show").previousElementSibling).className?(document.getElementById("active-show").id="",t.id="active-show",removeTrash(),shscr(t.value)):(document.getElementById("active-show").id="",projecoes[projecoes.length].id="active-show",removeTrash(),shscr(projecoes[projecoes.length].value))}})),document.removeEventListener(up,clickGlobal),clickGlobal=function(e){var t=e.target;if(t.classList.contains("options")&&"touchend"==up&&(e.stopPropagation,t.classList.toggle("hover")),t.classList.contains("fechar")&&(t.parentNode.remove(),document.querySelector("."+t.parentNode.id+"_jump")&&document.querySelector("."+t.parentNode.id+"_jump").remove()),t.classList.contains("removeobj")&&confirm("Excluir objeto da tela?")&&remover(t.parentNode.parentNode.id,"excluir"),t.classList.contains("preferencias")&&((t.parentNode.parentNode.classList.contains("front")||t.parentNode.parentNode.classList.contains("grafico")||t.parentNode.parentNode.classList.contains("dados")||t.parentNode.parentNode.classList.contains("marquee")||t.parentNode.parentNode.classList.contains("texto")||t.parentNode.parentNode.classList.contains("icone")||t.parentNode.parentNode.classList.contains("medidor")||t.parentNode.parentNode.classList.contains("file")||t.parentNode.parentNode.classList.contains("relatorio")||t.parentNode.parentNode.classList.contains("generico"))&&loadAttrib("ed_gadg","ws_par_sumary="+t.parentNode.parentNode.id.replace("trl","")),t.parentNode.parentNode.classList.contains("pro6")&&loadAttrib("ed_call","prm_object="+t.parentNode.parentNode.id.replace("trl","")+"&prm_screen="+tela)),t.classList.contains("filtros")&&openFilter(t.parentNode.parentNode.id+"-filterlist"),t.classList.contains("destaques")&&openDestaque(t.parentNode.parentNode.id+"-destaquelist"),t.classList.contains("talk")){var n=document.getElementById("text-talk");if(n.classList.contains("open"))n.classList.remove("open");else{var a=document.getElementById("drill_go").value;n.classList.remove("open"),n.setAttribute("data-line",a),n.setAttribute("data-objeto",t.parentNode.parentNode.id),ajax("list","text_post","prm_objeto="+t.parentNode.parentNode.id+"&prm_line="+a,!1,"campo"),n.classList.add("open"),document.getElementById("campo").scrollTo(0,1e5),textTalkint=setInterval(function(){document.getElementById("campo")?ajax("list","text_post","prm_objeto="+t.parentNode.parentNode.id.replace("trl","")+"&prm_line="+a,!0,"campo"):clearInterval(textTalkint),document.getElementById("campo").scrollTo(0,1e5)},5e3),get("jumpdrill")&&(get("jumpdrill").style.setProperty("opacity","0"),setTimeout(function(){get("jumpdrill").innerHTML=""},100))}}if(t.classList.contains("excel")&&toexcel2(t.parentNode.parentNode.id),t.classList.contains("data_table")&&"A"==ADMIN){let e=t.parentNode.id.replace("more",""),n=get("dados_"+e).getAttribute("data-visao");document.getElementById("titulo").innerHTML=t.title,call_save("consulta"),carregaPainel("data_table",n+"|"+e.replace("trl","")),carrega("consulta?prm_objeto="+e.replace("trl","")+"&prm_visao="+n),curtain("enabled")}if(t.classList.contains("lightbulb")){let e=t.parentNode.id.replace("more","");t.parentNode.parentNode.classList.contains("pro6")?(telaSup("objeto",e.replace("trl","")),titulo(t,"c"),curtain("enabled"),carregaPainel("list_call",t.parentNode.parentNode.id),"A"==ADMIN?carrega("list_call?prm_objeto="+e.replace("trl","")+"&prm_screen="+tela):carrega("list_call_end?prm_objeto="+e.replace("trl","")+"&prm_screen="+tela),get("attriblist").querySelector(".closer").click(),call_save("")):(titulo(t,"c"),call_save(""),telaSup("objeto",e.replace("trl","")),carregaPainel("list_go",e.replace("trl","")),carrega("list_go?prm_objeto="+e.replace("trl","")),curtain("enabled"))}if(t.classList.contains("filter")){let e=t.parentNode.id.replace("more",""),n=get("dados_"+e).getAttribute("data-visao");titulo(t,"c"),call_save(""),telaSup("objeto",e.replace("trl","")),telaSup("visao",n),carregaPainel("list_ofiltro",e.replace("trl","")+"|"+n),carrega("list_ofiltro?ws_par_sumary="+e.replace("trl","")+"&prm_visao="+n),curtain("enabled")}if(t.classList.contains("sigma")){let e=t.parentNode.id.replace("more",""),n=get("dados_"+e).getAttribute("data-visao");carregaPainel("calculada",e.replace("trl","")),document.getElementById("titulo").innerHTML=t.title,call_save(""),carrega("list_calculada?prm_objeto="+e.replace("trl","")+"&prm_visao="+n),curtain("enabled")}if(t.classList.contains("star")){let e=t.parentNode.id.replace("more",""),n=get("dados_"+e).getAttribute("data-visao");titulo(t,"c"),call_save(""),telaSup("visao",n),telaSup("objeto",e.replace("trl","")),carregaPainel("blink",e.replace("trl","")+"|"+n),carrega("blink?prm_objeto="+e.replace("trl","")+"&prm_visao="+n),curtain("enabled")}if(t.classList.contains("conf"))if(document.getElementById("custom-conteudo")){let e=document.getElementById("custom-conteudo-new"),n=document.getElementById("custom-conteudo-desc"),a=document.getElementById("custom-conteudo-group"),r=document.getElementById("custom-conteudo-submit");if(e.classList.contains("open"))return e.classList.remove("open"),void t.parentNode.classList.remove("visible");e.classList.add("open"),t.parentNode.classList.add("visible");let o=document.getElementById("lista-custom-fav").title.split("||"),l=t.parentNode.children[3].value,i="",d="",s="";o[1]&&(s=o[0]),e.setAttribute("data-url",l),e.setAttribute("data-custom",s),document.getElementById("lista-custom-fav").title.length>0&&(i=document.getElementById("lista-custom-fav").children[0].innerHTML.trim(),d=o[1]),e.style.setProperty("left",t.getBoundingClientRect().left-316+"px"),e.style.setProperty("top",t.getBoundingClientRect().top-18+"px"),n.setAttribute("value",i),a.setAttribute("value",d),"false"==n.getAttribute("data-event")&&(n.addEventListener("keypress",function(e){"13"==e.which&&this.nextElementSibling.focus()}),n.setAttribute("data-event","true")),"false"==a.getAttribute("data-event")&&(a.addEventListener("keypress",function(e){"13"==e.which&&(i=get("custom-conteudo-desc").value,d=get("custom-conteudo-group").value,l=this.parentNode.getAttribute("data-url"),s=this.parentNode.getAttribute("data-custom"),inputCustom(i,d,l,s,this.parentNode.previousElementSibling))}),a.setAttribute("data-event","true")),"false"==r.getAttribute("data-event")&&(r.addEventListener("click",function(e){i=get("custom-conteudo-desc").value,d=get("custom-conteudo-group").value,l=this.parentNode.getAttribute("data-url"),s=this.parentNode.getAttribute("data-custom"),inputCustom(i,d,l,s,this.parentNode.previousElementSibling)}),r.setAttribute("data-event","true"))}else{loading();let e=t.parentNode.parentNode.id;ajax("fly","favoritar","prm_objeto="+e+"&prm_nome="+document.getElementById(e+"_ds").innerHTML+"&prm_url=&prm_screen="+tela+"&prm_parametros="+encodeURIComponent(document.getElementById("par_"+e).value)+"&prm_dimensao="+encodeURIComponent(document.getElementById("col_"+e).value)+"&prm_medida="+encodeURIComponent(document.getElementById("agp_"+e).value)+"&prm_pivot="+encodeURIComponent(document.getElementById("cup_"+e).value)+"&prm_acao=incluir",!1),loading(),call("obj_screen_count","prm_screen="+tela+"&prm_tipo=FAVORITOS").then(function(e){parseInt(e)>0?document.getElementById("favoritos").classList.remove("inv"):document.getElementById("favoritos").classList.add("inv")})}if(t.classList.contains("arrowturn")){loading();var r=t.parentNode.parentNode.id.replace("trl","");if(t.parentNode.parentNode.classList.contains("cross"))var o="N";else o="S";if(document.getElementById("par_"+t.parentNode.parentNode.id))var l=document.getElementById("par_"+t.parentNode.parentNode.id).value;else l="";if("mac"==PRINCP.className||"mobile"==PRINCP.className)var i="-webkit-order";else i="order";if(t.parentNode.parentNode.parentNode.style.getPropertyValue(i)&&!t.parentNode.parentNode.parentNode.classList.contains("drill")){var d=t.parentNode.parentNode.parentNode.style.getPropertyValue(i),s="&prm_dashboard=true";dashlocation=t.parentNode.parentNode.parentNode.id}else{d=t.parentNode.parentNode.offsetLeft;var c=t.parentNode.parentNode.offsetTop;s="&prm_dashboard=false"}document.getElementById("drill_obj").value=r,document.getElementById(r)?document.getElementById(r).remove():document.getElementById(r+"trl").remove();let e="";t.parentNode.parentNode.classList.contains("drill")&&(e="Y"),appendar("prm_drill="+e+"&prm_objeto="+r+"&prm_parametros="+l+"&PRM_POSX="+d+"&PRM_POSY="+c+"&PRM_ZINDEX=2&prm_screen="+tela+"&prm_track="+r+"&prm_objeton=&prm_cross="+o+s,dashlocation,!1)}if(t.classList.contains("size")){attReopen(function(){call("av_prop","ws_par_sumary="+t.parentNode.id.replace("more","").replace("trl","")+"&prm_screen="+tela).then(function(e){document.getElementById("attriblist").innerHTML=e}).then(function(){t.parentNode.classList.remove("hover")})},"attriblist")}if(t.classList.contains("aduser")){document.querySelector(".optionbox")&&document.querySelector(".optionbox").remove();let e=t.title;attReopen(function(){call("advancedUsers","prm_user="+e).then(function(e){get("attriblist").innerHTML=e})},"attriblist")}"custom"==t.id&&lmenuLink(t)},document.addEventListener(up,clickGlobal),document.getElementById("call-menu")){var e=document.getElementById("call-menu");call("obj_screen_count","prm_screen=DEFAULT&prm_tipo=CALL_LIST").then(function(t){parseInt(t)>0?e.classList.remove("invisible"):e.classList.add("invisible")})}if(document.getElementById("show_only_screen")&&document.getElementById("float-filter")){var t=document.getElementById("float-filter");call("obj_screen_count","prm_screen=DEFAULT&prm_tipo=FLOAT").then(function(e){parseInt(e)>0?t.classList.remove("invisible"):t.classList.add("invisible")})}if(document.getElementById("fechar_sup").addEventListener("click",fecharSup),document.getElementById("prefdrop")){var n=document.getElementById("prefdrop").children;for(o=0;o<n.length;o++)"noscript"!=n[o].className&&(n[o].firstElementChild.addEventListener("mousedown",function(){document.getElementById("prefdrop").clientWidth>60&&lmenuLink(this)}),n[o].firstElementChild.addEventListener("touchend",function(e){e.cancelBubble(),e.preventDefault(),document.getElementById("prefdrop").clientWidth>60&&lmenuLink(this)}))}"A"==ADMIN&&(document.addEventListener("keypress",function(e){var t=e.which,n=document.getElementById("debug-key");switch(t){case 100:case 68:startTimer=setTimeout(function(){n.value=0},1e4),n.value=e.which;break;case 101:case 69:"100"==n.value||"68"==n.value?n.value=e.which:n.value=0;break;case 98:case 66:"101"==n.value||"69"==n.value?n.value=e.which:n.value=0;break;case 117:case 85:"98"==n.value||"66"==n.value?n.value=e.which:n.value=0;break;case 103:case 71:"117"==n.value||"85"==n.value?(n.value=0,""==document.getElementById("debug").className?(document.getElementById("debug").setAttribute("class","active"),setTimeout(function(){document.getElementById("debug").firstElementChild.focus()},100)):document.getElementById("debug").setAttribute("class","")):n.value=0;break;default:n.value=0}}),document.addEventListener("keydown",function(e){e.ctrlKey&&"Enter"==e.key&&(e.preventDefault(),document.getElementById("data_list_menu")&&document.getElementById("data_list_menu").classList.contains("open")&&(document.getElementById("data-valor").focus(),document.getElementById("data-valor").blur(),document.querySelector(".link.ac1").click()))})),document.addEventListener("mousemove",function(e){cursorx=e.pageX-12,cursory=e.pageY-12}),document.addEventListener("touchstart",function(e){cursorx=e.touches[0].pageX-12,cursory=e.touches[0].pageY-12}),document.getElementById("princp").addEventListener("touchstart",function(e){"princp"==e.target.id&&"open"==document.getElementById("attriblist").className&&(document.getElementById("attriblist").className="")}),window.addEventListener("orientationchange",function(){0==window.orientation?(PRINCP.classList.add("retrato"),PRINCP.classList.remove("paisagem")):(PRINCP.classList.remove("retrato"),PRINCP.classList.add("paisagem"))}),window.addEventListener("touchstart",function(e){var t=e.touches;if(t.length>1){var n=document.getElementById("donut");n.style.left=t[1].clientX+15+"px",n.style.top=t[1].clientY+45+"px",n.classList.toggle("open")}}),window.addEventListener("touchmove",function(e){clearTimeout(time)}),window.addEventListener("touchend",function(){clearTimeout(time)}),apscreen("DWU.fcl.show_screen?prm_screen=DEFAULT","DEFAULT");var a=document.getElementById("loading-bar").children[0].children[0],r="";if(setTimeout(function(){r=setInterval(function(){a.style.setProperty("width",parseInt(a.style.getPropertyValue("width"))+1+"%")},40)},200),setTimeout(function(){clearInterval(r),a.style.setProperty("width","60%")},300),setTimeout(function(){a.style.setProperty("width","100%")},1e3),setTimeout(function(){remover("starting"),mac(),donutEvent(),telasup=document.getElementById("telasup")},1300),(projecoes=document.querySelectorAll(".show_only")).length>0){var o=0;projecoes[0].id="active-show",setTimeout(function(){shscr(projecoes[0].value)},3100)}if("DEFAULT"==document.getElementById("current_screen").value)var l=0,i=setInterval(function(){if(null==document.getElementById("loading-bar")||0==l){clearInterval(i),l=1;var e=document.querySelectorAll(".dragme"),t=e.length;for(let n=0;n<t;n++){if(document.getElementById(e[n].id+"more"))document.getElementById(e[n].id+"more").addEventListener("touchend",function(){this.classList.add("hover");setTimeout(function(e){e.classList.remove("hover")},5e3)})}}},2e3);fakeListCustom.tpGroup='{ "1": { "value": "", "text": "'+TR_TP_MT+'", "type": "group" }, "2": { "value": "ROLL", "text": "'+TR_TP_SI+'", "type": "opt" }, "3": { "value": "GROUP", "text": "'+TR_TP_NA+'", "type": "opt" } }',fakeListCustom.amostra='{ "1": { "value": "", "text": "'+TR_AM_LL+'", "type": "group" }, "2": { "value": "50", "text": "50", "type": "opt" }, "3": { "value": "100", "text": "100", "type": "opt" }, "4": { "value": "200", "text": "200", "type": "opt" } }',fakeListCustom.condicoesSimples='{ "1": { "value": "", "text": "'+TR_CS_CD+'", "type": "group" }, "2": { "value": "IGUAL", "text": "'+TR_CS_IA+'", "type": "opt" }, "3": { "value": "DIFERENTE", "text": "'+TR_CS_DD+'", "type": "opt" }, "4": { "value": "MAIOR", "text": "'+TR_CS_MA+'", "type": "opt" }, "5": { "value": "MENOR", "text": "'+TR_CS_ME+'", "type": "opt" }, "6": { "value": "MAIOROUIGUAL", "text": "'+TR_CS_AI+'", "type": "opt" }, "7": { "value": "MENOROUIGUAL", "text": "'+TR_CS_EI+'", "type": "opt" }, "8": { "value": "LIKE", "text": "'+TR_CS_SE+'", "type": "opt" }, "9": { "value": "NOTLIKE", "text": "'+TR_CS_NS+'", "type": "opt" } }'}function openFilter(e){if(document.getElementById(e)){var t=document.getElementById("filterlist");t.className="filtro hidden",t.getAttribute("data-desc")!=e&&setTimeout(function(){t.innerHTML=document.getElementById(e).innerHTML,t.className="filtro show",t.setAttribute("data-desc",e)},400),t.setAttribute("data-desc","")}}function openDestaque(e){if(document.getElementById(e)){var t=document.getElementById("destaquelist");t.className="filtro hidden",t.getAttribute("data-desc")!=e&&setTimeout(function(){t.innerHTML=document.getElementById(e).innerHTML,t.className="filtro show",t.setAttribute("data-desc",e)},400),t.setAttribute("data-desc","")}}function blurView(e,t){e.value!=e.getAttribute("data-default")&&call("save_view","prm_view="+t+"&prm_valor="+encodeURIComponent(e.value)+"&prm_tipo=desc").then(function(t){-1==t.indexOf("#alert")&&(e.setAttribute("data-default",e.value),alerta("msg",TR_AL))})}function viewDetalhes(e){document.getElementById("content").innerHTML="",carregaPainel("list_crocks",e),call("load_crocks","prm_visao="+e).then(function(e){document.getElementById("painel-colunas").innerHTML=e}),telaSup("visao",e)}function saveView(e,t,n){call("save_view","prm_view="+t+"&prm_valor="+(e.nextElementSibling?e.nextElementSibling.title:e.value)+"&prm_tipo="+n).then(function(e){-1==e.indexOf("FAIL")?alerta("feed-fixo",TR_AL):alerta("feed-fixo",TR_ER)})}var telasup="";function telaSup(e,t,n){if(void 0!==n)return telasup.getAttribute("data-"+e);telasup.setAttribute("data-"+e,t)}var ie=document.all,nn6=document.getElementById&&!document.all,isdrag=!1,xdrag,ydrag,dobj;function movemouse(e){if(isdrag){if(e)var t=e.type;else t="nomove";if("touchmove"==t){var n=nn6?e.touches.item(0):event.touches.item(0);if((o=parseInt(tx+n.clientX-xdrag))%5!=0)var a=10*Math.round(o/10);else a=o;if((l=parseInt(ty+n.clientY-ydrag))%5!=0)var r=10*Math.round(l/10);else r=l;return dobj.style.setProperty("left",a+"px"),dobj.style.setProperty("top",r+"px"),!1}var o,l;if((o=parseInt(tx+e.clientX-xdrag))%5!=0)a=10*Math.round(o/10);else a=o;if((l=parseInt(ty+e.clientY-ydrag))%5!=0)r=10*Math.round(l/10);else r=l;return dobj.style.setProperty("left",a+"px"),dobj.style.setProperty("top",r+"px"),!1}}function selectmouse(e){var t=nn6?e.target:event.srcElement,n=nn6?"HTML":"BODY";if(t.classList.contains("wd_move"))for(;t.tagName!=n&&"dragme"!=t.className&&"dragme front top"!=t.className&&"dragme front"!=t.className&&"dragme front cross"!=t.className&&"dragme dados"!=t.className&&"dragme medidor"!=t.className&&"dragme medidor drill"!=t.className&&"dragme grafico"!=t.className&&"dragme float-par"!=t.className&&"dragme file"!=t.className&&"dragme file drill"!=t.className&&"dragme texto"!=t.className&&"dragme grid"!=t.className&&"dragme img"!=t.className&&"dragme icone"!=t.className&&"dragme ponteiro drill"!=t.className&&"dragme grafico drill"!=t.className&&"dragme front drill"!=t.className&&"dragme front drill cross"!=t.className&&"dragme marquee"!=t.className&&"dragme relatorio"!=t.className&&"dragme heatmap"!=t.className&&"dragme grafico mapa"!=t.className&&"dragme grafico drill mapa"!=t.className&&"dragme generico"!=t.className;)t=nn6?t.parentNode:t.parentElement;if(t.classList.contains("dragme")&&("main"==t.parentNode.parentNode.parentNode.id||"main"==t.parentNode.parentNode.id||"main"==t.parentNode.parentNode.parentNode.parentNode.id||"main"==t.parentNode.id)&&"yes"==document.getElementById("movimento").value){if(e.preventDefault(),isdrag=!0,dobj=t,tx=parseInt(window.getComputedStyle(dobj).getPropertyValue("left")),ty=parseInt(window.getComputedStyle(dobj).getPropertyValue("top")),e)var a=e.type;else a="nomove";if("touchstart"==a){var r=nn6?e.touches.item(0):event.touches.item(0);xdrag=r.clientX,ydrag=r.clientY}else xdrag=nn6?e.clientX:event.clientX,ydrag=nn6?e.clientY:event.clientY;return!1}}function syncForm(e,t,n){var a=new Blob([document.getElementById(e).innerHTML],{type:n}),r=new FormData;r.set("arquivo",a,t),ajax("fly","upload",r,!1,"","","","upload")}var dataid="";function drillfix(e,t,n){var a=get(t),r=get("dados_"+t).getAttribute("data-track"),o="consulta";if(a.classList.contains("grafico")&&(o="grafico",get("dados_"+t).getAttribute("data-tipo")),(a.classList.contains("medidor")||a.classList.contains("dados"))&&(o="valor"),"consulta"!=o&&0==parseInt(get("dados_"+t).getAttribute("data-drill")))return!1;get("jumpdrill")&&get("jumpdrill").remove();var l=160;"mobile"==PRINCP.className&&(l=90);var i,d,s,c=get("dados_"+t).getAttribute("data-visao"),m=a.getAttribute("data-grupo"),u="normal",p="complete";if("grafico"==o)l=100,i=n.split("|").filter((e,t)=>t%2).join("|"),d=cursorx-l+5,s="top: "+(cursory-get("html").scrollTop+40)+"px",p="short";else if("consulta"==o){var g=get("selecteddata");get("selectedline").children[0].getAttribute("data-valor"),i=get("col_"+t).value;var f=g.getBoundingClientRect();s="top: "+(f.top+(g.clientHeight+4))+"px;";var v=0;(d=f.left+g.clientWidth/2-l)+320>MAIN.clientWidth&&(d=MAIN.clientWidth-320),f.top+(g.clientHeight+8)+l>PRINCP.clientHeight&&(s="bottom: "+(PRINCP.getBoundingClientRect().height-get("selecteddata").getBoundingClientRect().top+4)+"px;",u="reverse"),get(t+"c").children[0].children.length>1&&(v=get(t+"c").children[0].children[0].querySelectorAll(".fix").length);var y,h=g.cellIndex-v;get(t+"c").children[0].lastElementChild.children[h]&&(y=get(t+"c").children[0].lastElementChild.children[h].getAttribute("data-valor"))}else{l=100,get("gxml_"+t)&&(i=get("gxml_"+t).getAttribute("data-parametros")),get("valores_"+t)&&(i=get("valores_"+t).getAttribute("data-colunareal")),h=get("valor_"+t)?get("valor_"+t).getBoundingClientRect():get(t+"_vl").getBoundingClientRect(),d=h.x+h.width/2-l,s="top: "+(h.y+h.height+10)+"px",p="short"}d<0&&(d=0),call("jumpdrill","prm_objeto="+t+"&prm_colunas="+i+"&prm_visao="+c+"&prm_objeto_ant="+r).then(function(e){let n=document.createElement("div");n.innerHTML=e,n.children[0].setAttribute("style","left: "+d+"px; "+s);let a=[];a.push(get("par_"+t).value),a.push(get("drill_go").value);let r=[...new Set(a.sort())];n.children[0].title=r.filter(e=>e).join("|"),n.children[0].title=n.children[0].title.replace("||","|"),MAIN.appendChild(n.children[0])}).then(function(){var e=get("jumpdrill");e.classList.add(u),e.classList.add(p),e.classList.add(t+"_jump"),setTimeout(function(){e.querySelector(".fechartab").addEventListener("click",function(){this.parentNode.remove(),get("selecteddata")&&(get("selecteddata").id="")}),e.classList.add("open");let n=e.querySelectorAll(".icons");for(let e=0;e<n.length;e++)n[e].addEventListener("click",function(){quickPa(this)});get(t+"dv2")&&(get(t+"dv2").removeEventListener("scroll",noScroll),get(t+"dv2").addEventListener("scroll",noScroll))},10),get("confirm-tag").addEventListener("click",function(){let n=e.querySelector(".ch").getAttribute("data-tipo");var a;if("VALOR"!=n&&get("quick-coluna").value.length>1||"VALOR"==n){"A"==ADMIN?a=(a=(a=y)+"@"+e.title).replace("|||","|").replace("||","|"):(document.getElementById(USUARIO.replace(".","_")+"_temp")&&remover(USUARIO.replace(".","_")+"_temp","excluir"),ajax("fly","ex_obj","prm_objeto="+USUARIO.replace(".","_")+"_temp",!1),a=(a=(a=y)+"@"+e.title).replace("|||","|").replace("||","|"));var r="";let o=get("quick-obj"),l=o.children[0].value,i=o.children[1].value;if(l.trim().length>1)"A"!=ADMIN&&(l+="_temp"),call("quick_create","prm_nome="+encodeURIComponent(l)+"&prm_tipo="+n+"&prm_parametros="+a+"&prm_visao="+e.getAttribute("data-visao")+"&prm_coluna="+i+"&prm_grupo="+m+"&prm_obj_ant="+t+"&prm_filtro="+encodeURIComponent(e.getAttribute("data-filtro"))).then(function(e){-1==(r=e).indexOf("duplicado")?("A"==ADMIN&&ajax("fly","inserir_objeto","prm_objeto="+r+"&prm_screen="+tela,!1),appendar("prm_objeto="+r+"&PRM_ZINDEX=2&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_screen="+tela,!1,"")):alerta("feed-fixo","Objeto duplicado!")}).then(function(){-1==r.indexOf("duplicado")&&(get("dados_"+r)?renderChart(r):ajustar(r),centerDrill(r),get("selecteddata").id="",loading())});else alerta("feed-fixo",TR_NM_LE)}else alerta("feed-fixo",TR_CO_SL)})})}function noScroll(){get("jumpdrill")&&get("jumpdrill").remove(),get("jumpmed")&&get("jumpmed").remove()}function cleardrill(){var e=document.querySelectorAll(".drill");for(let t=0;t<e.length;t++)e[t].remove()}function maxCall(){var e=document.getElementById("space").children,t=0;for(let n=0;n<e.length;n++)e[n].clientWidth>t&&(t=e[n].clientWidth+25);if(0!=t)return t+"px";alerta("feed-fixo",TR_OB_NO)}function ctnrs(){var e=document.getElementsByTagName("*"),t=e.length,n=0;for(let a=0;a<t;a++)e[a]&&"ctnr"==e[a].id.substring(0,4)&&(n=e[a].id);return n}function quickPa(e){document.querySelector(".ch")&&document.querySelector(".ch").classList.remove("ch"),e.classList.add("ch");var t=get("quick-obj"),n=e.getAttribute("data-tipo");document.getElementById("quick-coluna").disabled="VALOR"==n&&"true",t.classList.add("open")}function quickerPa(e,t,n,a,r,o){if(loading(),document.getElementById(e+"_temp")&&remover(e+"_temp","excluir"),ajax("fly","ex_obj","prm_objeto="+e+"_temp",!1),document.getElementById("drill_go").value.replace("|","").length>0)var l=document.getElementById("drill_go").value;else l="";setTimeout(function(){ajax("fly","quick_create","prm_nome="+e+"_temp&prm_tipo="+r+"&prm_parametros="+document.getElementById("jumpdrill").className+"@"+l+"&prm_visao="+n+"&prm_coluna="+o+"&prm_grupo="+a+"&prm_obj_ant="+t+"&prm_filtro=",!1),noerror("",TR_CR,"feed-fixo"),appendar("prm_objeto="+e+"_temp&PRM_ZINDEX=&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_screen="+tela,"false"),carrega("ajobjeto?prm_objeto="+e+"_temp"),centerDrill(e+"_temp")},1e3)}function drillChange(e,t,n,a){var r,o=get("drill_go").value,l=[],i=t.getAttribute("data-parametros");i=i.substring(0,i.length-1),l.push(i),l.push(t.title),0==o.slice(-1).indexOf("|")&&(o=o.substring(0,o.length-1)),o=encodeURIComponent(o);var d=e.split("###");document.getElementById("drill_x").value,document.getElementById("drill_y").value;if(get("selecteddata")&&(get("selecteddata").id=""),-1!=e.indexOf("SCR")||-1!=e.indexOf("SRC"))shscr(d[0],tela,o);else{var s=e;remover(s+"trl",!1),loading("x");var c="";if(c=l.filter(e=>e).join("|"),o.trim().length>0){let e=[];e.push(o),e.push(encodeURIComponent(c)),r=[...new Set(e.sort())].filter(e=>e).join("##")}else r=encodeURIComponent(c.replace("||","|"));ajax("append","show_objeto","prm_drill=Y&prm_objeto="+s+"&prm_posx="+cursorx+"px&prm_zindex="+zindex_abs+"&prm_posy="+cursory+"px&prm_parametros="+r+"&prm_screen="+tela+"&prm_track="+n+"|"+s+"&prm_objeton="+a+"  >  ",!0,"main","",s.replace("trl","")+"trl","obj"),setTimeout(function(){remover("script-load")},1e4)}}function centerDrill(e){if("circle select"==document.getElementById("donut").children[1].className){var t,n="";n=setInterval(function(){if(document.getElementById(e)||document.getElementById(e+"trl")){t=document.getElementById(e+"trl")?document.getElementById(e+"trl"):document.getElementById(e);var a=window.innerWidth/2,r=window.innerHeight/2,o=t.clientWidth/2,l=t.clientHeight/2;if(parseInt(l)>parseInt(r)&&(l=parseInt(r)/2),void 0!==window.scrollX)var i=window.scrollX+a-o+"px",d=window.scrollY+r-l+"px";else i=a-o+"px",d=r-l+"px";t.style.setProperty("left",i),parseInt(d)<10&&(d="40px"),t.style.setProperty("top",d),clearInterval(n)}},100)}}function fitScreen(e){document.getElementById(e+"fixed")&&(document.getElementById(e+"fixed").innerHTML="",document.getElementById(e+"fixed").style.setProperty("width","0"),document.getElementById(e+"fixed").style.setProperty("max-height","auto")),toggleClass(e,"front","front expand","r"),setTimeout(function(){fixCol(e),smartScroll(e)},500)}function lmenuLink(e){if(closeSideBar("prefdrop"),clicked=e,clearInterval(auto_refresh),curtain("enabled"),e.getAttribute("data-carrega").length>0){titulo(e,"c"),loader("content");var t="";e.getAttribute("data-package")&&(t=e.getAttribute("data-package")),"_"!=e.getAttribute("data-carrega")?call(e.getAttribute("data-carrega"),e.getAttribute("data-url"),t).then(function(e){document.getElementById("content").innerHTML=e}).then(function(){if(e.getAttribute("data-ace")&&e.getAttribute("data-ace").length>1){var t=e.getAttribute("data-ace");(ace_editor=ace.edit(t)).session.setMode("ace/mode/sql")}}):document.getElementById("content").innerHTML=""}e.getAttribute("data-attrib").length>1&&(document.getElementById("attriblist").classList.toggle("open"),ajax("list",e.getAttribute("data-attrib"),"",!1,"attriblist")),call_save(""),e.getAttribute("data-menu").length>1?(document.getElementById("painel").innerHTML="",call("menu","prm_menu="+e.getAttribute("data-menu")+"&prm_default=","","GET").then(function(e){document.getElementById("painel").innerHTML=e})):carregaPainel(""),e.getAttribute("data-refresh").length>1&&(auto_refresh=setInterval(intervalFunc,5e3)),document.getElementById("prefdrop")&&document.getElementById("prefdrop").classList.remove("hover"),document.getElementById("popupmenu").innerHTML=""}function intervalFunc(){ajax("list",clicked.getAttribute("data-refresh"),"",!0,clicked.getAttribute("data-refresh"))}function mostrak(e){document.getElementById("sandbox").contentWindow.document.getElementById("parsecheck").setAttribute("value",e),"NOVAVIEW"==document.getElementById("view_list").value&&document.getElementById("sandbox").contentWindow.document.getElementById("nome").setAttribute("value",document.getElementById("new_query").value),"NOVAVIEW"==document.getElementById("view_list").value&&document.getElementById("new_query").value.length<1?alerta("",TR_TC):(loading("x"),setTimeout(function(){var e=ace_editor.getValue();if(0==e.trim().length)alerta("",TR_QN),loading("x");else{var t=Math.ceil(e.length/3e4);for(let a=0;a<t;a++){var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","PICADO"),n.setAttribute("value",e.substr(3e4*[a],3e4)),document.getElementById("sandbox").contentWindow.document.forms[0].appendChild(n)}document.getElementById("sandbox").contentWindow.document.zebra.submit(),setTimeout(function(){var e=document.getElementById("sandbox").contentWindow.document.body.innerHTML;-1==e.indexOf("#alert")?"NOVAVIEW"==document.getElementById("view_list").value?(alerta("msg",TR_CR),document.getElementById("new_query").value=""):alerta("msg",TR_AL):alerta("msg",e),loading("x"),sandbox(),edit_view()},1500)}},100))}function sandbox(){var e=document.getElementById("view_list").title;document.getElementById("sandbox").contentWindow.document.body.innerHTML='<form id="zebra" name="zebra" method="post" action="dwu.fcl.passagem_test"><input id="nome" type="hidden" name="nome" value="'+e+'" /><input id="parsecheck" name="parseonly" type="hidden" value="N"/></form>'}function reload(e){e?document.getElementById("fechar_sup").setAttribute("data-reloado",e):document.getElementById("fechar_sup").setAttribute("data-reloads","true")}function execute_sql(e,t){document.getElementById("sqloutput").children[0].innerHTML="",document.getElementById("sqloutput").children[1].innerHTML="",document.getElementById("sqloutput").children[2].innerHTML="",loader("queryresult"),setTimeout(function(){var n,a=ace_editor.getValue();a.trim().length>1&&(n=ace_editor.getSelectedText().length>1?ace_editor.getSelectedText():a,ajax("S"==e?"list":"double","exec_query","11"==t?"p_query="+encodeURIComponent(n)+"&p_parse="+e:"p_query="+encodeURIComponent(n)+"&p_parse="+e+"&p_linhas="+t,!0,"queryresult"))},20)}function arrow(e,t,n){if("click"!=n){var a=e.value.trim();a!=e.getAttribute("data-default").trim()&&(document.getElementById("user-language").value==document.getElementById("sys-language").value&&document.getElementById(t+"_rotulo").setAttribute("title",a.toUpperCase()),ajax("fly","save_column","prm_visao="+document.getElementById("telasup").getAttribute("data-visao")+"&prm_name="+t+"&prm_campo="+n+"&prm_valor="+encodeURIComponent(a),!1),noerror("",TR_AL,"msg"),e.setAttribute("data-default",a),"NM_ROTULO"==n&&(document.getElementById(t+"id").children[1].innerHTML=a.toUpperCase()))}else ajax("list","load_column","prm_visao="+document.getElementById("telasup").getAttribute("data-visao")+"&prm_name="+t,!1,"content")}function userEvent(e,t,n,a){switch(n){case"blur":e.getAttribute("data-default")!=e.innerHTML&&(ajax("fly","alter_user","prm_nome="+t+"&prm_valor="+encodeURIComponent(e.innerHTML.replace(/<[\/a-zA-Z0-9 ="-]+>/g,""))+"&prm_tipo=nome"),noerror("",TR_AL,"msg"),e.setAttribute("data-default",e.innerHTML));break;case"email":e.getAttribute("data-default")!=e.innerHTML&&(ajax("fly","alter_user","prm_nome="+t+"&prm_valor="+e.innerHTML.replace(/<[\/a-zA-Z0-9 ="-]+>/g,"")+"&prm_tipo=email"),noerror("",TR_AL,"msg"),e.setAttribute("data-default",e.innerHTML));break;case"grupo":ajax("fly","alter_user","prm_nome="+t+"&prm_valor="+e.title+"&prm_tipo=grupo"),noerror("",TR_AL,"msg");break;case"status":ajax("fly","alter_user","prm_nome="+t+"&prm_valor="+e.title+"&prm_tipo=status"),noerror("",TR_AL,"msg"),ajax("list","list_users","",!1,"content");break;case"dba":"dot"==e.className?(ajax("fly","alter_user","prm_nome="+t+"&prm_valor=unlock&prm_tipo=dba"),e.className="dot active"):(ajax("fly","alter_user","prm_nome="+t+"&prm_valor=lock&prm_tipo=dba"),e.className="dot"),noerror("",TR_AL,"msg");break;case"upload":ajax("fly","alter_user","prm_nome="+t+"&prm_valor="+e.title+"&prm_tipo=upload"),noerror("",TR_AL,"msg");break;case"excel":ajax("fly","alter_user","prm_nome="+t+"&prm_valor="+e.title+"&prm_tipo=excel_out"),noerror("",TR_AL,"msg");break;case"permissao":get("attriblist").querySelector(".closer").click(),"n/a"!=e.value&&("custom"==e.value?(call("menu","prm_menu=add_custom&prm_default="+t).then(function(e){document.getElementById("painel").innerHTML=e}),call("listaCustomizado","prm_usuario="+t).then(function(e){document.getElementById("content").innerHTML=e})):(document.getElementById("titulo").innerHTML=e.options[e.selectedIndex].innerHTML,document.getElementById("painel").innerHTML="",call("menu_"+e.value+"_access","prm_usuario="+t).then(function(e){document.getElementById("painel").innerHTML=e}),loader("content"),call(e.value+"_access","prm_usuario="+t+"&prm_conteudo=FULL").then(function(e){document.getElementById("content").innerHTML=e})));break;case"permissao-fake":document.getElementById("ajax").innerHTML="",call("screen_access","prm_usuario="+t+"&prm_conteudo=N&prm_grupo="+e.title).then(function(e){document.getElementById("ajax").innerHTML=e});break;case"remove":if(confirm(TR_US_EX)){var r=document.getElementById(t+"linha");r.classList.add("removing"),call("delete_user","usu_nome_d="+t).then(function(e){-1==e.indexOf("ERRO")?-1==e.indexOf("#alert")?(r.remove(),alerta("feed-fixo",TR_EX)):(r.classList.remove("removing"),alerta("feed-fixo",TR_ER)):(r.classList.remove("removing"),alerta("feed-fixo",TR_ER_EX))})}break;case"show":carregaPainel("add_show&prm_default="+t),carrega("show_only?prm_usuario="+t),document.getElementById("titulo").innerHTML=a}}function newLine(e){var t=document.getElementById(e);if("new"!=t.nextElementSibling.className){var n=document.createElement("tr");n.className="new";for(let e=0;e<t.children.length;e++){var a=document.createElement("td");n.appendChild(a)}t.parentNode.insertBefore(n,t.nextElementSibling)}}function objAction(e,t,n,a){"inserir"==a?(loading(),document.getElementById(e)?alerta("msg",TR_OB_DP):(ajax("fly","inserir_objeto","prm_objeto="+e+"&prm_screen="+tela+"&prm_screen_ant="+n),"CALL_LIST"!=document.getElementById("lisobj").value?appendar("prm_objeto="+e+"&PRM_ZINDEX=&prm_posx=150px&prm_posy=150px&prm_screen="+tela):shscr(tela),curtain(),document.getElementById(e+"dv2")?ajustar(e):carrega("ajobjeto?prm_objeto="+e))):confirm(TR_OB_EX)&&(ajax("fly","dl_object","prm_object="+e,!1),noerror(t,TR_EX,"msg"),document.getElementById(e)&&(document.getElementById(e).style.display="none"))}function checkFix(e,t,n,a,r,o,l){if("check"==e){if(1==t.checked)var i="S";else i="N";ajax("fly","linguagem_padrao","prm_update=S&prm_tabela="+n+"&prm_coluna="+a+"&prm_linguagem="+r+"&prm_default="+o+"&prm_fixa="+i,!1)}else t.previousElementSibling.value.trim().length>0?(ajax("fly","update_language","prm_valor="+t.previousElementSibling.value+"&prm_tabela="+n+"&prm_coluna="+a+"&prm_linguagem="+r+"&prm_default="+o+"&prm_tipo="+l,!1),noerror("",TR_AL,"msg"),noerror("",TR_AL,"msg")):alerta("msg",TR_BL)}function auto(e,t,n){var a=e.selectionEnd-1,r=e.selectionEnd-2,o=e.value.split(""),l=document.getElementById("auto-complete-formula");"8"==t.which&&a<e.getAttribute("data-lastkey")&&(l.classList.add("off"),e.setAttribute("data-search","N")),"["==o[a]&&"$"==o[r]&&(l.classList.remove("off"),e.setAttribute("data-search","S"),e.setAttribute("data-lastkey",a+1)),"]"==o[a]&&(l.classList.add("off"),e.setAttribute("data-search","N")),"S"==e.getAttribute("data-search")&&ajax("list","auto_complete","prm_visao="+n+"&prm_letters="+o.slice(e.getAttribute("data-lastkey")).join(""),!0,"auto-complete-formula")}function autoClick(e){e.parentNode.classList.add("off");var t=document.getElementById("formula-coluna"),n=e.innerHTML;t.value=t.value.split("").slice(0,t.getAttribute("data-lastkey")).join("")+n+"]",t.setAttribute("data-search","N"),t.setAttribute("data-lastkey",""),call("save_column","prm_visao="+document.getElementById("micro-visao").title+"&prm_name="+document.getElementById("ajax-lista").querySelector(".selected").title+"&prm_campo=FORMULA&prm_valor="+encodeURIComponent(t.value)).then(function(e){-1==e.indexOf("#alert")?(alerta("feed-fixo",e),t.setAttribute("data-default",t.value)):alerta("feed-fixo",TR_ER),t.focus()})}function swapColumn(e){var t=e.parentNode.getAttribute("data-tipo");if(e.lastElementChild.removeEventListener("click",removeColumn),e.lastElementChild.addEventListener("click",removeColumn),e.id=="selected"+t)-1==e.title.indexOf("TPL")&&-1==e.title.indexOf("TPT")&&-1==e.title.indexOf("TEMPLATE")||fakeOption(e.title,document.getElementById("prm_objeto").value,"template",document.getElementById("prm_visao").value),e.id="";else if(document.getElementById("selected"+t)){var n=document.getElementById("selected"+t).outerHTML,a=e.outerHTML;document.getElementById("selected"+t).outerHTML=a,e.outerHTML=n,document.getElementById("selected"+t).id="",save("consulta")}else e.id="selected"+t}function removeColumn(e,t){if(e.stopPropagation(),t)var n=t.parentNode;else n=this.parentNode;var a=n.nextElementSibling;a.parentNode.removeChild(a),n.parentNode.removeChild(n),save("consulta")}function swapSquare(e){var t=e.parentNode.getAttribute("data-tipo");if(document.getElementById("selected"+t)){var n=document.getElementById("selected"+t),a=n.nextElementSibling;e.previousElementSibling.id!="selected"+t&&e.nextElementSibling.id!="selected"+t&&(a.parentNode.removeChild(a),n.id="",e.outerHTML='<li onclick="swapSquare(this);" class="square"></li>'+n.outerHTML+'<li onclick="swapSquare(this);" class="square"></li>',n.parentNode.removeChild(n)),save("consulta")}}function saveTpt(e,t,n){var a=e.querySelectorAll(".linha"),r="";for(let e=0;e<a.length;e++)a[e].title.length>0&&(r=0==e?a[e].title:r+"|"+a[e].title);r!=e.getAttribute("data-default")&&(ajax("fly","save_column","prm_visao="+t+"&prm_name="+n+"&prm_campo=FORMULA&prm_valor="+r),e.setAttribute("data-default",r))}function fastInclude(e,t){if(document.getElementById(e))alerta("feed-fixo",TR_OB_DP);else{if(document.querySelector(".movingarticle"))var n=document.querySelector(".movingarticle"),a=n.id;if(n?ajax("fly","inserir_objeto","CALL_LIST"!=t&&"FLOAT_PAR"!=t&&"FLOAT_FILTER"!=t&&"BROWSER"!=t?"prm_objeto="+e+"&prm_screen="+a:"prm_objeto="+e+"&prm_screen="+tela):call("inserir_objeto","prm_objeto="+e+"&prm_screen="+tela).then(function(){"FLOAT_PAR"!=t&&"FLOAT_FILTER"==t||(document.getElementById("float-filter").className="visible"),"CALL_LIST"==t&&(document.getElementById("call-menu").className="visible")}),"CALL_LIST"!=t&&"FLOAT_PAR"!=t&&"FLOAT_FILTER"!=t&&"BROWSER"!=t){loading();new Promise(function(t,r){t(n?ajax("append","show_objeto","prm_objeto="+e+"&PRM_ZINDEX=99&prm_posx=300px&prm_posy="+(n.children.length+1)+"px&prm_screen="+tela+"&prm_dashboard=true",!0,a,"",e,"obj"):ajax("append","show_objeto","prm_objeto="+e+"&PRM_ZINDEX=&prm_posx=300px&prm_posy=200px&prm_screen="+tela,!0,"main","",e,"obj"))})}else"CALL_LIST"==t||"BROWSER"==t?shscr(tela):("FLOAT_PAR"!=t&&"FLOAT_FILTER"!=t||(alerta("feed-fixo",TR_AD),document.getElementById("float-icon").classList.contains("invisible")&&(document.getElementById("float-icon").className="visible")),LAYER.classList.contains("ativo")&&loading())}}function getlist(e){if(0==document.getElementById("painel").querySelectorAll(".error").length){var t=document.getElementById("consulta_visao").title,n=encodeURIComponent(document.getElementById("consulta_nome").value.replace(/\./g,"_").replace(/\#/g,"")),a=encodeURIComponent(document.getElementById("consulta_desc").value),r=document.getElementById("consulta_grupo").title,o=document.getElementById("consulta_prm").value;t.trim().length>0?n.trim().length>1?a.trim().length>1?0!=r.trim().length?"false"==error&&(carrega("consulta?prm_obj="+n+"&prm_visao="+t+"&prm_nome="+a+"&prm_grupo="+r+"&prm_agrupamento="+o),call_save("consulta")):alerta("msg",TR_ES_GR):alerta("msg",TR_DS_LE):alerta("msg",TR_NM_LE):alerta("msg",TR_ES_VW)}else alerta("msg",TR_ID)}function filter(e,t,n,a,r){var o=document.getElementById("filtro-coluna-"+n).getAttribute("data-default"),l=document.getElementById("filtro-condicao-"+n).getAttribute("data-default");if("fakeoption"!=document.getElementById("filtro-conteudo-"+n).className)var i=encodeURIComponent(document.getElementById("filtro-conteudo-"+n).getAttribute("data-default")),d=document.getElementById(r),s=encodeURIComponent(d.value);else s=i=encodeURIComponent(document.getElementById("filtro-conteudo-"+n).children[0].title);var c=document.getElementById("filtro-ligacao-"+n).getAttribute("data-default");if(document.getElementById("filtro-agrupado-"+n))var m=document.getElementById("filtro-agrupado-"+n).getAttribute("data-default");else m="N";if("fakeoption"!=document.getElementById("filtro-conteudo-"+n).className&&(d.setAttribute("data-default",d.value),"SELECT"==d.tagName))for(let e=0;e<d.children.length;e++)d.children[e].value==d.value?d.children[e].setAttribute("selected","selected"):d.children[e].removeAttribute("selected");ajax("fly","edit_filtro","prm_objeto="+e+"&prm_visao="+t+"&prm_coluna="+o+"&prm_condicao="+l+"&prm_conteudo="+i+"&prm_valor="+s+"&prm_tipo="+a+"&prm_agrupado="+m+"&prm_ligacao="+c,!0),noerror("",TR_AL,"msg"),reload(e)}function list_obj(){var e=document.getElementById("obj_serch_tp").value,t=document.getElementById("obj_serch_vw").value,n=document.getElementById("obj_serch_gp").value,a=document.getElementById("obj_serch_in").value;a.length<1&&(a="N/A"),document.getElementById("ajax_obj").innerHTML="",loader("ajax_obj"),ajax("list","list_obj","prm_tipo="+e+"&prm_view="+t+"&prm_grupo="+n+"&prm_desc="+a,!0,"ajax_obj")}function order(e,t){var n=document.getElementById(t).getAttribute("data-dir");return"notsame"==e?(document.getElementById(t).innerHTML="",loader(t),"1"==n?document.getElementById(t).setAttribute("data-dir","2"):document.getElementById(t).setAttribute("data-dir","1")):(document.getElementById("content").innerHTML="",loader("content")),n}function checkError(){if(0!=document.getElementById("painel").querySelectorAll(".error").length)throw alerta("feed-fixo",TR_II),new Error(TR_II)}function dashSpace(e){document.getElementById("id_DASH_MARGIN"+e).value=document.getElementById("DASH_MARGIN"+e+"_input1").value.replace("px","")+"px "+document.getElementById("DASH_MARGIN"+e+"_input2").value.replace("px","")+"px "+document.getElementById("DASH_MARGIN"+e+"_input3").value.replace("px","")+"px "+document.getElementById("DASH_MARGIN"+e+"_input4").value.replace("px","")+"px"}function checkPar(e,t){var n=document.getElementById(e).value;n.match(/\$\[[a-zA-Z0-9_]*\]/g)&&ajax("input","checkpar","prm_variavel="+n.match(/\$\[[a-zA-Z0-9_]*\]/g).join("|")+"&prm_visao="+t,!0,e)}var perline=18,divSet=!1,tmpf,curId,curTp,curMd,colorLevels=Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"),colorArray=Array(),ie=!1,nocolor="none";function getObj(e){return ie?document.all[e]:document.getElementById(e)}function addColor(e,t,n){addColorValue(colorLevels[e],colorLevels[t],colorLevels[n])}function addColorValue(e,t,n){colorArray[colorArray.length]="#"+e+e+t+t+n+n}function setColor(color){var link=getObj(curId),field=getObj(curId+"field"),picker=getObj("colorpicker"),modelo=getObj(curMd);field.value=color,"nomode"==curMd?field.value=color:"color"==curTp?parent.document.getElementById(curMd)&&(parent.document.getElementById(curMd).style.color=color):parent.document.getElementById(curMd)&&(parent.document.getElementById(curMd).style.backgroundColor=color),""==color?(link.style.background=nocolor,link.style.color=nocolor,color=nocolor,tmpf.value="#000000"):(link.style.background=color,link.style.color=color,tmpf.value=color),picker.style.display="none",eval(getObj(curId+"field").title),"cor_fundo"==curId&&(PRINCP.style.backgroundColor=color);var total="";if(-1!=curId.indexOf("field")){var valores=document.getElementById("fakelist").getElementsByTagName("input");for(let e=0;e<valores.length;e++)"#065182"!=valores[e].value&&(total=total+valores[e].parentNode.title+valores[e].value+"|");ajax("fly","alter_attrib","prm_objeto="+document.getElementById(curId).getAttribute("data-visao")+"&prm_prop=SUBQUERY-COR&prm_value="+total,!1)}if(link.previousElementSibling){var inputblink=link.previousElementSibling;inputblink.id&&-1!=inputblink.id.indexOf("destaque-")&&destaque(inputblink.getAttribute("data-counter"),inputblink.getAttribute("data-tipo"),inputblink.id)}}function setDiv(){if(document.createElement){var e=document.createElement("div");"string"==typeof e.innerHTML&&(genColors(),e.id="colorpicker",e.style.display="none",e.innerHTML='<span style="font-family:Verdana; font-size:11px;"> '+getColorTable()+"</span>","open"==document.getElementById("attriblist").className?(document.getElementById("fakelist").appendChild(e),document.getElementById("fakelist").className="visible",document.getElementById("fakelist").style.setProperty("left","300px")):document.body.appendChild(e),divSet=!0)}}function pickColor(e,t,n,a,r){divSet||setDiv();var o=getObj("colorpicker");if(e!=curId||"block"!=o.style.display){tmpf=getObj(a),curId=e,curTp=n,curMd=t;getObj(e);o.style.top=cursory+"px",o.style.left=cursorx+"px",o.style.setProperty("opacity","0"),o.style.setProperty("transition","all 0.1s linear"),o.style.setProperty("-webkit-transition","all 0.2s linear"),setTimeout(function(){o.style.setProperty("opacity","1")},100),o.setAttribute("class","font"),o.style.display="block"}else o.style.display="none"}function genColors(){addColorValue("0","0","0"),addColorValue("3","3","3"),addColorValue("6","6","6"),addColorValue("9","9","9"),addColorValue("C","C","C"),addColorValue("F","F","F");for(let e=1;e<colorLevels.length;e++)addColor(0,0,e);for(let e=1;e<colorLevels.length-1;e++)addColor(e,e,5);for(let e=1;e<colorLevels.length;e++)addColor(0,e,0);for(let e=1;e<colorLevels.length-1;e++)addColor(e,5,e);for(let e=1;e<colorLevels.length;e++)addColor(e,0,0);for(let e=1;e<colorLevels.length-1;e++)addColor(5,e,e);for(let e=1;e<colorLevels.length;e++)addColor(e,e,0);for(let e=1;e<colorLevels.length-1;e++)addColor(5,5,e);for(let e=1;e<colorLevels.length;e++)addColor(0,e,e);for(let e=1;e<colorLevels.length-1;e++)addColor(e,5,5);for(let e=1;e<colorLevels.length;e++)addColor(e,0,e);for(let e=1;e<colorLevels.length-1;e++)addColor(5,e,5);return colorArray}function getColorTable(){colorArray[colorArray.length]="#8DB6CD",colorArray[colorArray.length]="#B0E2FF",colorArray[colorArray.length]="#6495ED";var e=colorArray,t="";t+='<table border="0" cellspacing="1" cellpadding="1">';for(let n=0;n<e.length;n++)n%perline==0&&(t+="<tr>"),t+='<td bgcolor="#000000"><a style="outline: 1px solid #000000; color: '+e[n]+"; background: "+e[n]+';font-size: 10px;" title="'+e[n]+'" href="javascript:setColor(\''+e[n]+"');\">&nbsp;&nbsp;&nbsp;</a></td>",n%perline==perline-1&&(t+="</tr>");return t+='<td bgcolor="#000"><a href="javascript:setColor(\'transparent\');" title="" style="padding: 0 2px; text-decoration: none; font-weight: bold; outline: 1px solid #000000; color: #CC0000; background: #FFF; font-size: 10px;">X</a></td>',i%perline!=0&&(t+="</tr>"),t+="</table>"}function relateColor(id,color){var link=getObj(id);""==color?(link.style.background=nocolor,link.style.color=nocolor,color=nocolor):(link.style.background=color,link.style.color=color),eval(getObj(id+"field").title)}function getAbsoluteOffsetTop(e){for(var t=e.offsetTop,n=e.offsetParent;n!=document.body;)t+=n.offsetTop,n=n.offsetParent;return t}function getAbsoluteOffsetLeft(e){for(var t=e.offsetLeft,n=e.offsetParent;n!=document.body;)t+=n.offsetLeft,n=n.offsetParent;return t}document.all&&(ie=!0,nocolor="");var checkscreen="",loopscreen="";function fullscreen(){var e=document.querySelector(".full").id;clearInterval(checkscreen),clearInterval(loopscreen);var t=document.getElementById("dados_"+e).getAttribute("data-full");if(parseInt(t)>0&&document.getElementById(e+"c")){var n=document.getElementById(e+"m").getElementsByTagName("tbody")[0],a=n.scrollHeight,r=0,o=document.getElementById(e+"m").clientHeight,l=document.getElementById(e+"m").clientHeight/12;if(!document.getElementById(e+"-estilo-full")){var i="";i="div#"+e+" tbody tr { "+(i=" height: "+l+"px;")+" }";var d=document.getElementById("active-show").getAttribute("data-time");i="div#"+e+" div#"+e+"m tbody { transition: transform "+d+"s linear; } "+i;var s=document.createElement("style");s.id=e+"-estilo-full",s.innerHTML=i,document.head.appendChild(s)}n.style.setProperty("transform","translateY(-"+(a-(document.getElementById(e+"dv2").clientHeight-2*l))+"px)");var c=(a-(document.getElementById(e+"dv2").clientHeight-2*l))/parseInt(d);o<a?checkscreen=setInterval(function(){"ativo"!=document.getElementById("layer").className&&document.getElementById(e+"m")&&(clearInterval(checkscreen),loopscreen=setInterval(function(){if(r+o<a+40)r+=parseInt(c);else{clearInterval(loopscreen);var e=document.getElementById("active-show").nextElementSibling;"show_only"==e.className?setTimeout(function(){document.getElementById("active-show").id="",e.id="active-show",removeTrash(),shscr(e.value)},5e3):setTimeout(function(){document.getElementById("active-show").id="",document.querySelector(".show_only").id="active-show",removeTrash(),shscr(document.querySelector(".show_only").value)},5e3)}},1e3))},10):setTimeout(function(){clearInterval(loopscreen);var e=document.getElementById("active-show").nextElementSibling;"show_only"==e.className?setTimeout(function(){document.getElementById("active-show").id="",e.id="active-show",removeTrash(),shscr(e.value)},1e3):setTimeout(function(){document.getElementById("active-show").id="",document.querySelector(".show_only").id="active-show",removeTrash(),shscr(document.querySelector(".show_only").value)},1e3)},4e3)}}function sucesso(e){ajax("fly","gps","prm_posicao="+(e.coords.latitude+" "+e.coords.longitude)+"|"+mobilecheck())}function erro(){return!1}function mobilecheck(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t?"mobile":"desktop"}navigator.geolocation&&navigator.geolocation.getCurrentPosition(sucesso,erro);var dbltouch=0,dbltouchX=0,dbltouchY=0,map;function dblTouch(e){var t=document.getElementById(e+"_ds");"1"==t.getAttribute("data-touch")?(t.setAttribute("data-touch","0"),touch&&clearTimeout(touch),curtain(""),scale(e)):(t.setAttribute("data-touch","1"),touch=setTimeout(function(){t.setAttribute("data-touch","0")},1e3))}function swipeStart(e,t){-1!=document.getElementById(e).className.indexOf("scaled")&&(document.getElementById(e).setAttribute("data-swipe",t.touches[0].pageX),t.stopPropagation())}function swipe(e,t){var n=document.getElementById(e);-1!=n.className.indexOf("scaled")&&(parseInt(n.getAttribute("data-swipe"))>t.touches[0].pageX+50?cycle(e,"next"):parseInt(n.getAttribute("data-swipe"))<t.touches[0].pageX-50&&cycle(e,"prev"),t.stopPropagation())}function smoothScroll2(e,t){var n=document.getElementById(e),a=document.getElementById(t).offsetTop-n.offsetTop-188,r=0,o=setInterval(function(){r>a&&clearInterval(o),r+=47,n.scrollTo(0,r)},5)}function smoothScroll(e){e=e||window.innerHeight;var t=window.scrollY,n=setInterval(function(){t>e&&clearInterval(n),t+=20,window.scrollTo(0,t)},10)}function donutEvent(){var e=document.getElementById("donut");e.addEventListener("mouseleave",function(){this.classList.remove("open")}),e.addEventListener("click",function(e){"mobile"!=PRINCP.className&&-1==e.target.innerHTML.indexOf("CENTRO")&&this.classList.remove("open")})}function over_evento(e){this.id;var t=e.target;if("TABLE"!=t.tagName&&"TBODY"!=t.tagName&&"TR"!=t.tagName&&"SVG"!=t.tagName&&"TH"!=t.tagName&&t.classList&&t.classList.contains("imgurl")){document.getElementById("img_content")&&(document.getElementById("img_content").classList.contains("scaled")||document.getElementById("img_content").remove());var n=document.createElement("div");n.id="img_content";var a=document.createElement("img");a.src=t.getAttribute("data-url");var r=document.createElement("img");r.src="dwu.fcl.download?arquivo=img_error.jpg",r.className="img_error";var o=t.getBoundingClientRect().left+36,l=t.getBoundingClientRect().top;a.addEventListener("error",function(){a.style.setProperty("display","none"),n.appendChild(r)}),n.appendChild(a),n.style.setProperty("left",o+"px"),n.style.setProperty("top",l+"px"),document.getElementById("main").appendChild(n)}}function out_evento(e){document.getElementById("img_content")&&(document.getElementById("img_content").classList.contains("scaled")||document.getElementById("img_content").remove())}function click_evento2(e){var t=this.id,n=e.target,a=document.getElementById(t).parentNode.parentNode.parentNode.className;if("TABLE"!=n.tagName&&"TBODY"!=n.tagName&&n.getAttribute("colspan")<2&&!n.parentNode.classList.contains("lc")){if(t=t.substring(0,t.length-1),-1!=n.className.indexOf("seta"))var r=0;else r=parseInt(n.cellIndex);if(n.classList.contains("callmed")){var o=get("dados_"+t).getAttribute("data-visao");medDrill(n,t,o)}else if("TH"==n.tagName&&-1==a.indexOf("cross")){var l,i=n.cellIndex,d=0;l=n.parentNode.parentNode.querySelectorAll("th");var s=n.parentNode.querySelectorAll(".fix").length;n.parentNode.querySelector(".fix")||(d=n.parentNode.parentNode.querySelectorAll(".fix").length);var c=n;if(!n.className&&n.parentNode.parentNode.children.length>1&&(c=n.parentNode.parentNode.lastElementChild.children[i-s]),n.parentNode.parentNode.children.length<5){var m;m=-1==c.className.indexOf("DESC")&&-1==c.className.indexOf("ASC")?i+d+" ASC":-1!=c.className.indexOf("ASC")?i+d+" DESC":(c.previousElementSibling,""),c.className=m;var u=[];for(let e=1;e<l.length;e++)l[e]&&(u[e-1]=l[e].className.replace(" fix","").replace(" inv","").replace("cen","").replace("dir","").replace("bld","").trim());var p=encodeURIComponent(document.getElementById("par_"+t).value),g=document.getElementById(t).parentNode.id;remover("sdrill_"+t),remover("sdrill_"+t+"trl"),remover(t),remover(t+"trl");var f=document.getElementById(t).offsetTop+"px",v=document.getElementById(t).offsetLeft+"px",y="N";document.getElementById(t).classList.contains("drill")&&(y="Y"),call("alterorder","prm_objeto="+t.replace("trl","")+"&prm_valor="+u.filter(e=>e).join(",")).then(function(){document.getElementById(t.replace("trl","")+"sync")||document.getElementById(t)&&(document.getElementById(t).remove(),loading())}).then(function(){document.getElementById(t+"sync")?document.getElementById(t+"sync").click():appendar("prm_drill="+y+"&prm_objeto="+t.replace("trl","")+"&prm_posx="+v+"&prm_zindex=5&prm_posy="+f+"&prm_parametros="+p+"&prm_screen="+tela,!1,g)}).then(function(){centerDrill(t+"trl")})}else{o=get("dados_"+t).getAttribute("data-visao");medDrill(n,t,o),n.classList.toggle("tdselected")}}if(0!=r){if(n.classList.contains("imgurl")){document.getElementById("img_content")&&document.getElementById("img_content").remove();var h=document.createElement("div");h.id="img_content",h.className="scaled";var _=document.createElement("img");_.addEventListener("click",removeImage),document.getElementById("layer2").addEventListener("click",removeImage),_.style.setProperty("opacity","0"),_.src=n.getAttribute("data-url"),_.addEventListener("error",function(){_.style.setProperty("display","none")}),h.appendChild(_),document.getElementById("main").appendChild(h),setTimeout(function(){h.style.setProperty("left","calc(50% - "+_.clientWidth/2+"px)"),h.style.setProperty("top","60px"),h.style.setProperty("z-index","900")},10),setTimeout(function(){_.style.setProperty("opacity","1"),curtain("only")},50)}else if("TH"!=n.tagName){document.getElementById("selecteddata")&&(document.getElementById("selecteddata").id=""),n.id="selecteddata",document.getElementById("selectedline")&&(document.getElementById("selectedline").id=""),n.parentNode.id="selectedline",document.getElementById("drill_obj").value=t.replace("trl","");var b=n.parentNode.firstElementChild.getAttribute("data-valor"),E=n.parentNode.parentNode.firstElementChild.children[n.cellIndex],I=0;n.parentNode.parentNode.parentNode.firstElementChild.children.length>1&&(I=n.parentNode.parentNode.parentNode.firstElementChild.firstElementChild.querySelectorAll(".fix").length);var x=n.parentNode.parentNode.parentNode.firstElementChild.lastElementChild.children[n.cellIndex-I];if(E){let a,r,o;n.classList.contains("fix")||(o=get(t+"c").children[0].lastElementChild.children[n.cellIndex-I].getAttribute("data-pivot")),"string"==typeof E.getAttribute("data-p")?(a=x.getAttribute("data-valor"),r=b):n.parentNode.firstElementChild.getAttribute("data-valor")&&(x?x.getAttribute("data-valor")?(a=x.getAttribute("data-valor"),r=b):r=b:r="-1"!=document.getElementById(t).className.indexOf("cross")?b+"|"+E.innerHTML.trim():b),check_tag(e,t,a,r,o,n)}}}else-1!=n.className.indexOf("seta")&&changearrow(n)}}function removeImage(){document.getElementById("img_content").remove(),curtain(""),document.getElementById("layer2").removeEventListener("click",removeImage)}function dbl_click_evento(e){var t=this.id;t=t.substring(0,t.length-1);var n=e.target;if(-1!=n.className.indexOf("flag")){var a=document.getElementById("text-talk");a.classList.remove("open"),a.classList.add("open"),ajax("list","text_post","prm_objeto="+t.replace("trl","")+"&prm_line="+n.getAttribute("data-valor"),!1,"campo")}}function changearrow(e){var t=e.parentNode.parentNode.parentNode.id;t=-1!=t.indexOf("trlc")?t.replace("trlc","trl"):t.slice(0,-1);var n=e,a=n;if(null!=a.parentNode.nextElementSibling){if(a.parentNode.nextElementSibling)var r=a.parentNode.nextElementSibling.tagName;else r="LAST";if("STYLE"==r){var o=a.parentNode.className.replace(/[a-zA-Z ]/g,"");o=0==o.length?0:parseInt(o);try{for(;-1!=a.parentNode.nextElementSibling.className.indexOf("nivel")&&parseInt(a.parentNode.nextElementSibling.className.replace(/[a-zA-Z ]/g,""))>o||"STYLE"==a.parentNode.nextElementSibling.tagName;){var l=a.parentNode.nextElementSibling;if(l.className)l.className;l.remove()}}catch(e){console.log("ultima linha")}document.getElementById("selectedline")&&(document.getElementById("selectedline").id=""),topDistance(t),setTimeout(function(){fixCol(t)},200)}else if(-1==a.className.indexOf("down")&&-1==a.className.indexOf("checked")){if(a.getAttribute("data-subquery").length>0){document.getElementById(t+"dv2").scrollLeft=0;var i=[];document.getElementById("par_"+t).value.length>0&&i.push(encodeURIComponent(document.getElementById("par_"+t).value)),i.push(encodeURIComponent(a.getAttribute("data-valor")));var d="";a.getAttribute("data-self")&&(d=a.getAttribute("data-self")),loading(),document.getElementById("selectedline")&&(document.getElementById("selectedline").id=""),a.parentNode.id="selectedline",setTimeout(function(){ajax("inject","show_objeto","prm_objeto="+t.replace("trl","")+"&prm_posx=&prm_posy=&prm_parametros="+i.join("|")+"&prm_drill="+a.getAttribute("data-subquery")+"&prm_out=&prm_zindex=&prm_screen="+tela+"&prm_forcet="+a.nextElementSibling.innerHTML.trim()+"&prm_track=INSIDE&prm_objeton="+a.getAttribute("data-ordem")+"&prm_alt_med=&prm_cross=&prm_self="+d,!1,"selectedline",t,t,"obj");var e=document.getElementById(t+"c");if(-1==a.parentNode.className.indexOf("nivel"))e.removeEventListener("click",click_evento),e.addEventListener("click",click_evento),e.removeEventListener("dblclick",dbl_click_evento),e.addEventListener("dblclick",dbl_click_evento);else{parseInt(a.parentNode.className.replace("es nivel","").replace("cl nivel",""));e.removeEventListener("click",click_evento),e.addEventListener("click",click_evento),e.removeEventListener("dblclick",dbl_click_evento),e.addEventListener("dblclick",dbl_click_evento)}topDistance(t),setTimeout(function(){fixCol(t)},200)},100)}}else n.classList.toggle("checked")}else if(-1==a.className.indexOf("down")&&-1==a.className.indexOf("checked")){if(a.getAttribute("data-subquery").length>0){document.getElementById(t+"dv2").scrollLeft=0,loading(),document.getElementById("selectedline")&&(document.getElementById("selectedline").id=""),a.parentNode.id="selectedline";i=[];document.getElementById("par_"+t).value.length>0&&i.push(encodeURIComponent(document.getElementById("par_"+t).value)),i.push(encodeURIComponent(a.getAttribute("data-valor"))),setTimeout(function(){ajax("inject","show_objeto","prm_objeto="+t.replace("trl","")+"&prm_posx=&prm_posy=&prm_parametros="+i.join("|")+"&prm_drill="+a.getAttribute("data-subquery")+"&prm_out=&prm_zindex=&prm_screen="+tela+"&prm_forcet="+a.nextElementSibling.innerHTML.trim()+"&prm_track=INSIDE&prm_objeton="+a.getAttribute("data-ordem")+"&prm_alt_med=&prm_cross=&prm_self="+d,!1,"selectedline",t,t,"obj");var e=document.getElementById(t+"c");if(-1==a.parentNode.className.indexOf("nivel"))e.removeEventListener("click",click_evento),e.addEventListener("click",click_evento),e.removeEventListener("dblclick",dbl_click_evento),e.addEventListener("dblclick",dbl_click_evento);else{parseInt(a.parentNode.className.replace("es nivel","").replace("cl nivel",""));e.removeEventListener("click",click_evento),e.addEventListener("click",click_evento),e.removeEventListener("dblclick",dbl_click_evento),e.addEventListener("dblclick",dbl_click_evento)}topDistance(t),setTimeout(function(){fixCol(t)},200)},100)}}else document.getElementById(t).getElementsByClassName("checked").length<17?n.classList.toggle("checked"):e.className="setadown"}var geoarray=new Array;function initMap(e,t){mapa=new google.maps.Map(document.getElementById(e),{center:{lat:10,lng:0},zoom:3,minZoom:3,maxZoom:3,zoomControl:!1,scaleControl:!1,mapTypeControl:!1,streetViewControl:!1,disableDefaultUI:!0});var n=new google.maps.StyledMapType([{featureType:"administrative",elementType:"geometry.fill",stylers:[{visibility:"off"}]}]);mapa.mapTypes.set("myCustomMap",n),mapa.setMapTypeId("myCustomMap"),callMarkers(e)}function callMarkers(e){var t;(t=new XMLHttpRequest).onreadystatechange=function(){if(4==t.readyState){geoarray=t.responseText.split("/");for(let t=0;t<geoarray.length;t++){var e="";e.metadata={type:"point",id:"marker"+t},e=new google.maps.Marker({position:{lat:parseFloat(geoarray[t].split("|")[1]),lng:parseFloat(geoarray[t].split("|")[2])},map:mapa,label:"",title:geoarray[t].split("|")[0].trim()})}setTimeout(function(){callHints()},500)}},t.open("POST","dwu.fcl.mapmarker",!1),t.send("prm_objeto="+e)}function callHints(){var e=document.getElementsByClassName("gmnoprint");for(let n=0;n<e.length;n++)if(e[n].children[1]){e[n].children[1].children[0]&&(e[n].setAttribute("data-text",e[n].children[1].children[0].title.replace(/<BR>/g,", \n ")),e[n].style.setProperty("opacity","1"));var t=document.createElement("span");t.className="texto",t.innerHTML=e[n].children[1].children[0].title,e[n].appendChild(t)}}function lock(e,t){if("lockin"==t){if("locked"==e.className)throw"stop execution";e.setAttribute("class","locked")}else e.setAttribute("class","")}function call_save(e){document.getElementById("salvar").setAttribute("onclick",""),e.length>1?(document.getElementById("salvar").setAttribute("class",""),document.getElementById("salvar").setAttribute("onclick",'save("'+e+'")')):document.getElementById("salvar").setAttribute("class","disabled")}function save(e){switch(e){case"pontoav":document.getElementById("savepa").submit();break;case"browseredit":var t=(d=document.getElementById("browseredit").children).length,n="",a="",r="",o="",l=[],i=[];for(let e=0;e<t;e++)if("0"==d[e].getAttribute("data-chave")){if(d[e].getAttribute("data-obrigatorio")&&!(d[e].getAttribute("data-obrigatorio")&&d[e].getAttribute("data-v").length>0))return document.getElementById("data_list_menu").classList.add("shake"),d[e].classList.add("error"),alerta("feed-fixo",TR_AO),void setTimeout(function(){document.getElementById("data_list_menu").classList.remove("shake")},300);if("data"==d[e].getAttribute("data-tipo")&&d[e].getAttribute("data-v").length<10&&0!=d[e].getAttribute("data-v").length||"datatime"==d[e].getAttribute("data-tipo")&&d[e].getAttribute("data-v").length<16&&0!=d[e].getAttribute("data-v").length)return document.getElementById("data_list_menu").classList.add("shake"),d[e].classList.add("error"),alerta("feed-fixo",TR_TD_IN,TR_FL_DC),void setTimeout(function(){document.getElementById("data_list_menu").classList.remove("shake")},300);a=a+"&prm_conteudo="+encodeURIComponent(d[e].getAttribute("data-v").trim()),n=n+"&prm_nome="+d[e].getAttribute("data-c"),r=r+"&prm_ant="+encodeURIComponent(d[e].getAttribute("data-d")),o=o+"&prm_tipo="+d[e].getAttribute("data-tipo")}else"data"==d[e].getAttribute("data-tipo")?l.push("to_char("+d[e].getAttribute("data-c")+", 'DD/MM/YYYY')"):l.push(d[e].getAttribute("data-c")),i.push(d[e].getAttribute("data-v"));curtain(),loading();document.getElementById("browser-tabela").value,d[0].getAttribute("data-c"),d[0].getAttribute("data-v");ajax("fly","browserEditLine","prm_tabela="+document.getElementById("data_list").getAttribute("data-tabela")+"&prm_chave="+encodeURIComponent(i.join("|"))+"&prm_campo="+encodeURIComponent(l.join("|"))+n+a+r+o+"&prm_obj="+document.getElementById("data_list").className,!1,"","","","bro"),"false"==error?(document.getElementById("data_list_menu").classList.remove("open"),alerta("feed-fixo",TR_AL),browserSearch("save")):(document.getElementById("data_list_menu").classList.remove("open"),loading());break;case"browseradd":t=(d=document.getElementById("browseredit").children).length,n="",o="",document.getElementById("browser-campos").value.split("|"),i=[];var d,s=!1;a="",l=[];for(let e=0;e<t;e++){if("sequence"==d[e].getAttribute("data-tipo")&&(s=!0),"1"==d[e].getAttribute("data-chave")){if(0==d[e].getAttribute("data-v").trim().length)return document.getElementById("data_list_menu").classList.add("shake"),d[e].classList.add("error"),alerta("feed-fixo",TR_AO),void setTimeout(function(){document.getElementById("data_list_menu").classList.remove("shake")},300);i.push(d[e].getAttribute("data-v")),"data"==d[e].getAttribute("data-tipo")?l.push(encodeURIComponent("to_char("+d[e].getAttribute("data-c")+", 'DD/MM/YYYY')")):l.push(d[e].getAttribute("data-c"))}if(d[e].getAttribute("data-obrigatorio")&&!(d[e].getAttribute("data-obrigatorio")&&d[e].getAttribute("data-v").length>0))return document.getElementById("data_list_menu").classList.add("shake"),d[e].classList.add("error"),alerta("feed-fixo",TR_AO),void setTimeout(function(){document.getElementById("data_list_menu").classList.remove("shake")},300);n=n+"&prm_nome="+encodeURIComponent(d[e].getAttribute("data-c")),o=o+"&prm_tipo="+d[e].getAttribute("data-tipo"),a=a+"&prm_conteudo="+encodeURIComponent(d[e].getAttribute("data-v"))}loading();document.getElementById("browser-tabela").value;call("browserNewLine","prm_tabela="+document.getElementById("data_list").getAttribute("data-tabela")+"&prm_chave="+document.getElementById("browser-chave-valores").value+"&prm_coluna="+l.join("|")+n+a+o+"&prm_ident="+encodeURIComponent(i.join("|"))+"&prm_sequence="+s+"&prm_obj="+document.getElementById("data_list").className,"bro").then(function(e){-1==e.indexOf("#alert")?(alerta("feed-fixo",TR_AD),browserSearch("BUSCA"),browserMenu(document.getElementById("data_list_menu"),""),curtain()):(loading(),curtain(),alerta("feed-fixo",e.replace("#alert ")))});break;case"coluna":document.getElementById("saveap").submit();break;case"saveprop":var c=document.getElementById("attriblist").getElementsByTagName("LI"),m="",u="",p=[],g=document.getElementById("obj").value,f=0;for(let e=0;e<c.length;e++)if(c[e].parentNode.classList.contains("form")&&c[e].children[1].children[0]&&"A"!=c[e].children[1].children[0].tagName&&!c[e].children[1].querySelector(".script")&&!c[e].children[2]){if(c[e].children[2]){if(-1!=c[e].children[2].className.indexOf("inc")){u=c[e].children[1].children;for(let e=0;e<u.length;e++)-1==u[e].value.indexOf("ffffff")&&-1==u[e].value.indexOf("FFFFFF")&&-1==u[e].value.indexOf("000000")&&p.push(u[e].value);m=encodeURIComponent(p.join("|"))}}else m=c[e].children[1].children[0].classList.contains("checkbox")?c[e].children[1].children[0].title:"ESPACAMENTO"==c[e].getAttribute("data-prop")||"DASH_MARGIN"==c[e].getAttribute("data-prop")?encodeURIComponent(c[e].children[1].children[0].value+"|"+c[e].children[1].children[1].value+"|"+c[e].children[1].children[2].value+"|"+c[e].children[1].children[3].value):"color"==c[e].children[1].children[0].getAttribute("type")?encodeURIComponent(c[e].children[1].children[1].value):encodeURIComponent(c[e].children[1].children[0].value);"on"==m&&(m=0==(m=c[e].children[1].children[0].checked)?"N":"S"),"off"==m&&(m="S"),m!=encodeURIComponent(c[e].getAttribute("data-default"))&&(f+=1,ajax("fly","save_prop","prm_prop="+c[e].getAttribute("data-prop")+"&prm_valor="+m+"&prm_objeto="+draft+g+"&prm_url_default=&prm_screen="+tela,"true"),c[e].setAttribute("data-default",m))}f>0&&alerta("feed-fixo",TR_AL);break;case"saveprop_chart":var v=document.getElementsByClassName("array_transf"),y=document.getElementsByClassName("array_nomes");e="";for(let t=0;t<v.length;t++)e=e+"x="+v[t].value+"&";var h="";for(let e=0;e<y.length;e++)h=h+"y="+y[e].value+"&";ajax("fly","save_prop",(h=h.slice(0,-1))+"&"+(e=e.slice(0,-1))+"&prm_objeto="+(g=document.getElementById("obj").getAttribute("value"))+"&prm_url_default=&prm_screen="+tela,"true"),curtain(),shscr(tela),alerta("feed-fixo",TR_AL);break;case"savepa":if(!document.getElementById("fakelist").classList.contains("visible")){h=new Array;var _=0,b=document.getElementById("savepa").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&("on"==b[e].value&&!1===b[e].checked&&(b[e].value="off"),"off"==b[e].value&&"true"==b[e].checked&&(b[e].value="off"),h[_]=b[e],_++);for(let e=0;e<h.length;e++)if(0==e)var E=h[e].getAttribute("class")+"="+h[e].value;else E="p_nm_ponto"==h[e].className?E+"&"+h[e].getAttribute("class")+"="+encodeURIComponent(h[e].value):E+"&"+h[e].getAttribute("class")+"="+h[e].value;document.getElementsByClassName("p_cd_ponto")[0].value.length>1?document.getElementsByClassName("p_nm_ponto")[0].value.length>0?(ajax("fly","savepa",E+"&fakeoption="+document.getElementById("fake_grupo").title,!1),"false"==error&&(g=document.getElementsByClassName("p_cd_ponto")[0].getAttribute("value"),"Ponto de avaliação"==document.getElementById("titulo").innerHTML?alerta("feed-fixo",TR_CR):alerta("feed-fixo",TR_AL))):alerta("msg",TR_DS_IN):alerta("msg",TR_NM_LE)}break;case"saveap":h=new Array;var I=0;b=document.getElementById("saveap").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&("on"==b[e].value&&!1===b[e].checked&&(b[e].value="off"),"off"==b[e].value&&"true"==b[e].checked&&(b[e].value="off"),h[I]=b[e],I++);for(let e=0;e<h.length;e++)E=0==e?h[e].getAttribute("class")+"="+h[e].value:"p_nm_objeto"==h[e].className||"p_atributos"==h[e].className||"p_sub_objeto"==h[e].className?E+"&"+h[e].getAttribute("class")+"="+encodeURIComponent(h[e].value):E+"&"+h[e].getAttribute("class")+"="+h[e].value;g=document.getElementsByClassName("p_cd_objeto")[0].value,n=document.getElementsByClassName("p_nm_objeto")[0].value;document.getElementById(g)&&(obj=document.getElementById(g),topo=obj.offsetTop,left=obj.offsetLeft),g.trim().length>1&&n.trim().length>1?(document.getElementById("fake_atributo")?ajax("fly","savegd",E+"&p_atributos="+document.getElementById("fake_atributo").title+"&fakeoption="+document.getElementById("fake_grupo").title,"true"):ajax("fly","savegd",E+"&fakeoption="+document.getElementById("fake_grupo").title,"true"),alerta("feed-fixo",TR_AL)):alerta("msg",TR_NM_LE);break;case"savecd":h=new Array,_=0,b=document.getElementById("savemvi").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&(h[_]=b[e],_++);for(let e=0;e<h.length;e++)E=0==e?h[e].getAttribute("class")+"="+h[e].value:E+"&"+h[e].getAttribute("class")+"="+h[e].value;h[1].value.trim().length<4?alerta("msg",TR_NM_LE):(ajax("fly","savecd",E),alerta("msg",TR_AD));break;case"savecall":document.getElementById("fechar_sup").setAttribute("data-reloado","false");h=new Array,I=0,b=document.getElementById("saveap").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&("on"==b[e].value&&!1===b[e].checked&&(b[e].value="off"),"off"==b[e].value&&"true"==b[e].checked&&(b[e].value="off"),h[I]=b[e],I++);for(let e=0;e<h.length;e++)E=0==e?h[e].getAttribute("class")+"="+h[e].value:"p_nm_objeto"==h[e].className?E+"&"+h[e].getAttribute("class")+"="+encodeURIComponent(h[e].value):E+"&"+h[e].getAttribute("class")+"="+h[e].value;g=document.getElementsByClassName("p_cd_objeto")[0].value,n=document.getElementsByClassName("p_nm_objeto")[0].value,g.trim().length>1&&n.trim().length>1?document.getElementById("fake_grupo")&&(ajax("fly","savecallist",E+"&fakeoption="+document.getElementById("fake_grupo").title),alerta("feed-fixo",TR_AL)):alerta("msg",TR_NM_LE);break;case"savesin":if(document.getElementById("savemvi")){h=new Array,_=0,b=document.getElementById("savemvi").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&(h[_]=b[e],_++);for(let e=0;e<h.length;e++)E=0==e?h[e].getAttribute("class")+"="+h[e].value:E+"&"+h[e].getAttribute("class")+"="+h[e].value;h[1].value.trim().length<4?alerta("msg",TR_NM_LE):h[2].value.trim().length<4?alerta("msg",TR_DS_LE):(ajax("fly","savesign",E),"false"==error&&alerta("msg",TR_AL))}else alerta("msg",TR_ES);break;case"savevp":if(document.getElementById("savevp")){h=new Array,_=0,b=document.getElementById("savevp").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&(h[_]=b[e],_++);for(let e=0;e<h.length;e++)E=0==e?h[e].getAttribute("class")+"="+h[e].value:E+"&"+h[e].getAttribute("class")+"="+h[e].value;h[1].value.trim().length<4?alerta("msg",TR_NM_LE):(ajax("fly","savevp",E),alerta("msg",TR_AD))}else alerta("msg",TR_ES);break;case"savescr":h=new Array,_=0,b=document.getElementById("saveap").elements;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&(h[_]=b[e],_++);for(let e=0;e<h.length;e++)0==e?E=h[e].getAttribute("class")+"="+h[e].value:h[e].classList.contains("REPEAT")||h[e].classList.contains("IMG_POS")||h[e].classList.contains("IMG_SIZE")?ajax("fly","alter_attrib","prm_objeto="+tela+"&prm_prop="+h[e].getAttribute("class")+"&prm_value="+encodeURIComponent(h[e].value),!0):E=E+"&"+h[e].className+"="+encodeURIComponent(h[e].value);PRINCP.parentNode.style.setProperty("background-color",h[6].value),PRINCP.style.setProperty("background-image","url("+h[7].value+")"),PRINCP.style.setProperty("background-position",h[8].value),PRINCP.style.setProperty("background-size",h[9].value),PRINCP.style.setProperty("background-repeat",h[10].value),h[1].value.trim().length<4?alerta("msg",TR_NM_LE):h[3].value.trim().length<4?alerta("msg",TR_DS_LE):document.getElementById("fake_grupo").title.trim().length<1?alerta("msg",TR_ES_gr):(ajax("fly","savescr",E+"&p_grupof="+document.getElementById("fake_grupo").title),"false"==error&&(curtain(),alerta("feed-fixo",TR_AL),ajax("list","screen_list","",!0,"floatops"),document.getElementById("floatops").selectedIndex=-1));break;case"savepar":v=document.getElementsByClassName("array_transf"),y=document.getElementsByClassName("array_nomes"),e="";for(let t=0;t<v.length;t++)e=e+"x="+encodeURIComponent(v[t].value)+"&";h="";for(let e=0;e<y.length;e++)h=h+"y="+y[e].value+"&";ajax("fly","save_par",(h=h.slice(0,-1))+"&"+(e=e.slice(0,-1)),"","false"),curtain(),carrega("ajscreen?prm_screen="+tela),alerta("feed-fixo",TR_AL);break;case"consulta":if(0==document.getElementById("painel").querySelectorAll(".error").length){var x=document.getElementById("prm_visao").value;n=document.getElementById("prm_objeto").value;if(document.getElementById("nome_consulta"))var B=document.getElementById("nome_consulta").value;else B="";if(document.getElementById("agrupamento_consulta"))var L=document.getElementById("agrupamento_consulta").value;else L="";if(document.getElementById("grupo_consulta"))var A=document.getElementById("grupo_consulta").value;else A="";var N="";for(let e=(colunas=document.getElementById("coluna").querySelectorAll(".linha")).length-1;e>-1;e--)N=colunas[e].title+"|"+N;var T="",S=document.getElementById("colunas").querySelectorAll(".linha");for(let e=S.length-1;e>-1;e--)T=S[e].title+"|"+T;var k="",w=document.getElementById("colunac").querySelectorAll(".linha");for(let e=w.length-1;e>-1;e--)k=w[e].title+"|"+k;N=N.substr(0,N.length-1),T=T.substr(0,T.length-1),k=k.substr(0,k.length-1),ajax("fly","save_consulta","prm_visao="+x+"&prm_nome="+encodeURIComponent(n)+"&prm_desc="+encodeURIComponent(B)+"&prm_coluna="+N+"&prm_colup="+T+"&prm_agrupador="+k+"&prm_grupo="+A+"&prm_rp="+L,!1),ajax("fly","alter_ordem_geral","prm_valor=1&prm_objeto="+n),document.getElementById("fake_grupo")?noerror("",TR_CR,"msg"):noerror("",TR_AL,"msg"),document.getElementById(n+"trl")?(remover(n+"trl"),reload(n+"trl")):reload(n)}else alerta("msg",TR_ID);break;case"browser":h=new Array,_=0,b=document.getElementById("browseredit").children;for(let e=0;e<b.length;e++)b[e].getAttribute("class")&&(h[_]=b[e],_++);for(let e=0;e<h.length;e++)E=0==e?h[e].getAttribute("class")+"="+h[e].value:E+"&"+h[e].getAttribute("class")+"="+h[e].value;h[1].value.trim().length<3?alerta("msg",TR_NM_LE):(ajax("fly","browserEditLine",E),alerta("msg",TR_AD));break;default:document.getElementById("fakelist").setAttribute("class","")}}function blocoConsulta(e,t){e.style.setProperty("display","none");t=document.getElementById(t);var n=document.createElement("li"),a=document.createElement("span");a.innerHTML="X",n.className="linha",n.title=e.title,n.innerHTML=e.innerHTML,n.appendChild(a),n.setAttribute("onclick","swapColumn(this)"),t.appendChild(n);var r=document.createElement("li");r.className="square",r.setAttribute("onclick","swapSquare(this)"),t.appendChild(r)}function resizeBrowser(e,t){var n=e.parentNode;n.clientHeight!=n.getAttribute("data-height")&&ajax("fly","alter_attrib","prm_objeto="+t+"&prm_prop=ALTURA&prm_value="+n.clientHeight+"&prm_usuario="+USUARIO,!0),n.clientWidth!=n.getAttribute("data-width")&&ajax("fly","alter_attrib","prm_objeto="+t+"&prm_prop=LARGURA&prm_value="+n.clientWidth+"&prm_usuario="+USUARIO,!0)}function showtag(e,t,n,a,r,o,l){var i;document.getElementById(t)&&(i=document.getElementById(t)).parentNode.removeChild(i);document.getElementById("jumpdrill")&&(i=document.getElementById("jumpdrill")).parentNode.removeChild(i);var d=document.createElement("div");d.setAttribute("id","jumpdrill"),d.setAttribute("name",n),d.setAttribute("class",a),d.setAttribute("data-multi",r),d.setAttribute("data-linha",o),-1!=document.querySelector(".info").innerHTML.indexOf("DWU")&&d.setAttribute("title",document.getElementById("drill_go").value);var s="";document.getElementById("par_"+t.replace("sdrill_",""))&&(s=document.getElementById("par_"+t.replace("sdrill_","")).value),d.setAttribute("data-pivot",l),d.setAttribute("data-filtro",s),MAIN.appendChild(d)}function showview(e){e=e.split("|");var t="";for(let n=0;n<e.length-6;n++)e[n+6]&&(0==n?t=check_value(e[n+6]):t+=check_value(e[n+6]));if(t=encodeURIComponent(t).replace(/\'/g,"%27"),removeTrash(),document.getElementById(e[0]+"trl"))"dragme grafico scaled"!=document.getElementById(e[3]).className&&(loading(),LAYER.className="ativo",remover(e[0]+"trl"),document.getElementById("drill_obj").value=e[0],appendar("prm_drill=Y&prm_objeto="+e[0]+"&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_zindex=&prm_parametros="+check_value(e[1])+check_value(e[2])+check_value(e[5])+t+"&prm_screen="+e[4]+"&prm_track="+e[0]+"&prm_objeton="+e[0],"in"),setTimeout(function(){centerDrill(e[0]);var t=setInterval(function(){document.getElementById(e[0])&&(carrega("ajobjeto?prm_objeto="+e[0]),clearInterval(t)),document.getElementById(e[0]+"trl")&&clearInterval(t)},100)},500));else{if("dragme grafico scaled"==document.getElementById(e[3]).className)return!1;loading(),document.getElementById("drill_obj").value=e[0],appendar("prm_drill=Y&prm_objeto="+e[0]+"&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_zindex=&prm_parametros="+e[1]+check_value(e[2])+check_value(e[5])+t+"&prm_screen="+e[4]+"&prm_track="+e[0]+"&prm_objeton="+e[0],"in"),setTimeout(function(){centerDrill(e[0]),ciclo=setInterval(function(){document.getElementById(e[0])&&(carrega("ajobjeto?prm_objeto="+e[0]),clearInterval(ciclo)),document.getElementById(e[0]+"trl")&&clearInterval(ciclo)},100)},500)}}function showview2(e){var t=(e=document.getElementById(e).getAttribute("data-valor")).split("|"),n="";for(let e=0;e<t.length-1;e++)t[e+1]&&(0==e?n=t[e+1]:n+=check_value(t[e+1]));if("|"===(n=encodeURIComponent(n).replace(/\'/g,"%27")).charAt(0)&&(n=n.substr(1)),"dragme grafico scaled"!=document.getElementById(t[0]).className){if(removeTrash(),remover(t[0]+"trl"),document.getElementById("jumpdrill")){var a=document.getElementById("jumpdrill");a.parentNode.removeChild(a)}showtag("drill_show","sdrill_"+t[0],"",n,n,n,""),ajax("list","load_drill","prm_objeto="+t[0]+"trl&prm_parametros="+encodeURIComponent(n)+"&prm_track="+n+"&prm_objeton="+n,!1,"jumpdrill"),jumpdrill.setAttribute("style","top:"+(cursory+3)+"px; left:"+cursorx+"px;"),setTimeout(function(){jumpdrill.style.setProperty("opacity","1"),jumpdrill.style.setProperty("margin-top","0")},100)}}function showview3(e){loading();var t=e.split("||")[0].split("|"),n=e.split("||")[1];t[2]?(remover(t[1]+"trl"),call("show_objeto","prm_drill=Y&prm_objeto="+t[1]+"&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_zindex=&prm_parametros="+encodeURIComponent(n)+"&prm_screen="+tela+"&prm_track="+t[0]+"&prm_objeton="+t[0],"obj").then(function(e){var t=document.createElement("div");t.innerHTML=e,t.children[0].style.setProperty("opacity","0"),MAIN.appendChild(t.children[0])}).then(function(){document.getElementById(t[1])&&(carrega("ajobjeto?prm_objeto="+t[1]),centerDrill(t[1]),eventos(document.getElementById(t[1])),ajustar(t[1]),setTimeout(function(){document.getElementById(t[1]).style.setProperty("opacity","1")},100)),document.getElementById(t[1]+"trl")&&(carrega("ajobjeto?prm_objeto="+t[1]+"trl"),centerDrill(t[1]+"trl"),eventos(document.getElementById(t[1]+"trl")),ajustar(t[1]+"trl"),setTimeout(function(){document.getElementById(t[1]+"trl").style.setProperty("opacity","1")},100))})):t[3]||(remover(t[1]+"trl"),call("show_objeto","prm_drill=Y&prm_objeto="+t[1]+"&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_zindex=&prm_parametros="+encodeURIComponent(n)+"&prm_screen="+tela+"&prm_track="+t[0]+"&prm_objeton="+t[0],"obj").then(function(e){var t=document.createElement("div");t.innerHTML=e,t.children[0].style.setProperty("opacity","0"),MAIN.appendChild(t.children[0])}).then(function(){document.getElementById(t[1])&&(carrega("ajobjeto?prm_objeto="+t[1]),centerDrill(t[1]),eventos(document.getElementById(t[1])),ajustar(t[1]),setTimeout(function(){document.getElementById(t[1]).style.setProperty("opacity","1")},100)),document.getElementById(t[1]+"trl")&&(carrega("ajobjeto?prm_objeto="+t[1]+"trl"),centerDrill(t[1]+"trl"),eventos(document.getElementById(t[1]+"trl")),ajustar(t[1]+"trl"),setTimeout(function(){document.getElementById(t[1]+"trl").style.setProperty("opacity","1")},100))})),setTimeout(function(){loading()},100)}function showview4(e){if(e.split("|").length>2){if(-1!=e.indexOf("||"))var t=e.split("||")[1],n=e.split("||")[0].split("|");else t="",n=e.split("|");if("|"===t.charAt(0)&&(t=t.substr(1)),removeTrash(),remover(n[0]+"trl"),document.getElementById("jumpdrill")){var a=document.getElementById("jumpdrill");a.parentNode.removeChild(a)}showtag("drill_show","sdrill_"+n[0],"",t,t,t,""),ajax("list","load_drill","prm_objeto="+n[0]+"trl&prm_parametros="+encodeURIComponent(t)+"&prm_track="+t+"&prm_objeton="+t,!1,"jumpdrill"),jumpdrill.setAttribute("style","top:"+(cursory+3)+"px; left:"+cursorx+"px;"),setTimeout(function(){jumpdrill.style.setProperty("opacity","1"),jumpdrill.style.setProperty("margin-top","0")},100)}}function showview_org(e){var t=e[0];if(t.getAttribute("data-goto").length>1){loading();var n=t.getAttribute("data-goto").split("|");removeTrash(),remover(n[0]+"trl"),remover(n[0]);var a="";for(let e=0;e<n.length-1;e++)n[e+1]&&(a=0==e?n[e+1]:a+"|"+n[e+1]);appendar("prm_drill=Y&prm_objeto="+n[0]+"&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_zindex=&prm_parametros=1|1|qb_depto|"+t.id+"|"+a+"&prm_screen="+tela+"&prm_track=qb_depto&prm_objeton=departamento","in"),ajustaIframe(n[0]+"trl"),centerDrill(n[0]),carrega("ajobjeto?prm_objeto="+n[0])}}function check_tag(e,t,n,a,r,o){if(-1==get(t).className.indexOf("scaled")){r=r||"";var l=a,i=get(t),d=[],s=i.querySelectorAll(".tdselected"),c=s.length,m=i.querySelectorAll(".checked"),u=m.length;"fixed"==o.parentNode.className?o.parentNode.getAttribute("data-i"):o.getAttribute("data-i");for(let e=0;e<c;e++)d.push(s[e].getAttribute("data-valor"));d.filter(e=>e).join("|"),d=[];for(let e=0;e<u;e++)d.push(m[e].getAttribute("data-valor"));d.length>0&&(l=d.filter(e=>e).join("|"));let n=[];n.push(l),n.push(r),document.getElementById("drill_go").value=n.filter(e=>e).join("|");var p=!0;o.parentNode.getAttribute("data-drill")&&"S"!=o.parentNode.getAttribute("data-drill")&&(p=!1),o.parentNode.classList.contains("duplicado")&&(p=!1),p&&drillfix(e,t)}}function check_value(e){return void 0!==e?0==e.trim.length?"":("|"+e).replace("||","|"):""}var sobbar="",checklayer="",activeshow="",conteudo="";function shscr(e,t,n,a){var r=document.querySelectorAll(".filtro.show");for(let e=0;e<r.length;e++)r[e].classList.remove("show"),r[e].classList.add("hidden"),r[e].setAttribute("data-desc","");document.getElementById("popupmenu")&&((o=document.getElementById("popupmenu")).classList.contains("visible")&&(o.classList.remove("visible"),o.innerHTML=""));if(MAIN.style.setProperty("background-color",""),MAIN.style.setProperty("background-image",""),parseInt(document.getElementById("layer3").style.getPropertyValue("height"))>0&&(PRINCP.style.setProperty("overflow","visible"),PRINCP.style.removeProperty("height"),document.getElementById("html").style.setProperty("overflow","visible"),document.getElementById("layer3").style.setProperty("height","0"),document.getElementById("prev").style.setProperty("display","none"),document.getElementById("next").style.setProperty("display","none")),clearInterval(checklayer),loaded(),!LAYER.classList.contains("ativo")){var o;if("UPQUERY"!=(a||"UPQUERY")?(document.getElementById("menup").classList.add("invisible"),MAIN.style.setProperty("padding-top","0"),LAYER.style.setProperty("top","0"),LAYER.style.setProperty("height","100%")):document.getElementById("menup")&&(document.getElementById("menup").classList.remove("invisible"),MAIN.style.setProperty("padding-top",""),LAYER.style.setProperty("top","35"),LAYER.style.setProperty("height","calc(100% - 35px)")),document.getElementById("attriblist").classList.remove("open"),document.getElementById("floatlist").classList.remove("open"),document.getElementById("donut").classList.remove("open"),curtain("x"),clearInterval(auto_refresh),document.getElementById("fakelist").classList.remove("visible"),zindex_abs=5,clearInterval(textTalk),document.getElementById("show_only_screen")&&MAIN.style.setProperty("padding-top","6px"),document.getElementById("call-menu"))(o=document.getElementById("call-menu")).classList.add("invisible"),call("obj_screen_count","prm_screen="+e+"&prm_tipo=CALL_LIST").then(function(e){parseInt(e)>0?o.classList.remove("invisible"):o.classList.add("invisible")});if(document.getElementById("float-filter")){var l=document.getElementById("float-filter");l.classList.add("invisible"),document.getElementById("show_only_screen")||call("obj_screen_count","prm_screen="+e+"&prm_tipo=FLOAT").then(function(e){parseInt(e)>0?l.classList.remove("invisible"):l.classList.add("invisible")})}if(document.getElementById("favoritos")){var i=document.getElementById("favoritos");i.classList.add("invisible"),call("obj_screen_count","prm_screen="+e+"&prm_tipo=FAVORITOS").then(function(e){parseInt(e)>0?i.classList.remove("invisible"):i.classList.add("invisible")})}clearInterval(checkscreen),clearInterval(loopscreen),document.getElementById("show_only_bar")&&(clearInterval(sobbar),document.getElementById("show_only_bar").style.setProperty("width",0)),document.getElementById("filterlist").className="filtro hidden";var d=document.getElementById("current_screen");loading("x"),document.getElementById("text-talk").className="";var s=document.getElementById("back");void 0!==t&&t.length>0?(s.className="visible",s.setAttribute("data-screen",t),ajax("list","screen_list","prm_objeto=",!0,"floatops")):s.className="invisible";var c,m=PRINCP.children[0];if("calendar-box"==m.className&&m.style.setProperty("display","none"),document.getElementById("timer")){var u=document.getElementById("timer");u.parentNode.removeChild(u)}for(removeTrash(),document.getElementById("main-ext").innerHTML="";MAIN.firstChild;)MAIN.removeChild(MAIN.firstChild);if(tela=e.replace(" ","_"),void 0!==t?call("show_screen","prm_screen="+e+"&prm_screen_ant="+t+"&prm_parametro="+n).then(function(e){-1==e.indexOf("LOGOUT")?(MAIN.innerHTML=e,icarrega(),MAIN.children[0]&&"data_list"==MAIN.children[0].id&&ajustar(MAIN.children[0].className)):logout()}):call("show_screen","prm_screen="+e+"&prm_screen_ant=&prm_parametro=").then(function(e){main.innerHTML=e,icarrega(),main.children[0]&&"data_list"==main.children[0].id&&ajustar(main.children[0].className)}),ajaxExt(e),d.value=tela,clearInterval(timeout),"DEFAULT"!=d.value&&"SANDBOX"!=d.value)call("countdown","prm_screen="+d.value).then(function(e){if(0!=(c=e)){var t=parseInt(c);timeout=setInterval(refreshTela,t)}});var p=0;checklayer=setInterval(function(){"ativo"!=layer.className&&(clearInterval(checklayer),loaded()),(p+=1)>=500&&clearInterval(checklayer)},200),document.getElementById("tela-atual")&&(document.getElementById("tela-atual").innerHTML="",call("title_screen","prm_screen="+e).then(function(e){e.trim().length>0&&(document.getElementById("tela-atual").innerHTML=e.trim())})),setTimeout(function(){-1!=MAIN.className.indexOf("usuario")?ajax("input","check_data","prm_valor="+e+"&prm_tabela=main&prm_true=usuario&prm_false=usuario row",!0,"main"):ajax("input","check_data","prm_valor="+e+"&prm_tabela=main&prm_true=&prm_false=row",!0,"main")},5)}d&&("DEFAULT"!=d.value?call("background_attrib","prm_screen="+e).then(function(e){var t=e;-1==t.indexOf("EXT=")?MAIN.setAttribute("style",t):MAIN.style.setProperty("background-image","none")}):setTimeout(function(){MAIN.style.setProperty("background-image","url(dwu.fcl.download?arquivo=bg.jpg)")},1e3))}function refreshTela(){0==document.querySelectorAll(".drill").length&&(shscr(tela),curtain())}function loaded(){clearTimeout(activeshow);var e=document.querySelectorAll(".dragme"),t=e.length;for(let i=0;i<t;i++){if(document.getElementById(e[i].id+"min")){var n=document.getElementById(e[i].id+"min");n.addEventListener("mouseup",function(){this.parentNode.querySelector(".espaco").classList.toggle("min")}),n.addEventListener("touchend",function(){this.parentNode.querySelector(".espaco").classList.toggle("min")})}var a,r;if("A"==ADMIN){if(document.getElementById(e[i].id+"_ds")&&-1==document.getElementById(e[i].id).className.indexOf("float")){var o=e[i].id,l=document.getElementById(o+"_ds");"mobile"==PRINCP.className?(a="touchstart",r="touchend"):(a="mousedown",r="mouseup"),l.addEventListener(a,function(){invisible_touch(this.parentNode.id,"start")}),l.addEventListener(r,function(){invisible_touch(this.parentNode.id,"stop"),"touchend"==r&&dblTouch(this.parentNode.id)}),l.addEventListener("dblclick",function(){get("jumpdrill")&&get("jumpdrill").remove(),curtain(""),scale(this.id.replace("_ds",""),"direct")})}}else if(document.getElementById(e[i].id+"_ds")&&-1==document.getElementById(e[i].id).className.indexOf("float")){o=e[i].id;(l=document.getElementById(o+"_ds")).addEventListener("dblclick",function(){get("jumpdrill")&&get("jumpdrill").remove(),curtain(""),scale(this.id.replace("_ds",""),"direct")})}}if(projecoes.length>0){var i=document.getElementById("active-show").nextElementSibling;activeshow="show_only"==i.className?setTimeout(function(){document.getElementById("active-show").id="",i.id="active-show",removeTrash(),shscr(i.value)},parseInt(document.getElementById("active-show").getAttribute("data-time")+"000")+1e3):setTimeout(function(){document.getElementById("active-show").id="",projecoes[0].id="active-show",removeTrash(),shscr(projecoes[0].value)},parseInt(document.getElementById("active-show").getAttribute("data-time")+"000")+1e3)}}function addLink(){if(document.getElementById("attriblist")){var e=document.getElementById("attriblist").getElementsByTagName("LI"),t=e.length;for(let n=0;n<t;n++)"SCRIPT"!=e[n].className&&(e[n].firstElementChild.removeEventListener("click",menuLink),e[n].firstElementChild.addEventListener("click",menuLink))}}function changeScreen(){document.getElementById("floatops").blur(),document.getElementById("donut").setAttribute("class","");var e=document.getElementById("html"),t=document.getElementById("floatops").getElementsByTagName("option")[document.getElementById("floatops").selectedIndex];document.getElementById("prefdrop")&&(document.getElementById("prefdrop").className="hidden"),"X"!=t.value?(shscr(t.value),-1==t.getAttribute("data-url").indexOf("EXT=")?setTimeout(function(){e.style.setProperty("background-color",t.getAttribute("data-bg")),MAIN.style.setProperty("background-repeat",t.getAttribute("data-repeat")),MAIN.style.setProperty("background-position",t.getAttribute("data-pos")),MAIN.style.setProperty("background-size",t.getAttribute("data-size")),MAIN.style.setProperty("background-image","url("+t.getAttribute("data-url")+")")},1e3):setTimeout(function(){e.style.setProperty("background-color",t.getAttribute("data-bg")),MAIN.style.setProperty("background-repeat",t.getAttribute("data-repeat")),MAIN.style.setProperty("background-position",t.getAttribute("data-pos")),MAIN.style.setProperty("background-size",t.getAttribute("data-size")),MAIN.style.setProperty("background-image","")},1e3)):document.getElementById("opcoes").className="closed"}function fecharSup(){var e=this;clearInterval(auto_refresh),document.getElementById("fakelist").setAttribute("data-campo",""),document.getElementById("fakelist").setAttribute("class",""),alerta("msg",""),curtain(),setTimeout(function(){var t=e.getAttribute("data-reloado");if("false"!=t){if(get(t)){var n=document.getElementById(t),a=n.offsetLeft+"px",r=n.offsetTop,o=tela;window.getComputedStyle(n).getPropertyValue("order")&&(dashorder="&prm_dashboard=true",dashlocation=n.parentNode.id,a=window.getComputedStyle(n).getPropertyValue("order"),o=n.parentNode.id),n.remove(),loading(""),appendar("prm_objeto="+t+"&PRM_ZINDEX=2&prm_posx="+a+"&prm_posy="+r+"px&prm_screen="+tela+dashorder,dashlocation,o),setTimeout(function(){carrega("ajobjeto?prm_objeto="+t)},100)}e.setAttribute("data-reloado","false")}"false"!=e.getAttribute("data-reloads")&&(shscr(tela),e.setAttribute("data-reloads","false"))},200)}function activemap(e,t,n){try{var a=new FusionCharts("Brazil","mapid",n,t)}catch(e){picx=0}document.getElementById("gxml_"+e).children[0]?a.setXMLData(document.getElementById("gxml_"+e).innerHTML):a.setXMLData(document.getElementById("gxml_"+e).value);try{a.render("ctmr_"+e)}catch(e){picx=0}a.setChartAttribute("stroke",null)}function browserMenu(e,t){e.classList.remove("open"),document.getElementById("editb").innerHTML="";parseInt(window.getComputedStyle(document.getElementById("data_list_menu")).height);t&&setTimeout(function(){e.classList.add("open")},100)}function browserOrder(e){e.target.getAttribute("data-coluna")&&(e.target.classList.contains("selectedbheader")?e.target.classList.contains("desc")?(e.target.classList.remove("desc"),e.target.classList.remove("selectedbheader")):e.target.classList.add("desc"):e.target.classList.add("selectedbheader"),browserSearch("BUSCA"))}var beta={};function browserSearch(e,t){if(document.querySelector(".selectedbheader")){var n,a=document.querySelectorAll(".selectedbheader"),r=[];for(let e=0;e<a.length;e++)a[e].classList.contains("desc")?r.push(a[e].getAttribute("data-ordem")+" DESC"):r.push(a[e].getAttribute("data-ordem"));n=r.join(",")}else n=1;e=e||"BUSCA",t=t||"";if(LAYER.classList.contains("ativo")||loading(),0==t.length&&ajax("fly","alter_attrib","prm_objeto="+document.getElementById("data_list").className+"&prm_prop=DIRECTION&prm_value="+n+"&prm_usuario="+USUARIO,!0),document.getElementById("browser-condicao").parentNode.classList.contains("ligacao"))o=document.getElementById("browser-condicao").nextElementSibling.title;else var o=document.getElementById("data-valor").value;var l=document.getElementById("data_list").getAttribute("data-tabela"),i=document.getElementById("browser-coluna").value,d=document.getElementById("data_list").className,s=document.getElementById("data-coluna").value,c=document.getElementById("browser-condicao").value,m=document.getElementById("linhas").value,u=document.getElementById("data-coluna").options[document.getElementById("data-coluna").selectedIndex].innerHTML;setTimeout(function(){if("semelhante"==c)var a="like";else a=c;var r="",p="";if(1==beta.browser.acumulado){p=document.getElementsByClassName("acumulado");var g="$["+a.toUpperCase()+"]",f=s+"|"+g+o,v=!1,y=!1;for(let e=0;e<p.length;e++)p[e].title==f&&(v=!0),r=r+"|"+p[e].title;if(!v){var h=document.createElement("span");-1!=c.indexOf("nulo")?-1!=c.indexOf("nnulo")?h.innerHTML=u+" não nulo":h.innerHTML=u+" "+c.toLowerCase():(0==o.trim().length&&(y=!0),-1!=c.indexOf("diferente")?h.innerHTML=u+" "+c.toLowerCase()+" de "+o:-1!=c.indexOf("maior")?h.innerHTML=u+" "+c.toLowerCase()+" que "+o:h.innerHTML=u+" "+c.toLowerCase()+" a "+o);var _=document.createElement("a");_.innerHTML="X",_.title=TR_TB,_.addEventListener("click",function(){this.parentNode.remove(),setTimeout(function(){browserSearch("")},100)}),h.appendChild(_),document.getElementById("data-valor").value="",document.getElementById("data-valor").previousElementSibling.title="",document.getElementById("data-valor").previousElementSibling.children[0].innerText="",y||(h.title=f,h.classList.add("acumulado"),document.getElementById("filtros-acumulados").appendChild(h))}}"save"==e&&(e=">",t=document.getElementById("ajax").firstElementChild?parseInt(document.getElementById("ajax").firstElementChild.className)-1:0),ajax("list","dt_pagination","prm_micro_data="+l+"&prm_coluna="+i+"&prm_objid="+d+"&prm_chave="+s+"&prm_ordem="+n+"&prm_screen="+tela+"&prm_limite="+m+"&prm_origem="+t+"&prm_direcao="+e+"&prm_busca="+o+"&prm_condicao="+c+"&prm_acumulado="+r.replace("|",""),!1,"ajax","","","bro"),loading(),document.getElementById("browser-page").innerHTML="",call("get_total","prm_microdata="+l+"&prm_objid="+d+"&prm_screen="+tela+"&prm_condicao="+c+"&prm_coluna="+i+"&prm_chave="+s+"&prm_ordem="+n+"&prm_busca="+o,"bro").then(function(e){document.getElementById("browser-page").outerHTML=e}).then(function(){var e=document.getElementById("linhas").value;if(document.getElementById("ajax").lastElementChild){var t=Math.ceil(parseInt(document.getElementById("ajax").lastElementChild.className)/e),n=Math.ceil(document.getElementById("browser-page").getAttribute("data-total")/e);document.getElementById("browser-page").setAttribute("data-pagina",t),document.getElementById("browser-page").innerHTML=t+"/"+n}})},10)}function browserPage(){var e=document.getElementById("browser-page"),t=document.getElementById("linhas").value,n=Math.ceil(parseInt(document.getElementById("ajax").lastElementChild.className)/t),a=Math.ceil(e.getAttribute("data-total")/t);n<1&&(n=1),a<1&&(a=1),e.innerHTML=n+"/"+a,e.setAttribute("data-pagina",n),e.className=a}function toggleAba(e){document.querySelector(".abas").querySelector(".green").classList.remove("green"),e.classList.add("green");var t=e.parentNode.parentNode.querySelectorAll(".form");for(let n=0;n<t.length;n++)t[n].id==e.getAttribute("data-for")?t[n].classList.remove("closed"):t[n].classList.add("closed")}function saveFloats(){var e=document.querySelector(".itens").getElementsByTagName("ul");for(let r=0;r<e.length;r++){var t=e[r].children;for(let e=0;e<t.length;e++)if(-1!=t[e].children[2].className.indexOf("float")){var n=t[e].children[2].children[0].children,a="";for(let e=0;e<n.length;e++)1==n[e].selected&&(a=a+"|"+n[e].value);ajax("fly","save_float","ws_conteudo="+encodeURIComponent(a)+"&ws_padrao="+t[e].children[1].title)}else t[e].children[2]&&ajax("fly","save_float","ws_conteudo="+encodeURIComponent(t[e].children[2].value)+"&ws_padrao="+t[e].children[1].title)}}function sos(e){var t=document.getElementById(e);t.getAttribute("data-script").length>0&&confirm(TR_CM)&&(ajax("return","programa_execucao","prm_objeto="+e+"&prm_parametros="+encodeURIComponent(t.getAttribute("data-parametros"))+"&prm_screen="+tela,"",!1),alerta("feed-fixo",respostaAjax.trim()));var n=t.getAttribute("data-chamada");n.length>0&&(-1!=n.indexOf("SRC_")?shscr(n):(cleardrill(),document.getElementById("drill_obj").value=n+"trl",appendar("prm_drill=Y&prm_objeto="+n+"&prm_zindex=2&prm_posx="+(cursorx-20)+"px&prm_posy="+(cursory-20)+"px&prm_screen="+tela, '',''),carrega("ajobjeto?prm_objeto="+n+"trl"),centerDrill(n)))}function browserEvent(e,t,n,a){var r=document.getElementById("data_list_menu");if("edit"==n){var o=e.target.parentNode;if(document.querySelector(".selectedbline")&&document.querySelector(".selectedbline").classList.remove("selectedbline"),selectedb!=o.id||o.classList.contains("attach")){selectedb=o.id,o.classList.add("selectedbline");var l=[];if(e.target.classList.contains("attach-div"))var i=o.parentNode.querySelectorAll(".chave");else i=o.querySelectorAll(".chave");var d=i.length;for(let e=0;e<d;e++)l.push(encodeURIComponent(i[e].getAttribute("data-d")));o.classList.contains("attach")?(curtain("only"),browserMenu(r,e),ajax("list","anexo","prm_chave="+t+"|"+l.join("|"),!1,"editb","","","bro"),ajax("list","browserButtons","prm_tipo=&prm_visao=&prm_chave=",!1,"browserbuttons","","","bro")):(curtain("only"),ajax("list","browserButtons","prm_tipo=update&prm_visao="+t+"&prm_chave=",!1,"browserbuttons","","","bro"),call("browserEdit","prm_obj="+t+"&prm_chave="+l.join("|")+"&prm_campo="+document.getElementById("browser-chave").value+"&prm_tabela="+document.getElementById("data_list").getAttribute("data-tabela"),"bro").then(function(t){browserMenu(r,e),document.getElementById("editb").innerHTML=t}).then(function(){var e=document.getElementById("browseredit").querySelectorAll("[data-evento]"),t=e.length;for(let n=0;n<t;n++)e[n].getAttribute("data-evento").split("|").forEach(function(t){e[n].addEventListener(t,browser_tipo_valor)})}))}else o.classList.remove("selectedbline"),r.classList.remove("open"),selectedb=""}"new"==n&&(document.querySelector(".selectedbline")&&document.querySelector(".selectedbline").classList.remove("selectedbline"),curtain("only"),ajax("list","browserButtons","prm_tipo=insert&prm_visao="+t+"&prm_chave="+document.getElementById("browser-chave").value,!1,"browserbuttons","","","bro"),call("browserEdit","prm_obj="+t+"&prm_chave=&prm_campo="+document.getElementById("browser-chave").value+"&prm_tabela="+document.getElementById("data_list").getAttribute("data-tabela"),"bro").then(function(t){browserMenu(r,e),document.getElementById("editb").innerHTML=t}).then(function(){var e=document.getElementById("browseredit").querySelectorAll("[data-evento]"),t=e.length;for(let n=0;n<t;n++)e[n].getAttribute("data-evento").split("|").forEach(function(t){e[n].addEventListener(t,browser_tipo_valor)})})),"colunas"==n&&(selectedb="",browserMenu(r,""),document.querySelector(".selectedbline")&&document.querySelector(".selectedbline").classList.remove("selectedbline"),document.getElementById("titulo").innerHTML=n,call_save(""),curtain("enabled"),call("browserConfig","prm_microdata="+t,"BRO").then(function(e){document.getElementById("content").innerHTML=e;var n=document.getElementById("data_list").getAttribute("data-tabela");carregaPainel("browser",t+"|"+n)})),"filtros"==n&&(selectedb="",browserMenu(r,""),document.querySelector(".selectedbline")&&document.querySelector(".selectedbline").classList.remove("selectedbline"),document.getElementById("titulo").innerHTML=n,call_save(""),curtain("enabled"),call("list_ofiltro","ws_par_sumary="+t+"&prm_visao="+a).then(function(e){document.getElementById("content").innerHTML=e,carregaPainel("browserfiltro",t)})),"destaques"==n&&(selectedb="",browserMenu(r,""),document.querySelector(".selectedbline")&&document.querySelector(".selectedbline").classList.remove("selectedbline"),document.getElementById("titulo").innerHTML=n,call_save(""),curtain("enabled"),call("blink","prm_objeto="+t+"&prm_visao="+a).then(function(e){document.getElementById("content").innerHTML=e,carregaPainel("blinkbrowser",t)}))}function browser_tipo_valor(){if(-1==this.parentNode.getAttribute("data-tipo").indexOf("number"))this.parentNode.setAttribute("data-v",this.value.replace(/\>/g,"").replace(/\</g,""));else{var e=this.value;(e=e.split("."))[e.length-1]=e[e.length-1].replace(",","."),e=e.join(","),this.parentNode.setAttribute("data-v",e)}}function callDrill(e,t){var n=e.value;document.getElementById("drill_obj").setAttribute("value",n+"trl"),remover("jumpdrill"),remover(n+"trl"),appendar("prm_drill=Y&prm_objeto="+n+"&prm_posx="+cursorx+"px&prm_posy="+cursory+"px&prm_zindex=2&prm_parametros="+encodeURIComponent(t)+"&prm_screen="+tela),setTimeout(function(){ajustar(n+"trl"),carrega("ajobjeto?prm_objeto="+n+"trl"),centerDrill(n)},10)}function colunasCalculo(e,t){var n=[],a=document.getElementById("fakelist").querySelectorAll(".calculos_n");for(let e=0;e<a.length;e++)n.push(encodeURIComponent(a[e].value));ajax("fly","alter_attrib","prm_objeto="+e+"&prm_prop=CALCULADA_N&prm_value="+n.join("|")+"&prm_usuario="+t,!1);n=[],a=document.getElementById("fakelist").querySelectorAll(".calculos");for(let e=0;e<a.length;e++)n.push(encodeURIComponent(a[e].value));ajax("fly","alter_attrib","prm_objeto="+e+"&prm_prop=CALCULADA&prm_value="+n.join("|")+"&prm_usuario="+t,!1);n=[],a=document.getElementById("fakelist").querySelectorAll(".calculos_m");for(let e=0;e<a.length;e++)n.push(encodeURIComponent(a[e].value));ajax("fly","alter_attrib","prm_objeto="+e+"&prm_prop=CALCULADA_M&prm_value="+n.join("|")+"&prm_usuario="+t,!1),alerta("feed-fixo",TR_AL)}function savePrefixo(e,t){if("add"==t)var n=(d=document.getElementById("painel")).children[0],a=d.children[1],r=d.children[2],o=d.children[3],l=d.children[4],i=d.children[5];else{var d;n=(d=e.parentNode.parentNode).children[0].children[0],a=d.children[1].children[0],r=d.children[2].children[0],o=d.children[3].children[0],l=d.children[4].children[0],i=d.children[5].children[0]}call("prefixo_alter","prm_prefixo="+n.value+"&prm_lov="+a.value+"&prm_lovp="+r.value+"&prm_agrupador="+o.value+"&prm_mascara="+l.value+"&prm_alinhamento="+i.value+"&prm_prefixo_ant="+n.getAttribute("data-ant")+"&prm_lov_ant="+a.getAttribute("data-ant")+"&prm_lovp_ant="+r.getAttribute("data-ant")+"&prm_agrupador_ant="+o.getAttribute("data-ant")+"&prm_mascara_ant="+l.getAttribute("data-ant")+"&prm_alinhamento_ant="+i.getAttribute("data-ant")+"&prm_evento="+t).then(function(e){-1!=e.indexOf("ok")&&(n.setAttribute("data-ant",n.value),a.setAttribute("data-ant",a.value),r.setAttribute("data-ant",r.value),o.setAttribute("data-ant",o.value),l.setAttribute("data-ant",l.value),i.setAttribute("data-ant",i.value))}).then(function(){"add"==t&&(carrega("prefixo_lista"),alerta("feed-fixo",TR_AD)),"remove"==t&&alerta("feed-fixo",TR_EX),"edit"==t&&alerta("feed-fixo",TR_AL)})}function medDrill(e,t,n){remover("sdrill_"+t),remover("jumpmed"),setTimeout(()=>{let a=document.createElement("div");a.id="jumpmed";var r=e.getBoundingClientRect();a.style.setProperty("left",r.left-104+r.width/2+"px"),a.style.setProperty("top",r.top+r.height+"px"),document.createElement("span").classList.add("inv"),document.createElement("p").innerHTML=e.innerText;let o=document.createElement("a");o.classList.add("script"),o.addEventListener("click",()=>{agrupadorChange(t.replace("trl",""),e.getAttribute("data-valor"),o.nextElementSibling.title)});var l=document.createElement("span");call("jumpmed","prm_coluna="+e.getAttribute("data-valor")+"&prm_visao="+n+"&prm_objeto="+t.replace("trl","")).then(function(e){l.outerHTML=e});let i=document.createElement("a");i.innerHTML="x",i.addEventListener("click",function(){remover("jumpmed")}),a.appendChild(o),a.appendChild(l),a.appendChild(i),MAIN.appendChild(a),setTimeout(function(){a.classList.add("open")},100)},100)}function converteDecimal(e){var t=e,n=t.split();for(let e=0;e<n.length;e++)"."==n[e]?n[e]=",":","==n[e]&&(n[e]=".");return t=n.join()}function stripTags(e){return e.split(/\<[a-zA-Z0-9\/]+\>/g).join("")}function update_prop(e,t,n){var a=n;"nome"!=t&&"subtitulo"!=t&&"descritivo"!=t&&"tamanho_tela"!=t||(a=encodeURIComponent(a)),call("update_prop","prm_id="+e+"&prm_prop="+t+"&prm_valor="+a+"&prm_screen="+tela).then(function(a){if(-1==a.indexOf("fail"))switch(alerta("feed-fixo",TR_AL),t){case"nome":document.getElementById(e+"_ds")&&(document.getElementById(e+"_ds").parentNode.classList.contains("texto")||(document.getElementById(e+"_ds").innerHTML=a));break;case"ID":var r=document.getElementById("ident").getAttribute("data-default");if("main"==document.getElementById(r).parentNode.parentNode.id)var o="&prm_dashboard=false",l="";else{dashlocation=document.getElementById(r).parentNode.parentNode.id;o="&prm_dashboard=true",l=document.getElementById(r).parentNode.style.getPropertyValue("order")}document.getElementById(r).remove(),appendar("prm_objeto="+n+"&PRM_ZINDEX=&prm_posx="+l+"&prm_posy=&prm_screen="+tela+o,!1);break;case"subtitulo":document.getElementById(e+"_sub")&&(document.getElementById(e+"_sub").innerHTML=a);case"descritivo_tela":e==tela&&(document.getElementById("tela-atual").innerHTML=a);break;case"cor_tela":e==tela&&MAIN.style.setProperty("background-color",a)}else alerta("feed-fixo",TR_ER)})}function updatePermissao(e,t){if(!document.querySelector(".fakelistbox.open").parentNode.classList.contains("searchbar")){var n=e.className,a=e.title;"over"==t?1==mousedown&&(-1==n.indexOf("selected")?update_prop(tela,"usuarios-tela-add",a):update_prop(tela,"usuarios-tela-del",a)):-1==n.indexOf("selected")?update_prop(tela,"usuarios-tela-add",a):update_prop(tela,"usuarios-tela-del",a)}}function limpaTimer(){clearInterval(timer_rel)}function gerar_relatorio(e,t,n){document.getElementById(e+"_button").classList.contains("loading")||(document.getElementById(e+"_lista").children[0]&&document.getElementById(e+"_lista").children[0].classList.add("LOCKED"),call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=false","up_rel").then(function(a){-1!=a.indexOf("SEM CONSULTA")?alerta("feed-fixo",a):-1!=a.indexOf("gerado")?(alerta("feed-fixo",a),call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=check","up_rel").then(function(t){document.getElementById(e+"_button").innerHTML=t,-1==t.indexOf("EXEC")&&clearInterval(timer_rel)}).then(function(){timer_rel=setInterval(function(){call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=check","up_rel").then(function(a){document.getElementById(e+"_button").innerHTML=a,-1==a.indexOf("EXEC")&&(clearInterval(timer_rel),document.getElementById(e+"_button").classList.remove("loading"),alerta("feed-fixo","RELAT&Oacute;RIO GERADO"),document.getElementById(e+"_lista").children[0].classList.remove("LOCKED"),call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=file","up_rel").then(function(t){document.getElementById(e+"_lista").innerHTML=t}))})},5e3)})):a.length>10?-1!=a.indexOf("existe")?alerta("feed-fixo",TR_RG):(document.getElementById(e+"_lista").innerHTML="",document.getElementById(e+"_lista").innerHTML=a):(call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=check","up_rel"),alerta("feed-fixo",TR_GR),document.getElementById(e+"_button").classList.add("loading"),document.getElementById(e+"_button").children[0].innerHTML="EXECUTANDO",timer_rel=setInterval(function(){call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=check","up_rel").then(function(a){document.getElementById(e+"_button").innerHTML=a,-1==a.indexOf("EXEC")&&(clearInterval(timer_rel),setTimeout(function(){document.getElementById(e+"_button").classList.remove("loading"),alerta("feed-fixo",TR_RG),call("lista_rel","prm_objeto="+e+"&prm_screen="+t+"&prm_cod="+n+"&prm_lista=file","up_rel").then(function(t){document.getElementById(e+"_lista").innerHTML=t})},1e3))})},5e3))}))}function createView(){var e=new RegExp("^[a-zA-Z0-9_]+$");checkError();var t=document.getElementById("visao_nome").value,n=document.getElementById("visao_tabela").title,a=document.getElementById("visao_desc").value,r=document.getElementById("fake_grupo").title;t.length>1?n.length>1?a.length>1?r.length>1?e.test(t)?call("new_view","prm_nome="+t+"&prm_tabela="+n+"&prm_desc="+encodeURIComponent(a)+"&prm_grupo="+r).then(function(e){-1==e.indexOf("FAIL")?(alerta("feed-fixo","View criada com sucesso!"),call("load_tables","").then(function(e){document.getElementById("content").innerHTML=e,carregaPainel("visoes")})):alerta("msg",TR_ER)}):alerta("msg",TR_VI):alerta("msg",TR_ES_gr):alerta("msg",TR_DS_LE):alerta("msg",TR_ES_TB):alerta("msg",TR_NM_LE)}function topDistance(e){if(document.getElementById(e)&&document.getElementById(e+"dv2")&&-1==e.indexOf("COBJ")){var t=document.getElementById(e);if(t.getElementsByTagName("thead")[0]){var n=t.getElementsByTagName("thead")[0].getElementsByTagName("tr"),a=n.length;if(a>1)for(let e=1;e<a;e++){var r=n[e].offsetTop;if(r>0){var o=n[e].getElementsByTagName("th"),l=o.length;for(let e=0;e<l;e++)o[e].style.setProperty("top",r+"px")}}if(!document.getElementById("show_only_screen")){for(var i=t.querySelectorAll(".fix"),d=i.length,s=0,c=0;i[c];){s+=i[c].clientWidth;try{if(!i[c].nextElementSibling.classList.contains("fix"))break}catch(e){break}c++}var m=[];"STYLE"==document.getElementById(e).lastElementChild.tagName&&document.getElementById(e).lastElementChild.remove();var u=[];for(let e=1;e<d;e++)"none"!=window.getComputedStyle(i[e],null).display&&u.push(i[e]);if(s<t.clientWidth-180){m.push("table#"+e+"c tr:not(.sub) td:nth-child(1), table#"+e+"c tr:not(.sub):nth-child(1) th:nth-child(1){ left: 1px; }");for(let t=0;t<u.length+1;t++)u[t]?(m.push("table#"+e+"c tr:not(.sub) td:nth-child("+(u[t].cellIndex+1)+"), table#"+e+"c tr:not(.sub):nth-child(1) th:nth-child("+(u[t].cellIndex+1)+"){ left: "+(u[t].offsetLeft-6)+"px; }"),u[t].nextElementSibling&&(u[t].nextElementSibling.classList.contains("fix")||(t=9999999))):t=9999999}var p=document.createElement("style"),g=[...new Set(m)];if(p.innerHTML=g.join(" "),document.getElementById(e).appendChild(p),document.getElementById(e+"c").querySelector(".sub")){var f=document.getElementById(e+"c").getElementsByClassName("fixsub");for(let e=0;e<f.length;e++)f[e].style.setProperty("left",f[e].offsetLeft-6+"px")}}}}}function calcBasis(e){var t=document.getElementById(e),n=t.children.length,a=t.children[0].children.length,r=[];for(let e=0;e<a;e++)r.push(0);var o=0;for(let e=0;e<n;e++)for(let n=0;n<a;n++)(o=t.children[e].children[n].clientWidth)>r[n]&&(r[n]=o);var l=document.createElement("style"),i="";for(let t=1;t<r.length;t++)i=i+" div#"+e+" ul li:nth-child("+(parseInt(t)+1)+"){ flex-basis: "+r[t]+"px; }";l.innerHTML=i,t.appendChild(l)}function carregaObjeto(){var e=document.querySelectorAll(".loader"),t=e.length;for(let a=0;a<t;a++){var n=e[a];call("carrega_objeto","prm_tipo="+n.getAttribute("data-tipo")+"&prm_posicao="+n.getAttribute("data-posicao")+"&prm_parametro="+n.getAttribute("data-parametro")+"&prm_visao="+n.getAttribute("data-visao")+"&prm_coluna="+n.getAttribute("data-coluna")+"&prm_agrupador="+n.getAttribute("data-agrupador")+"&prm_tip="+n.getAttribute("data-tip")+"&prm_obj="+n.getAttribute("data-objeto")+"&prm_screen="+n.getAttribute("data-screen")+"&prm_colup="+n.getAttribute("data-colup")).then(function(e){document.getElementById(n.parentNode.id).innerHTML=e})}}function carregaTela(e,t,n){shscr(e),setTimeout(function(){MAIN.style.setProperty("background-color",t),-1==n.indexOf("EXT=")&&-1==n.indexOf("N/A")?MAIN.style.setProperty("background-image","url("+n+")"):MAIN.style.setProperty("background-image","none")},500)}function addLov(){checkError();var e=document.getElementById("nome_lov").value,t=document.getElementById("lista-tabelas").title,n=document.getElementById("lista-codigo").title,a=document.getElementById("lista-descricao").title;e.length<2?alerta("msg",TR_TC):t.length>1&&n.length>1&&a.length>1?call("savecd","p_funcao=G&p_nds_tabela="+e+"&p_nds_owner=DWU&p_nds_tfisica="+t+"&p_nds_cd_empresa=&p_nds_cd_codigo="+n+"&p_nds_cd_descricao="+a).then(function(e){-1!=e.indexOf("ok")?(alerta("feed-fixo",TR_CR),ajax("list","list_cdesc","prm_order=1&prm_dir=",!1,"content"),carregaPainel("lov")):alerta("feed-fixo",e)}):alerta("feed-fixo",TR_TC)}function addDestaque(){var e=document.getElementById("destaque-usuario").title,t=document.getElementById("destaque-objeto").title,n=document.getElementById("destaque-coluna").title,a=document.getElementById("destaque-condicao").title,r=document.getElementById("destaque-valores").title,o=document.getElementById("destaque-corfundo").value,l=document.getElementById("destaque-corfonte").value,i=document.getElementById("destaque-tipo").value,d=document.getElementById("destaque-prioridade").value;""!=e&&""!=r&&""!=o&&""!=l&&""!=d&&""!=t?call("setdestaque","prm_usuario="+e+"&prm_objeto="+t+"&prm_coluna="+n+"&prm_condicao="+a+"&prm_conteudo="+encodeURIComponent(r)+"&prm_fundo="+o+"&prm_fonte="+l+"&prm_tipo="+i+"&prm_prioridade="+d).then(function(n){-1==n.indexOf("FAIL")?(alerta("feed-fixo",TR_AD),document.getElementById("destaque-objeto").getAttribute("data-default")?ajax("list","list_mblink","prm_objeto=&prm_usuario="+e+"&prm_order=1&prm_dir=",!0,"ajax"):carrega("blink?prm_objeto="+t+"&prm_visao="+document.getElementById("destaque-visao").title+"&prm_order=1&prm_dir=")):alerta("feed-fixo",TR_ER)}):alerta("feed-fixo",TR_TC)}function clickStart(e){var t=e.target;if("call-menu"==t.id){document.getElementById("attriblist").innerHTML="",attReopen(function(){call("show_screen","prm_screen="+tela+"&prm_tipo=MENU").then(function(e){let t=document.createElement("div");t.classList.add("itens"),t.innerHTML=e,document.getElementById("attriblist").appendChild(t)}).then(function(){addLink(),call("closer_menu").then(function(e){let t=document.createElement("div");t.innerHTML=e,document.getElementById("attriblist").appendChild(t.children[0])})})},"attriblist")}if("favoritos"==t.id){attReopen(function(){ajax("list","favoritos","prm_screen="+tela,"false","attriblist")},"attriblist")}if("config"==t.id){attReopen(function(){ajax("list","list_vconteudo","prm_usuario=",!1,"attriblist")},"attriblist")}if("float-filter"==t.id){if("mobile"==PRINCP.className)var n="floatlist";else{n="floatlist";if(document.getElementById(n).classList.contains("open"))return void document.getElementById(n).querySelector(".closer").click()}attReopen(function(){ajax("list","get_float","prm_screen="+tela,!1,n)},n)}if(t.classList.contains("closer")){document.querySelector(".optionbox")&&document.querySelector(".optionbox").remove(),document.querySelector(".destacada")&&document.querySelector(".destacada").classList.remove("destacada");var a=t.parentNode;if("get_float"==t.previousElementSibling.id&&"T"==document.getElementById("get_float").getAttribute("data-alterado")&&shscr(tela),"attriblist"==a.id&&document.getElementById("fakelist").classList.contains("visible")?(document.getElementById("fakelist").classList.remove("visible"),setTimeout(function(){document.getElementById("fakelist").innerHTML="",a.classList.remove("open")},400),setTimeout(function(){a.innerHTML=""},600)):(a.classList.remove("open"),document.getElementById("fakelist").classList.remove("visible"),setTimeout(function(){var e=a.querySelector(".closer").cloneNode(!0);a.innerHTML="",a.appendChild(e)},210)),document.querySelector(".itens")&&"T"==document.querySelector(".itens").getAttribute("data-alterado"))if(document.querySelector(".itens").getAttribute("data-obj")){var r=document.querySelector(".itens").getAttribute("data-obj");document.getElementById(r)&&(document.getElementById(r+"sync")?document.getElementById(r+"sync").click():shscr(tela))}else shscr(tela)}if(t.classList.contains("reorder")){r=t.parentNode.parentNode.id.replace("sdrill_","").replace("trl","");var o=document.getElementById("selecteddata").getAttribute("data-i");document.getElementById(r+o+"h").click()}if(t.classList.contains("f_addcoluna")&&add_coluna(t.getAttribute("data-template")),!t.classList.contains("arrowline")||t.classList.contains("firstline")||t.parentNode.classList.contains("firstline")||(document.querySelector(".arrowline.selected")&&document.querySelector(".arrowline.selected").classList.remove("selected"),t.classList.add("selected")),t.parentNode.classList.contains("custom")&&t.classList.contains("search")){var l=t.parentNode.parentNode.parentNode;r=t.parentNode.parentNode.parentNode;if(l.previousElementSibling&&l.previousElementSibling.classList.contains("script")&&!t.classList.contains("noscript")&&l.previousElementSibling.click(),r.classList.contains("multi"))var i="S";else i="N";fakeboxevent(r.id,r.getAttribute("data-opcao"),r.title,i,t.parentNode.parentNode.parentNode.getAttribute("data-visao"),r.getAttribute("data-adicional"),r,r.children[0].getAttribute("data-fixed").length,t.previousElementSibling.value,r.getAttribute("data-reverse"))}if(t.classList.contains("add")){let e=t.parentNode.parentNode.parentNode,n=t.previousElementSibling.value;e.classList.contains("multi");0==e.children[0].getAttribute("data-fixed").length&&(e.children[0].innerHTML=n),e.title=n}if(t.parentNode.classList.contains("custom")&&t.previousElementSibling){l=t.parentNode.parentNode.parentNode;var d=t.previousElementSibling.value;l.setAttribute("data-ant",d),l.click()}if((t.classList.contains("fakeoption")||t.parentNode.classList.contains("fakeoption"))&&!t.classList.contains("fakelistbox")){t.parentNode.classList.contains("fakeoption")&&(t=e.target.parentNode);i="N";if(t.classList.contains("multi")&&(i="S"),!e.target.classList.contains("noprop")){if(t.children[0].setAttribute("data-custom","N"),(s=t.getAttribute("data-adicional")).length>0&&document.getElementById(s)&&!document.getElementById(s).classList.contains("dragme")&&!document.getElementById(s).classList.contains("fakeoption"))var s=document.getElementById(s).title;fakeListBox(t.id,t.getAttribute("data-opcao"),t.title,i,t.getAttribute("data-visao"),s,t.getAttribute("data-reverse"),e,t.getAttribute("data-custom"))}}if(t.classList.contains("checkbox")){var c=t.parentNode.parentNode.parentNode.parentNode.getAttribute("data-obj");document.getElementById(c)||document.getElementById(c+"trl")&&(c+="trl"),t.classList.contains("checked")?(t.classList.remove("checked"),t.title=t.getAttribute("data-negative")):(t.classList.add("checked"),t.title=t.getAttribute("data-positive")),t.previousElementSibling&&t.previousElementSibling.classList.contains("script")&&t.previousElementSibling.click()}if(t.classList.contains("sync")){var m=t.parentNode.id;if("main"==(a=t.parentNode.parentNode.id))var u="&prm_dashboard=false",p="";else{dashlocation=a;u="&prm_dashboard=true",p=window.getComputedStyle(t.parentNode).getPropertyValue("order")}t.parentNode.remove(),appendar("prm_drill=N&prm_objeto="+m+"&PRM_ZINDEX=&prm_posx="+p+"&prm_posy=&prm_screen="+tela+u,!1,a)}if(t.classList.contains("addpurple")&&t.getAttribute("data-req")){var g=t.getAttribute("data-req"),f=t.getAttribute("data-par").split("|"),v=t.getAttribute("data-res"),y="",h=t.getAttribute("data-sup"),_="content",b=t.getAttribute("data-load"),E=t.getAttribute("data-msg")||TR_AD,I=t.getAttribute("data-pkg")||"FCL",x=[],B=[],L=0;for(let e=0;e<f.length;e++){let t=document.getElementById(f[e]),n="";n="SPAN"==t.tagName?t.title:t.value,t.getAttribute("data-min")&&n.length<parseFloat(t.getAttribute("data-min"))&&(t.classList.add("errorinput"),L+=1),"S"==t.getAttribute("data-encode")?x.push(f[e]+"="+encodeURIComponent(n)):x.push(f[e]+"="+n)}if(t.getAttribute("data-res-par")){y=t.getAttribute("data-res-par").split("|");for(let e=0;e<y.length;e++){let t=document.getElementById(y[e]),n="";n="SPAN"==t.tagName?t.title.split("|")[0]:t.value.split("|")[0],B.push(y[e]+"="+n)}}t.getAttribute("data-res-tar")&&(_=t.getAttribute("data-res-tar")),t.getAttribute("data-save")&&-1==window[t.getAttribute("data-save")].indexOf(x.join("&"))&&window[t.getAttribute("data-save")].push(x.join("&")),0==L?(b&&document.getElementById(b).classList.add("loading"),call(g,x.join("&"),I).then(function(e){if(-1==e.indexOf("FAIL")){if(alerta("feed-fixo",E),v?ajax("list",v,B.join("&"),!1,_,"","",I):document.getElementById(_).innerHTML=e,t.getAttribute("data-children")){var n=t.getAttribute("data-children");n.length>0&&fakeReset(n.split("|"))}h&&call("menu","prm_menu="+h).then(function(e){document.getElementById("painel").innerHTML=e})}else alerta("feed-fixo",TR_ER,e.replace("FAIL",""));b&&document.getElementById(b).classList.remove("loading")})):alerta("feed-fixo",TR_TC)}t.getAttribute("data-reload")&&reload(t.getAttribute("data-reload"))}function add_coluna(e){var t=document.getElementById("add_coluna").value;if(new RegExp("^[a-zA-Z0-9_]+$").test(t))if(t.trim().length>1){var n=document.getElementById("micro-visao").title;0!=n.trim().length?call("savecolumn","p_cd_coluna="+t+"&p_visao="+n+"&prm_template="+e).then(function(e){if(-1==e.indexOf("existe")&&-1==e.indexOf("Erro")){alerta("feed-fixo",TR_AD),document.getElementById("content").value="";let e=get("painel-colunas").getAttribute("data-colunas");call("load_crocks","prm_visao="+document.getElementById("telasup").getAttribute("data-visao")+"&prm_valores="+e).then(function(e){document.getElementById("painel-colunas").innerHTML=e}).then(function(){smoothScroll2("container-colunas",t.toUpperCase()+"id"),document.getElementById(t.toUpperCase()+"id").click(),document.getElementById("add_coluna").value=""})}else alerta("feed-fixo",e)}):alerta("msg",TR_ES_VW)}else alerta("msg",TR_NM_LE);else alerta("msg",TR_VI)}function edit_view(){ace_editor.setValue("");var e=document.getElementById("painel").querySelector(".fakelistbox").querySelectorAll(".opt"),t=[];for(let n=0;n<e.length;n++)t.push(e[n].title);var n,a=document.getElementById("view_list").title;if(n=-1==t.indexOf(a),document.getElementById("sandbox").contentWindow.document.body.innerHTML='<form id="zebra" name="zebra" method="post" action="dwu.fcl.passagem_test"><input id="nome" type="hidden" name="nome" value="'+a+'" /><input id="parsecheck" name="parseonly" type="hidden" value="N"/></form>',!n){document.getElementById("sandbox").contentWindow.document.getElementById("nome").value=document.getElementById("view_list").title;for(let e=0;e<21;e++)ajax("slice","load_dado","prm_nome="+a+"&prm_tipo=view&prm_time="+e,"false","slice",e)}}function openText(){document.getElementById("text-talk").setAttribute("data-objeto",""),document.getElementById("text-talk").setAttribute("data-line",""),"open"==document.getElementById("text-talk").className&&clearInterval(textTalk),document.getElementById("text-talk").classList.toggle("open"),get("campo").innerHTML="",call("listContainer","").then(function(e){document.querySelector(".list_container").innerHTML=e})}function closeSideBar(e){document.getElementById("text-talk")&&"text-talk"!=e&&document.getElementById("text-talk").classList.remove("open"),document.getElementById("obs-field")&&"obs-field"!=e&&document.getElementById("obs-field").classList.remove("open"),document.getElementById("perfil")&&"perfil"!=e&&document.getElementById("perfil").classList.remove("open"),document.getElementById("popupmenu")&&"popupmenu"!=e&&(document.getElementById("popupmenu").classList.remove("visible"),document.getElementById("popupmenu").innerHTML=""),document.getElementById("prefdrop")&&"prefdrop"!=e&&document.getElementById("prefdrop").classList.remove("hover"),document.getElementById("attriblist")&&"attriblist"!=e&&(document.getElementById("attriblist").classList.remove("open"),document.getElementById("attriblist").innerHTML=""),document.getElementById("floatlist")&&"floatlist"!=e&&(document.getElementById("floatlist").classList.remove("open"),document.getElementById("floatlist").innerHTML="")}function excluirModelo(){call("excluir_modelo","prm_modelo="+document.getElementById("import-tabela-ut").value,"imp").then(function(e){-1==e.indexOf("FAIL")?(alerta("mensagem",TR_EX),call("main","prm_modelo=","imp").then(function(e){document.getElementById("content").innerHTML=e})):alerta("mensagem",e.replace("FAIL",""))})}function addVarconteudo(){var e=document.getElementById("valor").value,t=document.getElementById("filtro-usuario").title;e.trim().length<1?alerta("msg",TR_NM_LE1):t.length<3?alerta("msg",TR_EU):call("add_vconteudo","prm_variavel="+e+"&prm_usuario="+t+"&prm_lock="+document.getElementById("locked").value).then(function(e){-1!=e.indexOf("OK")?(alerta("feed-fixo",TR_AD),document.getElementById("valor").value="",call("list_vconteudo","prm_usuario="+t+"&prm_todo=N").then(function(e){document.getElementById("conf_ajax").innerHTML=e})):alerta("feed-fixo",TR_ER)})}function addObjeto(){checkError();var e=document.getElementById("nome").value.trim();if(e.length<4)alerta("msg",TR_NM_LE);else if(""!=document.getElementById("fake_grupo").title){var t=document.getElementById("tipo").title;if(t.length>0){var n="";"BROWSER"!=t&&"CONSULTA"!=t||(n=document.getElementById("lista-tabelas").title),("BROWSER"==t&&n.length>0||"BROWSER"!=t)&&call("save_obj","prm_nome="+encodeURIComponent(e)+"&prm_atributo=dwu.fcl.download?arquivo="+document.getElementById("fake_img").title+"&prm_grupo="+document.getElementById("fake_grupo").title+"&prm_tipo="+t+"&prm_visao="+n).then(function(e){-1!=e.indexOf("FAIL")?alerta("feed-fixo",TR_ER):-1!=e.indexOf("ERROCOLUNA")?alerta("feed-fixo",TR_ER):alerta("feed-fixo",TR_AD),ajax("list","list_objetos","prm_tipo="+t+"&prm_screen="+tela,!1,"ajax"),document.getElementById("tipo-objeto").value=t,carregaPainel("objetos")}),"SCREEN"==t&&ajax("list","screen_list","",!0,"floatops")}}else alerta("msg",TR_ES_GR)}function enviodecampos(e){var t=document.getElementById("boxnome").value.trim(),n=document.getElementById("boxemail").value.trim(),a=document.getElementById("boxcelular").value.trim(),r=[],o=document.getElementById("checkcell"),l=document.getElementById("checkemail");o.checked&&r.push("celular"),l.checked&&r.push("email"),r=r.join("|"),"enviar"==e&&(t.length>2&&n.length>5&&a.length>=8?call("userinfo","prm_nome="+t+"&prm_email="+n+"&prm_cell="+a+"&prm_notificacao="+r).then(function(e){document.getElementById("content").innerHTML=e,alerta("feed-fixo",TR_CA),document.getElementById("boxnome").value="",document.getElementById("boxemail").value="",document.getElementById("boxcelular").value="",document.getElementById("blockpage").classList.add("invisible")}):(0!=t.length&&0!=n.length&&0!=a.length||alerta("feed-fixo",TR_TC),t.length<=3&&0!=t.length&&alerta("feed-fixo",TR_NM_LE),n.length<=5&&0!=n.length&&alerta("feed-fixo","Email inválido."),a.length<8&&0!=a.length&&alerta("feed-fixo","Número de celular deve conter 8 ou mais caracteres.")))}function setMicroAgrupador(){document.getElementById("micro-agrupador")&&(document.getElementById("micro-agrupador").title="",document.getElementById("micro-agrupador").children[0].innerHTML=document.getElementById("micro-agrupador").children[0].getAttribute("data-placeholder"))}function ver_logs(){document.getElementById("logs_recentes");call("exec_query","p_query="+encodeURIComponent("select dt_log as DATA, vl_query as QUERY, ds_log as STATUS from BI_LOG_QUERY")+"&p_parse=N&p_linhas=9999999").then(function(e){document.getElementById("queryresult").innerHTML=e,document.getElementById("queryresult2").innerHTML=e})}function save_usuario(){var e=encodeURIComponent(document.getElementById("senha1").value),t=document.getElementById("email").value,n=document.getElementById("number").value,a=document.getElementById("completo").value;call("save_pwd","prm_user="+USUARIO+"&prm_senha="+e+"&prm_email="+t+"&prm_number="+n+"&prm_nome="+a).then(function(t){-1==t.indexOf("#alert")?(curtain(),e.length>0?(alerta("feed-fixo",TR_AL),setTimeout(function(){window.location.reload(!0)},1e3)):alerta("feed-fixo",TR_AL)):alerta("feed-fixo",t.replace("#alert ",""))})}function attReopen(e,t){let n=document.getElementById(t);n.classList.contains("open")?(n.classList.remove("open"),setTimeout(function(){closeSideBar(t),n.innerHTML="",loader(t),setTimeout(function(){n.classList.add("open")},100),setTimeout(e,50)},100)):(loader(t),setTimeout(e,50),setTimeout(function(){n.classList.add("open")},100))}function templateMarcado(e,t,n){"green"==e.className?e.className="":e.className="green";var a=e.parentNode.querySelectorAll(".green"),r="";for(let e=0;e<a.length;e++)r=r+"|"+a[e].title;ajax("fly","template","prm_objeto="+t+"&prm_valor="+r+"&prm_view="+n,!1)}function movingArticle(e){e.stopPropagation(),document.querySelector(".movingarticle")&&document.querySelector(".movingarticle").classList.remove("movingarticle"),document.querySelector(".hoverchangearticle")&&document.querySelector(".hoverchangearticle").classList.remove("hoverchangearticle")}function getvalue(e){return e.classList.contains("fakeoption")?e.title:e.value}function getFileName(e){e.innerHTML="CARREGANDO ARQUIVO";var t=document.getElementById("painel").querySelector("iframe").contentWindow.document.body.children[0].children[0];t.setAttribute("data-arquivo",""),t.click(),uploadFile=setInterval(function(){if(t.getAttribute("data-arquivo").length>0){e.classList.add("loading");let n=t.getAttribute("data-arquivo").split("|");e.innerHTML=n[n.length-1].toUpperCase(),t.setAttribute("data-arquivo",""),e.classList.remove("loading"),clearInterval(uploadFile)}},100)}function passChange(e,t){e.value.trim().length>3?confirm(TR_CM)&&call("save_pwd","prm_senha="+encodeURIComponent(e.value)+"&prm_email=&prm_number=&prm_user="+t+"&prm_nome=").then(function(t){e.value="",t.indexOf(!1)?alerta("msg",TR_SA):alerta("msg",TR_ER_SE)}):alerta("msg",TR_SE_LE)}function montaCustom(){var e=[],t=document.getElementById("filtropipe"),n=document.getElementById("filtroc-coluna").title,a=document.getElementById("filtroc-condicao").title,r=document.getElementById("filtroc-valores").title;if(r.length>0&&n.length>0&&a.length>0){e.push(t.title),e.push(n+"|$["+a+"]"+r);var o=e.filter(e=>e).join("||");-1==t.title.indexOf(n+"|$["+a+"]"+r)?(t.title=o,fakeReset(["filtroc-valores"]),document.getElementById("gerar-custom").click()):alerta("fix","Filtro ja existe!")}}function removeCustomFiltro(e){if(confirm(TR_CE)){var t=document.getElementById("filtropipe");t.title=t.title.split("||").filter(function(t){if(t!=e.title)return t}).join("||"),document.getElementById("gerar-custom").click()}}function requestDefault(e,t,n,a,r){return(!n.hasAttribute("data-default")||a!=n.getAttribute("data-default"))&&((!n.previousElementSibling||!n.previousElementSibling.classList.contains("default")||n.previousElementSibling.innerHTML!=a)&&void call(e,t,"COM").then(function(e){-1!=e.indexOf("ok")?(alerta("",TR_AL),n.hasAttribute("data-default")&&(n.setAttribute("data-default",a),r&&(r.innerHTML=a)),n.previousElementSibling&&n.previousElementSibling.classList.contains("default")&&(n.previousElementSibling.innerHTML=a,r&&(r.innerHTML=a))):alerta("",TR_ER)}))}function pellLaunch(e){document.getElementById("pell-editor"+e).children[0]||pell.init({element:document.getElementById("pell-editor"+e),onChange:t=>{document.getElementById("modal-output"+e).textContent=t},styleWithCSS:!0,actions:["bold",{name:"italic",result:()=>pell.exec("italic")},"underline",{name:"center",icon:"center",title:"Justify Center",result:()=>pell.exec("justifyCenter")},{name:"left",icon:"left",title:"Justify Left",result:()=>pell.exec("justifyLeft")},{name:"size",icon:"size",title:"Font Size",result:()=>{const e=window.prompt("Digite o tamanho do texto de 1-7");e&&pell.exec("fontSize",e)}},{name:"link",result:()=>{const e=window.prompt("Enter the link URL");e&&pell.exec("createLink",e)}},{name:"image",result:()=>{const e=window.prompt("Enter the image URL");e&&pell.exec("insertImage",e)}}],classes:{size:"size"}})}function autoUpdate(e,t){var n=e.innerText;e.classList.toggle("loading"),e.innerText="VERIFICANDO";var a,r=t;-1!=PACKAGES.indexOf(t)&&(r="PACKAGES",a="prm_chave="+t),-1!=FILES.indexOf(t)&&(r="documentos",a="prm_chave="+t),call(r,a,"upd").then(function(t){e.classList.toggle("loading"),-1==t.indexOf("ERRO")?(alerta("feed-fixo",TR_AS),e.className="green ok",e.innerText="ATUALIZADO",e.setAttribute("onclick",""),e.parentNode.parentNode.children[1].innerHTML=t):(alerta("feed-fixo",t),e.innerText=n)})}function saveFloat(e,t){document.getElementById("get_float").setAttribute("data-alterado","T"),call("save_float","prm_conteudo="+encodeURIComponent(e)+"&prm_padrao="+t+"&prm_screen="+tela).then(function(e){-1==e.indexOf("FAIL")?alerta("feed-fixo",TR_AL):alerta("feed-fixo",TR_EX)})}function login2(e){var t=document.getElementById("login-menu"),n=t.querySelectorAll(".login-session")[0],a=t.querySelectorAll(".login-session")[1];if(t.className="loading",0==n.value.trim().length||0==a.value.trim().length)t.className="shake",alerta("x",TR_TC),a.value="",setTimeout(function(){t.className=""},300);else{let e=new Date;e.getSeconds(),parseInt(100*Math.random(1)),e.getMinutes(),parseInt(100*Math.random(1)),e.getHours(),parseInt(100*Math.random(1)),e.getDate();call("login","prm_user="+encodeURIComponent(n.value)+"&prm_password="+encodeURIComponent(a.value)+"&prm_session=&prm_prazo=0.5").then(function(e){-1!==e.indexOf("erro")||-1!==e.indexOf("sem acesso")?(t.className="shake",a.value="",setTimeout(function(){t.className=""},300),-1!==e.indexOf("erro")?alerta("x",TR_US_IN):alerta("x",TR_SP)):(alerta("x",TR_LE),t.className="logged",setTimeout(function(){window.location.reload(!0)},500))})}}function recoverPassword(e){var t=document.getElementById("login-menu"),n=t.querySelectorAll(".login-session")[0],a=(t.querySelectorAll(".login-session")[1],"http://"+window.document.location.host+"/"+window.document.location.pathname.split("/")[1]+"/");n.value.length>0?call("newPassword","prm_usuario="+n.value+"&prm_url="+a).then(function(e){alerta("x",e)}):alerta("x",TR_IU)}function inputCustom(e,t,n,a,r){call("adicionaCustomizado","prm_custom="+a+"&"+n+"&prm_desc="+e+"&prm_grupo="+t).then(function(t){-1==t.indexOf("ok")?alerta("feed",t):(get(r.id.replace("more","")).children[0].innerHTML=e,alerta("feed",TR_AD),document.getElementById("lista-custom-fav").children[0].innerText=e)}),r.classList.remove("visible"),document.getElementById("custom-conteudo-new").classList.remove("open")}function restoreCustom(e){if(document.getElementById("custom-conteudo").innerHTML="",e.nextElementSibling.title.length>0){document.getElementById("content").classList.add("loading");let t=e.nextElementSibling.title.split("||")[0];call("geraCustomizado","prm_custom="+t+"&prm_tipo=url").then(function(e){let n=e.split("||")[0],a=n.split("&")[0].split("=")[1],r=n.split("&")[1].split("=")[1],o=n.split("&")[2].split("=")[1],l="";n.split("&")[3].split("=")[1]&&(l=n.split("&")[3].split("=")[1]);var i=n.split("&")[4].split("=")[1],d=n.split("&")[5].split("=")[1];let s;get("custom-conteudo-desc").value=d,get("prm_visao").title=a,get("prm_visao").children[0]?get("prm_visao").children[0].innerHTML=a:get("prm_visao").value=a,get("prm_coluna_agrup").title=r,get("prm_coluna_agrup").children[0].innerHTML=r.split("|").join(", "),get("prm_coluna_valor").title=o,get("prm_coluna_valor").children[0].innerHTML=o.split("|").join(", "),l.length>0&&(get("prm_coluna_pivot").title=l,get("prm_coluna_pivot").children[0].innerHTML=l.split("|").join(", ")),get("prm_coluna_tipo").title=i,s="ROLL"==i?"SIM":"N&Atilde;O",get("prm_coluna_tipo").children[0].innerHTML=s;let c="";e.split("||")[1]&&(c=e.split("||")[1],document.getElementById("filtropipe").title=c),call("geraCustomizado","prm_custom="+t+"&"+n+"&filtropipe="+c+"&prm_tipo=show").then(function(e){get("custom-conteudo").innerHTML=e,get("content").classList.remove("loading")})})}else get("painel").innerHTML="",call("menu","prm_menu=gerar&prm_default=","","GET").then(function(e){get("painel").innerHTML=e})}function eraseCustom(){get("custom-conteudo").innerHTML=""}function deleteCustom(){var e=get("lista-custom-fav","custom");call("deleteCustom","prm_custom="+e[0].split("||")[0]).then(function(t){-1!=t.indexOf("EXCLUIDO")?(alerta("feed","TR_EX"),e[1].click()):alerta("feed","TR_ER")})}function copyListBtn(e){document.querySelector(".optionbox")?document.querySelector(".optionbox").remove():call("copiarPermissaoBox","prm_usuario="+e).then(function(e){let t=document.createElement("div");t.classList.add("optionbox"),t.classList.add("reverse"),t.innerHTML=e,t.style.setProperty("left",cursorx+20+"px"),t.style.setProperty("top",cursory+10+"px"),MAIN.appendChild(t),setTimeout(function(){t.classList.add("open")},100)})}function copyUserBtn(e){if(get("fake-copiar-permissao").title.length>0){var t=get("regras").value,n=TR_CA_US;"deletar"==t&&(n=TR_LR_US),confirm(n)&&call("copiarPermissao","prm_usuario="+e+"&prm_usuario_cop="+get("fake-copiar-permissao").title+"&prm_status="+t).then(function(e){-1==e.indexOf("ok")?alerta("feed-fixo",TR_ER):alerta("feed-fixo",TR_AL),document.querySelector(".optionbox").remove()})}else alerta("feed-fixo",TR_TC)}function blockOptions(e){update_prop(get("ident").value,"tipo",e.value),get("attriblist").children[0].setAttribute("data-alterado","T"),"PIZZA"==e.value||"MAPA"==e.value?get("coluna-sec").parentNode.parentNode.classList.add("invisible"):"PONTEIRO"==e.value?(get("micro-coluna").parentNode.parentNode.classList.add("invisible"),get("coluna-sec").parentNode.parentNode.classList.add("invisible")):(get("coluna-sec").parentNode.parentNode.classList.remove("invisible"),get("micro-coluna").parentNode.parentNode.classList.remove("invisible"))}function attribList(e){var t=get("attriblist");(event.offsetX<367&&event.offsetX>339||window.innerWidth<500&&window.matchMedia("(orientation: portrait)").matches&&event.offsetX<221&&event.offsetX>193)&&"visible"!=document.getElementById("fakelist").className&&(parseInt(get("fakelist").style.getPropertyValue("left"))>0&&(get("fakelist").style.setProperty("left","0"),document.querySelector(".itens").innerHTML=""),t.children[0].children[0]&&"T"==t.children[0].getAttribute("data-alterado")&&(t.classList.remove("open"),get(e)&&get(e+"sync")?get(e+"sync").click():shscr(tela),t.children[0].setAttribute("data-alterado","F")),t.className="",setTimeout(function(){t.innerHTML=""},500))}function createUser(){var e=get("nome").value,t=get("login").value,n=get("senha").value,a=get("email").value,r=get("email_usuario").value,o=get("usuario-grupo").title,l=get("fake-permissao").title;e.length<1?alerta("msg",TR_NM_LE1):t.trim().length<3?alerta("msg",TR_LO_LE):n.trim().length<3?alerta("msg",TR_SE_LE):(get("scroll").classList.add("saving"),new RegExp("^[a-zA-Z0-9.]+$").test(t)?a.length>0?call("save_user","prm_nome="+t+"&prm_completo="+e+"&prm_status=&prm_email="+r+"&prm_senha="+n+"&prm_permissao="+l+"&prm_grupo="+o).then(function(e){-1==e.indexOf("FAIL")?(alerta("feed-fixo",TR_CR),get("scroll").classList.remove("saving"),ajax("list","list_users","",!1,"content"),carregaPainel("usuarios")):(get("scroll").classList.remove("saving"),alerta("feed-fixo",e.replace("FAIL ","")))}):noerror("",TR_EI,"msg"):alerta("msg",TR_LO_LI))}function screenObs(){document.getElementById("obs-field").innerHTML=get("tela-atual").children[1].getAttribute("data-obs"),document.getElementById("obs-field").classList.toggle("open")}function objObs(e){if(document.querySelector(".optionbox"))document.querySelector(".optionbox").remove();else{let a=document.createElement("div");a.classList.add("optionbox"),a.classList.add("obsbox"),a.innerHTML=e;var t=cursorx+16;t+360>document.body.clientWidth&&(t=document.body.clientWidth-242);var n=parseInt(event.clientY);a.style.setProperty("left",t+"px"),a.style.setProperty("top",12+n+"px"),MAIN.appendChild(a),setTimeout(function(){a.classList.add("open"),a.addEventListener("mouseleave",function(){document.querySelector(".optionbox.obsbox.open").classList.remove("open"),setTimeout(function(){document.querySelector(".optionbox.obsbox").remove()},200)})},100)}}function importEditColumn(e,t){if(e.value!=e.getAttribute("data-default")){var n=e.parentNode.parentNode.querySelectorAll("input, select"),a=n[0].value,r=n[1].value,o=n[2].value,l=n[3].value,i=n[4].value,d=n[5].value,s=n[6].value;e.setAttribute("data-default",e.value),call("import_change","prm_modelo="+t+"&prm_numero="+r+"&prm_nome="+a+"&prm_destino=&prm_tipo="+o+"&prm_trfs="+l+"&prm_replacein="+i+"&prm_replaceout="+d+"&prm_mascara="+s+"&prm_op=UPDATE","imp").then(function(e){-1==e.indexOf("FAIL")&&(alerta("feed-fixo",TR_AL),call("main","prm_modelo="+t,"imp").then(function(e){document.getElementById("content").innerHTML=e}))})}}function importGenerateData(e){e.classList.add("loading"),e.innerHTML="IMPORTANDO DADOS",call("import_test","prm_arquivo="+document.getElementById("import-arquivo-ut").title.replace("dwu.fcl.download?arquivo=","").replace(".xlsx","")+"&prm_tabela="+document.getElementById("import-tabela-ut").value+"&prm_cabecalho="+document.getElementById("import-cabecalho-ut").value+"&prm_acao="+document.getElementById("import-acao-ut").value,"imp").then(function(t){e.classList.remove("loading"),e.innerHTML="IMPORTAR DADOS",-1==t.indexOf("FAIL")?alerta("feed-fixo","Gerado com sucesso!"):alerta("feed-fixo",t.replace("FAIL"," "))})}function importAddModel(){call("import_cabecalho","prm_modelo="+get("import-modelo").value+"&prm_arquivo="+get("import-arquivo").title.replace("dwu.fcl.download?arquivo=","").replace(".xlsx","")+"&prm_tabela="+get("visao_tabela").title+"&prm_cabecalho=0&prm_acao="+get("import-acao").value,"imp").then(function(e){-1==e.indexOf("FAIL")?(alerta("feed-fixo",TR_AD),call("main","prm_modelo="+get("import-modelo").value,"imp").then(function(e){get("content").innerHTML=e,carregaPainel("import&prm_default=")})):alerta("feed-fixo",TR_ER)})}function get(...e){var t=[];for(let n in e)t.push(document.getElementById(e[n]));return 0!=(t=t.filter(e=>e)).length&&(t.length>1?t:t[0])}function getAttributes(e,t,n){var a=document.querySelectorAll(e),r=[];for(let e=0;e<a.length;e++)a[e].getAttribute(t)&&r.push(a[e].getAttribute(t));return n?r.join(n):r}function resizeObj(e,t,n){if("height"==n)var a=20;else a=0;var r=parseInt(e.value.replace("px",""))+a,o=document.getElementById("ctnr_"+t)||document.getElementById(t+"dv2")||document.getElementById(t+"_gr");"height"==n&&(o.parentNode.style.setProperty(n,r+"px"),o.style.setProperty(n,r+"px")),"height"==n&&o.style.setProperty("max-height",r+"px"),"width"==n&&o.style.setProperty(n,r+"px"),renderChart(t)}function browserQuickEdit(e,t,n,a,r){if(e.value!=e.getAttribute("data-d")){e.nextElementSibling.classList.add("loading"),e.classList.add("readonly");var o=document.getElementById("data_list").className,l=e.value,i=e.getAttribute("data-d");switch(r){case"number":l=l.replace(/\./g,"").replace(",","."),i=i.replace(/./g,"").replace(",",".")}call("browserEditLine","prm_tabela="+n+"&prm_chave="+getAttributes("#"+t+" .chave","data-d","|")+"&prm_campo="+getAttributes("#"+t+" .chave","data-n","|")+"&prm_nome="+a+"&prm_conteudo="+l+"&prm_ant="+i+"&prm_tipo="+r+"&prm_obj="+o,"bro").then(function(t){e.nextElementSibling.classList.remove("loading"),e.nextElementSibling.classList.add("ok"),alerta("feed-fixo",TR_AL),e.setAttribute("data-default",e.value),setTimeout(function(){e.classList.remove("readonly"),e.nextElementSibling.classList.remove("ok")},2e3)})}}beta.browser={acumulado:!1},document.addEventListener("keyup",function(e){var t=e.target;if(t.parentNode.classList.contains("search")){var n=t.parentNode.parentNode.parentNode;fakeboxevent(n.id,n.getAttribute("data-opcao"),n.title,"N",n.getAttribute("data-visao"),n.getAttribute("data-reverse"),n,n.children[0].getAttribute("data-fixed").length,t.value,"")}t.parentNode.classList.contains("custom")&&13==e.which&&t.nextElementSibling.click(),t.classList.contains("errorinput")&&(t.getAttribute("data-min")?t.value.length>=parseFloat(t.getAttribute("data-min"))&&t.classList.remove("errorinput"):t.classList.remove("errorinput"))}),document.addEventListener("change",function(e){var t=e.target;if(t.parentNode.classList.contains("columnline")&&t.classList.contains("listener")&&t.value!=t.getAttribute("data-default")){var n=document.getElementById("micro-visao").title,a=document.getElementById("ajax-lista").querySelector(".selected").title,r=t.parentNode,o=encodeURIComponent(t.value);"S"!=t.getAttribute("data-search")&&call("save_column","prm_visao="+n+"&prm_name="+a+"&prm_campo="+r.getAttribute("data-campo")+"&prm_valor="+o).then(function(e){-1==e.indexOf("#alert")?(alerta("feed-fixo",e),t.setAttribute("data-default",t.value)):alerta("feed-fixo",TR_ER)})}if(t.classList.contains("user-password")){var l=t.parentNode.parentNode.id.replace("linha","");t.value.trim().length>3?confirm(TR_CM)&&(ajax("fly","save_pwd","prm_senha="+encodeURIComponent(t.value)+"&prm_senha2="+encodeURIComponent(t.value)+"&prm_email=&prm_number=&prm_user="+l+"&prm_nome="),t.value=""):alerta("msg",TR_SE_LE)}if(t.classList.contains("vsis-input")){var i=(l=t.parentNode.parentNode).getAttribute("data-default"),d=l.getAttribute("data-usuario");t.value!=i&&call("edit_vconteudo","prm_variavel="+encodeURIComponent(l.title)+"&prm_conteudo="+encodeURIComponent(t.value)+"&prm_usuario="+d).then(function(e){-1==e.indexOf("#alert")?(alerta("","Valor alterado com sucesso!"),l.setAttribute("data-default",t.value)):alerta("",e.replace("#alert ",""))})}}),document.addEventListener("change",function(e){"data-coluna"==e.target.id&&("ligacao"==e.target.options[e.target.selectedIndex].getAttribute("data-tipo")?(document.getElementById("data_list").children[1].classList.add("ligacao"),document.getElementById("browser-condicao").nextElementSibling.id=e.target.value):("nulo"!=document.getElementById("browser-condicao").value&&"nnulo"!=document.getElementById("browser-condicao").value&&document.getElementById("data_list").children[1].classList.add("ligacao"),document.getElementById("data_list").children[1].classList.remove("ligacao")))}),document.addEventListener("keypress",function(e){var t=e.which,n=e.target;return"boxemail"==n.id?-1!="abcdefghijklmnopqrstuvwxyzçABCDEFGHIJKLMNOPQRSTUVWXYZÇ@._1234567890".indexOf(String.fromCharCode(t))||(e.preventDefault(),!1):"boxcelular"==n.id?(VMasker(document.getElementById("boxcelular")).maskPattern("(99) 999999999999"),n.value.length>17?(e.preventDefault(),!1):-1!="1234567890".indexOf(String.fromCharCode(t))||(e.preventDefault(),!1)):void 0}),document.addEventListener("click",function(e){var t=e.target,n=t.parentNode.parentNode;if(t.classList.contains("remove")){var a=t.getAttribute("data-require"),r=t.getAttribute("data-param"),o=t.getAttribute("data-valor"),l=t.getAttribute("data-decode"),i=t.getAttribute("data-objeto"),d=t.getAttribute("data-pkg")||"FCL";if(document.getElementById(i)){if("ARTICLE"==document.getElementById(i).parentNode.tagName)var s=document.getElementById(i).parentNode.id;else s=tela;p="prm_cod="+i+"&prm_tela="+s}else{var c=r.split("|"),m=o.split("|"),u=[];for(let e=0;e<c.length;e++){l==e?u.push(c[e]+"="+encodeURIComponent(m[e])):u.push(c[e]+"="+m[e]);var p=u.join("&")}}confirm(TR_CE)&&(n.classList.add("removing"),call(a,p,d).then(function(e){if(-1==e.indexOf("FAIL"))if(alerta("feed-fixo",TR_EX),"LI"==t.parentNode.tagName)t.parentNode.remove();else if("DIV"==t.parentNode.tagName&&"content"==t.parentNode.id){var a=document.getElementById("micro-visao").title;document.getElementById("content").innerHTML="",ajax("list","load_crocks","prm_visao="+a+"&prm_completo=N","true","ajax-lista")}else if(document.getElementById("custom-conteudo")){let e=document.getElementById("lista-custom-fav");e.title="",e.children[0].innerHTML="NOVA CONSULTA",restoreCustom(e.previousElementSibling)}else n.remove(),document.getElementById(i)&&document.getElementById(i).remove();else n.classList.remove("removing"),document.getElementById(i)&&document.getElementById(i).classList.remove("removing")}))}});var fakescrollm=0;function createFakescroll(e){var t;e.querySelector(".fakescroll")?t=e.querySelector(".fakescroll"):((t=document.createElement("span")).className="fakescroll",e.appendChild(t));var n=100*e.clientHeight/e.scrollHeight;e.parentNode.clientHeight,e.clientHeight,e.clientHeight,e.parentNode.clientHeight,e.parentNode.querySelector(".fakescroll").style,e.children[0].style;t.style.setProperty("height","calc("+n+"% - 5px)"),e.addEventListener("scroll",function(){var t=e.clientHeight/e.scrollHeight+1,n=e.clientHeight/document.body.clientHeight;document.querySelector(".fakescroll").style.setProperty("margin-top",this.scrollTop*t/n+"px")}),t.addEventListener("touchstart",function(e){e.stopPropagation(),fakescrollm=1}),t.addEventListener("mousedown",function(e){e.stopPropagation(),fakescrollm=1}),t.addEventListener("mouseup",function(e){e.stopPropagation(),fakescrollm=0}),t.addEventListener("mouseleave",function(e){e.stopPropagation(),fakescrollm=0}),t.addEventListener("mousemove",function(n){1==fakescrollm&&n.clientY<=e.scrollHeight-e.parentNode.offsetHeight+20&&(n.style.setProperty("margin-top","-"+2*n.layerY+"px"),t.style.setProperty("margin-top",2*n.layerY+"px"))})}barheight="";var fakeListCustom={},menu={usuarios:function(){let e=document.getElementById("painel"),t=document.createElement("h4");t.innerHTML="USUÁRIOS";let n=document.createElement("input");n.id="login",n.setAttribute("maxlength","40"),n.setAttribute("placeholder","login"),n.style.setProperty("text-transform","uppercase"),n.setAttribute("onkeypress","return input(event, 'login')");let a=document.createElement("input");a.id="nome",a.setAttribute("maxlength","60"),a.setAttribute("placeholder","NOME");let r=document.createElement("input");r.id="email_usuario",r.type="email",r.setAttribute("maxlength","60"),r.setAttribute("placeholder","E-MAIL"),r.setAttribute("onkeypress","return input(event, 'email')");let o=document.createElement("input");o.id="senha",o.type="password",o.setAttribute("placeholder","PASSWORD");let l=document.createElement("a");l.classList.add("addpurple"),l.title="Novo usuário",l.innerHTML=TR_AU,l.setAttribute("onclick","var nome = document.getElementById('nome').value; var login = document.getElementById('login').value; var senha = document.getElementById('senha').value; var permissao = document.getElementById('fake-permissao').title; if(nome.length < 1){ alerta('msg', 'Campo nome de usuário em branco!'); } else { if(login.trim().length < 3){ alerta('msg', 'Campo login precisa ter mais de 3 caracteres!'); } else { if(senha.trim().length < 3){ alerta('msg', 'Campo senha precisa ter mais de 3 caracteres!'); } else { var regex = new RegExp('^[a-zA-Z0-9.]+$'); if(regex.test(login)){ if(document.getElementById('email').value.length > 0){ call('save_user', 'prm_nome='+login+'&prm_completo='+nome+'&prm_status=&prm_email='+document.getElementById('email_usuario').value+'&prm_senha='+senha+'&prm_permissao='+permissao).then(function(resposta){ if(resposta.indexOf('FAIL') == -1){ alerta('feed-fixo', TR_CR); ajax('list', 'list_users', '', false, 'content'); carregaPainel('usuarios'); } else { alerta('feed-fixo', resposta.replace('FAIL ', '')); } }); } else { noerror('', TR_EI, 'msg'); } } else { alerta('msg', TR_LO_LI); } }}} "),e.appendChild(t),e.appendChild(n),e.appendChild(a),e.appendChild(r),e.appendChild(o),e.appendChild(l)}};

// Criado para chamar a icarrega atual comprimida e adicionando correção do drill das linhas de total (exclsusão de linhas inv) - 20/12/2021 - versão 1.5.6 já está com essa correção  
/*function icarrega () { 

  var x = document.querySelectorAll('.dragme.front');
  var xlength = x.length;

  for(divs=0;divs<xlength;divs++){ 

    if ( (x[divs].classList.contains('front')) && (get(x[divs].id+'c') != false) )  {

      if ( (get(x[divs].id+'c').querySelector('.geral') != null) ) { 
         var visiveis = get(x[divs].id+'c').querySelector('tbody').children[1].querySelectorAll('.fix').length-2;
         var invs = get(x[divs].id+'c').querySelector('.geral').querySelectorAll('td.inv');
         //+1 para o total
         var invsL = invs.length;
         for(let i=visiveis; i<invsL; i++){
           if(invs[i]){
             invs[i].remove();
           }
         }
      }   
    }
  }  

  icarrega2(this.id);

}*/

// teste do icarrega 

function icarrega() {
    var divs;
    var tabela = "";
    var x = document.querySelectorAll(".dragme.front");
    var xlength = x.length;
    for (divs = 0; divs < xlength; divs++) {
        
    if ( (x[divs].classList.contains('front')) && (get(x[divs].id+'c') != false) )  {

      if ( (get(x[divs].id+'c').querySelector('.geral') != null) ) { 
         var visiveis = get(x[divs].id+'c').querySelector('tbody').children[1].querySelectorAll('.fix').length-2;
         var invs = get(x[divs].id+'c').querySelector('.geral').querySelectorAll('td.inv');
         //+1 para o total
         var invsL = invs.length;
         for(let i=visiveis; i<invsL; i++){
           if(invs[i]){
             invs[i].remove();
           }
         }
      }   
    }

          tabela = x[divs].id;

          if(document.getElementById(tabela)){
            
           
              if(document.getElementById(tabela+'c')){
                var prints = document.getElementById(tabela+'c').querySelectorAll('.print');
                var printsl = prints.length;
                for(let p=0;p<printsl;p++){ 
                  prints[p].parentNode.setAttribute('style', prints[p].innerHTML); 
                }
              }						
           
            
              if(document.getElementById(tabela+'c')){
                var tabelac = document.getElementById(tabela+'c');
                tabelac.addEventListener('click', click_evento);
                tabelac.addEventListener('dblclick', dbl_click_evento);
                tabelac.addEventListener('mouseenter', function(){
                  imgurlOver(this.id);  
                });
              }
            
          }
          topDistance(tabela);
    
          if(document.getElementById(tabela+'_ds')){
            var titulo = document.getElementById(tabela+'_ds');
            var titvalor = titulo.innerHTML;
            titulo.innerHTML = '_';
            titulo.innerHTML = titvalor;
          }
          if(typeof ajuste !== 'undefined'){
            if(ajuste.children[3]){
              var ajuste3 = ajuste.children[3].getElementsByTagName('td');
              var ajuste3l= ajuste3.length;
              for(let c=0;c<ajuste3l;c++){
                ajuste3[c].removeAttribute('id');
                ajuste3[c].removeAttribute('data-valor');
              }
      
              if(document.getElementById(tabela+'c')){ 
                document.getElementById(tabela+'c').addEventListener('click', click_evento);
                document.getElementById(tabela+'c').addEventListener('dblclick', dbl_click_evento);
                document.getElementById(tabela+'c').addEventListener('mouseleave', out_evento);
                document.getElementById(tabela+'c').addEventListener('dblclick', dbl_click_evento);
              }
          //if(document.getElementById(tabela+'fixed')){ document.getElementById(tabela+'fixed').addEventListener('click', click_evento); }
      
              smartScroll(tabela);
              if(document.getElementById(tabela+'c')){
                var prints = document.getElementById(tabela+'c').querySelectorAll('.print');
                var printslength = prints.length;
                for(let p=0;p<printslength;p++){ prints[p].parentNode.setAttribute('style', prints[p].innerHTML); }
              }
              var objleft = document.getElementById(tabela).getAttribute('data-left');
              var objtop = document.getElementById(tabela).getAttribute('data-top');
              //var refresh = document.getElementById(tabela).getAttribute('data-refresh');
          }}
    }
    if(!document.querySelector('.full')){
        dashAjuste();
    
        renderizaGraficos();
    
      } else {
        setTimeout(fullscreen, 100);
      }
    
      var geomapas = document.getElementsByClassName('dragme geomapa');
      for(let w=0;w<geomapas.length;w++){
        initMap(geomapas[w].id);
      }
    
      try{
        if(LAYER){
          if(LAYER.className == 'ativo'){ loading('x'); }
        }
      } catch (e){
        console.log('nolayer');
      }
    
    
}

// Criado para substituir a eventos atual comprimida e adicionando correção do drill das linhas de total (exclsusão de linhas inv) - 20/12/2021 - versão 1.5.6 já está com essa correção  
function eventos(obj){

  if(obj.classList.contains('relatorio')){
    clearInterval(timer_rel);
    var ident = obj.id.replace('trl', '');

    if(document.getElementById(ident+'_button').innerHTML.indexOf('EXECUTANDO') != -1){

      timer_rel = setInterval(function(){ 
        call('lista_rel', 'prm_objeto='+ident+'&prm_screen='+tela+'&prm_cod=&prm_lista=check', 'up_rel').then(function(resposta2){ 
          document.getElementById(ident+'_button').innerHTML = resposta2; 
          if(resposta2.indexOf('EXEC') == -1){ 
            clearInterval(timer_rel);
            setTimeout(function(){ 
              document.getElementById(ident+'_button').classList.remove('loading');
              alerta('feed-fixo', TR_RG); 
              call('lista_rel', 'prm_objeto='+ident+'&prm_screen='+tela+'&prm_cod='+ident+'&prm_lista=file', 'up_rel').then(function(resposta3){ 
                document.getElementById(ident+'_lista').innerHTML = resposta3; 
              });
            }, 1000); 
          }  
        });
      }, 1000);  
    }
  }

if(obj.querySelector('.wd_move')){
  var titulo = obj.querySelector('.wd_move');
  if(obj.id.indexOf('trl') != -1 || obj.id.indexOf('temp') != -1){
    titulo.addEventListener('mousedown', function(){ obj.style.setProperty('opacity', '0.7'); });
    titulo.addEventListener('mouseup', function(){ obj.style.setProperty('opacity', '1'); });
    titulo.addEventListener('touchstart', function(){ obj.style.setProperty('opacity', '0.7'); });
    titulo.addEventListener('touchend', function(){ obj.style.setProperty('opacity', '1'); });
  } else {
    titulo.addEventListener('mousedown', function(){ invisible_touch(this.parentNode.id, 'start'); });
    titulo.addEventListener('mouseup', function(){ invisible_touch(this.parentNode.id, 'stop'); });
    titulo.addEventListener('touchstart', function(){ invisible_touch(this.parentNode.id, 'start'); });
    titulo.addEventListener('touchend', function(){ invisible_touch(this.parentNode.id, 'stop'); });
  }
  
  titulo.addEventListener('dblclick', function(){
    curtain('');
    scale(this.id.replace('_ds', ''));
  });
}


  if( (obj.classList.contains('front')) && (get(obj.id+'c') != false) ){
    if ((get(obj.id+'c').querySelector('.geral') != null) ) {   
      var visiveis = get(obj.id+'c').querySelector('tbody').children[0].querySelectorAll('.fix:not(.print)').length-2;
      var invs = get(obj.id+'c').querySelector('.geral').querySelectorAll('td.inv');
      var invsL = invs.length;
      for(let i=visiveis; i<invsL; i++){
        if(invs[i]){
          invs[i].remove();
        }
      }
    }
  }   
}


function click_evento(e) {
  var t = this.id,
    n = e.target,
    a = document.getElementById(t).parentNode.parentNode.parentNode.className;
  if ("TABLE" != n.tagName && "TBODY" != n.tagName && n.getAttribute("colspan") < 2 && !n.parentNode.classList.contains("lc")) {
    if (t = t.substring(0, t.length - 1), -1 != n.className.indexOf("seta")) var r = 0;
    else r = parseInt(n.cellIndex);
    if (n.classList.contains("callmed")) {
      var o = get("dados_" + t).getAttribute("data-visao");
      medDrill(n, t, o)
    } else if ("TH" == n.tagName && -1 == a.indexOf("cross")) {
      var l, i = n.cellIndex,
        d = 0;
      l = n.parentNode.parentNode.querySelectorAll("th");
      var s = n.parentNode.querySelectorAll(".fix").length;
      n.parentNode.querySelector(".fix") || (d = n.parentNode.parentNode.querySelectorAll(".fix").length);
      var c = n;
      if (!n.className && n.parentNode.parentNode.children.length > 1 && (c = n.parentNode.parentNode.lastElementChild.children[i - s]), n.parentNode.parentNode.children.length < 5) {
        var m;
        m = -1 == c.className.indexOf("DESC") && -1 == c.className.indexOf("ASC") ? i + d + " ASC" : -1 != c.className.indexOf("ASC") ? i + d + " DESC" : (c.previousElementSibling, ""), c.className = m;
        var u = [];
        for (let e = 1; e < l.length; e++) l[e] && (u[e - 1] = l[e].className.replace(" fix", "").replace(" inv", "").replace("cen", "").replace("dir", "").replace("bld", "").trim());
        var p = encodeURIComponent(document.getElementById("par_" + t).value),
          g = document.getElementById(t).parentNode.id;
        remover("sdrill_" + t), remover("sdrill_" + t + "trl"), remover(t), remover(t + "trl");
        
        var f     = document.getElementById(t).offsetTop + "px",
            vleft = document.getElementById(t).offsetLeft + "px",
            y     = "N";

        var vordem     = window.getComputedStyle(document.getElementById(t)).getPropertyValue('order'),
            vdashorder = ''; 
        if(document.getElementById(t).parentNode.id == 'main') { 
          vdashorder = '&prm_dashboard=false'; 
        } else { 
          vdashorder = '&prm_dashboard=true'; 
        }

        if(document.getElementById(t).classList.contains('drill')){
          y      = 'Y';
          vordem = vleft;           // Se for Drill passa a posição left atual, para que a drill seja aberta na mesma posição atual - 14/02/2022
        }
        // document.getElementById(t).classList.contains("drill") && (y = "Y"), 
        call("alterorder", "prm_objeto=" + t.replace("trl", "") + "&prm_valor=" + u.filter(e => e).join(",")).then(function() {

          if(!document.getElementById(t.replace('trl', '')+'sync')){
            if(document.getElementById(t)){
              document.getElementById(t).remove();
              loading();
            }
          }
        }).then(function() {
          if(document.getElementById(t + "sync")){ 
              document.getElementById(t + "sync").click(); 
          } else { 
              appendar("prm_drill=" + y + "&prm_OBJeto=" + t.replace("trl", "") + "&prm_POsx=" + vordem + "&prm_zindex=5&prm_posy=" + f + "&prm_parametros=" + p + "&prm_screen=" + tela + vdashorder, !1, g);
          }    
        }).then(function() {
          centerDrill(t + "trl")
        })
      } else {
        o = get("dados_" + t).getAttribute("data-visao");
        medDrill(n, t, o), n.classList.toggle("tdselected")
      }
    }
    if (0 != r) {
      if (n.classList.contains("imgurl")) {
        document.getElementById("img_content") && document.getElementById("img_content").remove();
        var h = document.createElement("div");
        h.id = "img_content", h.className = "scaled";
        var _ = document.createElement("img");
        _.addEventListener("click", removeImage), document.getElementById("layer2").addEventListener("click", removeImage), _.style.setProperty("opacity", "0"), _.src = n.getAttribute("data-url"), _.addEventListener("error", function() {
          _.style.setProperty("display", "none")
        }), h.appendChild(_), document.getElementById("main").appendChild(h), setTimeout(function() {
          h.style.setProperty("left", "calc(50% - " + _.clientWidth / 2 + "px)"), h.style.setProperty("top", "60px"), h.style.setProperty("z-index", "900")
        }, 10), setTimeout(function() {
          _.style.setProperty("opacity", "1"), curtain("only")
        }, 50)
      } else if ("TH" != n.tagName) {
        document.getElementById("selecteddata") && (document.getElementById("selecteddata").id = ""), n.id = "selecteddata", document.getElementById("selectedline") && (document.getElementById("selectedline").id = ""), n.parentNode.id = "selectedline", document.getElementById("drill_obj").value = t.replace("trl", "");
        var b = n.parentNode.firstElementChild.getAttribute("data-valor"),
          E = n.parentNode.parentNode.firstElementChild.children[n.cellIndex],
          I = 0;
        n.parentNode.parentNode.parentNode.firstElementChild.children.length > 1 && (I = n.parentNode.parentNode.parentNode.firstElementChild.firstElementChild.querySelectorAll(".fix").length);
        var x = n.parentNode.parentNode.parentNode.firstElementChild.lastElementChild.children[n.cellIndex - I];
        if (E) {
          let a, r, o;
          n.classList.contains("fix") || (o = get(t + "c").children[0].lastElementChild.children[n.cellIndex - I].getAttribute("data-pivot")), "string" == typeof E.getAttribute("data-p") ? (a = x.getAttribute("data-valor"), r = b) : n.parentNode.firstElementChild.getAttribute("data-valor") && (x ? x.getAttribute("data-valor") ? (a = x.getAttribute("data-valor"), r = b) : r = b : r = "-1" != document.getElementById(t).className.indexOf("cross") ? b + "|" + E.innerHTML.trim() : b), check_tag(e, t, a, r, o, n)
        }
      }
    } else -1 != n.className.indexOf("seta") && changearrow(n)
  }
}



function toexcel2(obj) {
  var excel = document.createElement('a');
  excel.id = 'excel';
  MAIN.appendChild(excel);
  var uri = 'data:application/vnd.ms-excel;base64,';
  var template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><!--[if gte mso 9]><xml "encoding=utf-8"><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><div id="main"><table id="'+obj+'c">{table}</table></main></body></html>';
  var format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
  var table = document.getElementById(obj+'dv2');
  var virtualtable = document.createElement('table');
  virtualtable.innerHTML = table.innerHTML;
 
  var invisibles = virtualtable.querySelectorAll('.invisible');
  var invisiblelength = invisibles.length;
  for(let i=0;i<invisiblelength;i++){ 
    invisibles[i].parentNode.removeChild(invisibles[i]); 
  }

  if(document.getElementById(obj)){

    var styles = document.getElementById(obj).getElementsByTagName('style');
    var styleslength = styles.length;
  
    var styleHTML = '';
    for(let u=0;u<styleslength;u++){ 
      if(styles[u]){ 
        if(styles[u].innerHTML.indexOf('display: none;') != -1){ 
          styleHTML = styleHTML+styles[u].innerHTML; 
        } 
      }
    }
  
    var stylein = virtualtable.getElementsByTagName('tr');
    var styleinlength = stylein.length;
    for(let v=0;v<styleinlength;v++){ 

      if(stylein[v]){

        
        if(document.getElementById(obj).parentNode.id != 'custom-conteudo'){
          if(!stylein[v].children[0].hasAttribute('style') || stylein[v].children[0].getAttribute('colspan') > 1 || stylein[v].className.indexOf('nivel') != 0){
            if(!stylein[v].children[0].hasAttribute('data-ordem')){
              if(stylein[v].children[0].getAttribute('colspan') < 2){
                stylein[v].children[0].remove();
              } else {
                stylein[v].children[0].setAttribute('colspan', parseInt(stylein[v].children[0].getAttribute('colspan'))-1);
              }
            }
          }
        }

        if(stylein[v].classList.contains('total')){ 
          if(styleHTML.indexOf('li.total { display: none; }') != -1 || styleHTML.indexOf('tr.total { display: none; }') != -1 || stylein[v].classList.contains('st-S')){ 
            stylein[v].className = 'remove';  
          } 
        } else {
          
          if(stylein[v].classList.contains('total normal')){ 
            if(styleHTML.indexOf('li.total.normal { display: none; }') != -1 || styleHTML.indexOf('tr.total.normal { display: none; }') != -1){ 
              stylein[v].className = 'remove'; 
            } 
          } 
          
        }
      }
    }
  
  }
  
  var remover = virtualtable.querySelectorAll('.remove');
  var removerlength = remover.length;
  for(let r=0;r<removerlength;r++){
    remover[r].remove();
  }

  var headTags = virtualtable.getElementsByTagName('th');
  var headTagsLength = headTags.length;
  for(let h=headTagsLength-1;h >= 0; --h){ 
    if(headTags[h]){
      let elementoCorrente;
      elementoCorrente = document.getElementById(obj+'c').getElementsByTagName('th')[h+1];
      if(window.getComputedStyle(elementoCorrente).display == 'none'){
        headTags[h].remove();
      }
    }
  }

  var tags = virtualtable.getElementsByTagName('td');
  var tagslength = tags.length;

  for(let r=tagslength-1;r >= 0;--r){ 
    if(tags[r]){
      let elementoCorrente;
      elementoCorrente = document.getElementById(obj+'c').getElementsByTagName('td')[r]; 
      if(window.getComputedStyle(elementoCorrente).display == 'none'){
        tags[r].remove();
      } 
    } 
  }

  
  for(let a=0;a<tagslength-1;a++){ 
    if(tags[a]){

    
      if(tags[a].title.length > tags[a].innerHTML.length && (!tags[a].classList.contains('setadown') || !tags[a].classList.contains('seta'))){ 
        tags[a].innerHTML = tags[a].title; 
      } 
      
      if(tags[a].innerHTML.indexOf('background') != -1){ 
        tags[a].innerHTML = '';
      } 

      if(get('excel_mask_'+obj).value != 'S'){
        tags[a].innerHTML = tags[a].innerHTML.replace(/\./g, '');
      }

      tags[a].setAttribute('onclick', ''); 
      tags[a].removeAttribute('data-i'); 
      tags[a].removeAttribute('data-p'); 
      tags[a].removeAttribute('data-subquery'); 
      tags[a].removeAttribute('data-ordem'); 
      tags[a].removeAttribute('data-valor'); 
      if(tags[a].innerHTML.indexOf('!important') != -1){ 
        tags[a].parentNode.removeChild(tags[a]); 
      } 
    } 
  }

  for(let a=0;a<tagslength-1;a++){ 
    if(tags[a]){
      if(tags[a].classList.contains('setadown') || tags[a].classList.contains('seta')){
        tags[a].remove();
        continue;
      }
    }
  }

  var formatoExcel = 'HTML',
      dados        = document.getElementById('dados_'+ obj);
  if (dados) { 
    if (dados.getAttribute('data-formato_excel')) { 
      formatoExcel = dados.getAttribute('data-formato_excel').toUpperCase();
    }  
  }   


  if (formatoExcel.toUpperCase() == 'XLSX' ) {       // XLSX sem formatação 

    // Substitui o ',' por '.' e '%' por ''
    var tags = virtualtable.getElementsByTagName('td');
    var tagslength = tags.length;
  
    for(let r=tagslength-1;r >= 0;--r){ 
      if(tags[r]){
        tags[r].innerHTML = tags[r].innerHTML.replace(/\./g, '').replace(/\,/g, '.').replace(/\%/g,'');
      } 
    }

    try {
      var wb = XLSX.utils.book_new();                       // Cria um WorkBook em branco  
      var ws = XLSX.utils.table_to_sheet(virtualtable);     // Cria um worksheet a partir da tabela 
    } 
    catch (ReferenceError) {
      alerta('feed-fixo', 'N&atilde;o foi poss&iacute;vel localizar a fun&ccedil;&atilde;o de exporta&ccedil;&atilde;o de planilhas, entre em contato com o administrador do sistema'); 
    }  
  
    XLSX.utils.book_append_sheet(wb, ws, 'Planilha1');    // adiciona a worksheet na workbook
    XLSX.writeFile(wb, obj.substr(0, obj.length-1)+'.xlsx');   // Gera e faz o download do arquivo
    setTimeout(function(){
      MAIN.removeChild(excel);
    }, 1000);

  } else {  // HTML com formatação  

    var ctx = {worksheet: 'Consulta', table: virtualtable.innerHTML}
    if (navigator.msSaveBlob) { // IE10
      return navigator.msSaveBlob(new Blob([format(template, ctx)], {type: uri}), obj.substr(0, obj.length-1)+'.xls');
    } else {
      document.getElementById('excel').href = uri + window.btoa(unescape(encodeURIComponent(format(template, ctx).replace(/&amp;/g, 'E').replace(/&/g, 'E').replace(/onclick="" class="dir" data-p=""/g, '').replace(/´/g, ' ').replace(/onclick=""/g, '').replace(/class="setadown" data-subquery=""/g, ''))));

      document.getElementById('excel').download = obj.substr(0, obj.length-1)+'.xls';
      document.getElementById('excel').click();
      setTimeout(function(){
        MAIN.removeChild(excel);
      }, 1000);
    }
  }  
}





function browserToExcel(x) {
  var excel = document.createElement('a');
  excel.id = 'excel';
  main.appendChild(excel);
  var uri = 'data:application/vnd.ms-excel;base64,';
  var template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><!--[if gte mso 9]><xml "encoding=utf-8"><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>';
  var format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
  var table = document.getElementById(x+'dv2');
  var virtualtable = document.createElement('table');
  virtualtable.innerHTML = table.innerHTML;

  var invisibles = virtualtable.querySelectorAll('.invisible');
  var invisiblelength = invisibles.length;
  for(let i=0;i<invisiblelength;i++){ 
    invisibles[i].parentNode.removeChild(invisibles[i]); 
  }

  if(document.getElementById(x)){

    var nome = document.getElementById(x+'_ds').innerText;

    var styles = document.getElementById(x).getElementsByTagName('style');
    var styleslength = styles.length;
	
		var styleHTML = '';
    for(let u=0;u<styleslength;u++){ 
      if(styles[u]){ 
        if(styles[u].innerHTML.indexOf('display: none;') != -1){ 
          styleHTML = styleHTML+styles[u].innerHTML; 
        }  /*styles[u].parentNode.removeChild(styles[u]);*/ 
      }
    }
	
    var stylein = virtualtable.getElementsByTagName('tr');
    var styleinlength = stylein.length;
    for(let v=0;v<styleinlength;v++){ 
			//if(stylein[v].className == 'total'){ if(totalv == 'true'){ stylein[v].outerHTML = ''; } else { stylein[v].setAttribute('style', ''); } } else { stylein[v].setAttribute('style', '');} 
			if(stylein[v]){
        
        //corta primeiro item do tr
        if(!stylein[v].children[0].hasAttribute('style') || stylein[v].children[0].getAttribute('colspan') > 1 || stylein[v].className.indexOf('nivel') != 0){
          if(!stylein[v].children[0].hasAttribute('data-ordem')){
            if(stylein[v].children[0].getAttribute('colspan') < 2){
              stylein[v].children[0].remove();
            } else {
              stylein[v].children[0].setAttribute('colspan', parseInt(stylein[v].children[0].getAttribute('colspan'))-1);
            }
          }
        }

				if(stylein[v].classList.contains('total')){ 
					if(styleHTML.indexOf('li.total { display: none; }') != -1 || styleHTML.indexOf('tr.total { display: none; }') != -1 || stylein[v].classList.contains('st-S')){ 
						stylein[v].className = 'remove';  
					} /*else { 
						stylein[v].setAttribute('style', ''); 
					}*/
				} else {
					
					if(stylein[v].classList.contains('total normal')){ 
						if(styleHTML.indexOf('li.total.normal { display: none; }') != -1 || styleHTML.indexOf('tr.total.normal { display: none; }') != -1){ 
							stylein[v].className = 'remove'; 
						} /*else { 
							stylein[v].setAttribute('style', ''); 
						}*/
					} /*else {
						stylein[v].setAttribute('style', ''); 
					}*/
					
				}
			}
    }
	
	}
  
  var remover = virtualtable.querySelectorAll('.remove, .inv');
  var removerlength = remover.length;
  for(let r=0;r<removerlength;r++){
    remover[r].remove();
  }

  //virtualtable.getElementsByTagName('th')[0].remove();

  var tags = virtualtable.getElementsByTagName('td');
  var tagslength = tags.length;
  for(let a=0;a<tagslength-1;a++){ 
    if(tags[a]){

      /*if(tags[a].children[0]){ 
        if(tags[a].children[0].tagName == 'IMG'){
          tags[a].children[0].remove();
        } 
      }*/

      /*if(tags[a].classList.contains('setadown') || tags[a].classList.contains('seta')){
        tags[a].remove();
        continue;
      }*/

      if(tags[a].title.length > tags[a].innerHTML.length && (!tags[a].classList.contains('setadown') || !tags[a].classList.contains('seta'))){ 
        tags[a].innerHTML = tags[a].title; 
      }

      //if(tags[a].classList.contains('setadown')){ tags[a].remove(); }
      if(tags[a].innerHTML.indexOf('background') != -1){ 
        tags[a].innerHTML = '';
      }

      if(tags[a].innerHTML.indexOf('-') != -1 || tags[a].innerHTML.indexOf('.') != -1){
        tags[a].setAttribute('style', 'mso-number-format:\\@'); 
      } 

      tags[a].setAttribute('onclick', ''); 
      tags[a].removeAttribute('data-i'); 
      tags[a].removeAttribute('data-p'); 
      tags[a].removeAttribute('data-subquery'); 
      tags[a].removeAttribute('data-ordem'); 
      tags[a].removeAttribute('data-valor'); 
      if(tags[a].innerHTML.indexOf('!important') != -1){ 
        tags[a].parentNode.removeChild(tags[a]); 
      } 
    } 
  }

  for(let a=0;a<tagslength-1;a++){ 
    if(tags[a]){
      if(tags[a].classList.contains('setadown') || tags[a].classList.contains('seta')){
        tags[a].remove();
        continue;
      }
    }
  }


  var ctx = {worksheet: 'Consulta', table: virtualtable.innerHTML}
  if (navigator.msSaveBlob) { // IE10
  return navigator.msSaveBlob(new Blob([format(template, ctx)], {type: uri}), x.substr(0, x.length-1)+'.xls');
  } else {
    document.getElementById('excel').href = uri + window.btoa(unescape(encodeURIComponent(format(template, ctx).replace(/&amp;/g, 'E').replace(/&/g, 'E').replace(/onclick="" class="dir" data-p=""/g, '').replace(/´/g, ' ').replace(/onclick=""/g, '').replace(/class="setadown" data-subquery=""/g, ''))));

    document.getElementById('excel').download = x.substr(0, x.length-1)+'.xls';
    document.getElementById('excel').click();

    //call('excel_log', 'prm_usuario='+usuario+'&prm_objeto='+nome+'&prm_id='+x, 'PROCEDURE');

    setTimeout(function(){
      main.removeChild(excel);
    }, 1000);
  }
}




/* BOTÃO DO LOGIN */
function login(dis){
  var menu     = document.getElementById('login-menu');
  var login    = menu.querySelectorAll('.login-session')[0];
  var pass     = menu.querySelectorAll('.login-session')[1];

  menu.className = 'loading'; 

  if(login.value.trim().length == 0 || pass.value.trim().length == 0){ 
    menu.className = 'shake'; 
    alerta('x', TR_TC);
    pass.value = ''; 
    setTimeout(function(){ 
      menu.className = ''; 
    }, 300); 

  } else { 

    let d = new Date();
    let ran = d.getSeconds()+''+parseInt(Math.random(1)*100)+''+d.getMinutes()+''+parseInt(Math.random(1)*100)+d.getHours()+''+parseInt(Math.random(1)*100)+''+d.getDate();

    var caminho  = window.document.location.pathname.split('/');
    var endpoint = caminho[caminho.length-2]+'/';
    var url_local = 'http://'+(window.document.location.host+'/'+endpoint).replace('//', '/');

    //validando, envia o tempo de sessao, 0.83 aprox 20h
    //cookie passou a ser criado a nivel de backend
    call('login', 'prm_user='+encodeURIComponent(login.value)+'&prm_password='+encodeURIComponent(pass.value)+'&prm_session=&prm_prazo=0.5'+'&prm_url='+url_local).then(function(resposta){

      //if invalido
      if(resposta.indexOf('erro') != -1 || resposta.indexOf('sem acesso') != -1 ||  resposta.indexOf('esta cadastrado') != -1 || resposta.indexOf('LOGINVALIDA') != -1) {
        //shake
        menu.className = 'shake'; 
        pass.value = '';
        setTimeout(function(){ 
          menu.className = ''; 
        }, 300);
          
        if(resposta.indexOf('erro') !== -1){
          alerta('x', TR_US_IN);
        } else if (resposta.indexOf('sem acesso') !== -1) {
          alerta('x', TR_SP);
        } else if (resposta.indexOf('LOGINVALIDA') !== -1) {
          if (resposta.indexOf('LOGINVALIDA-OK') !== -1) {
            alerta('alert', TR_LO_VA );
          } else {
            alerta('x', resposta.replace('LOGINVALIDA-ERRO',''));
          }  
        } else {
          alerta('x', 'ERRO: '+resposta);
        }
      } else {
        alerta('x', TR_LE);
        menu.className = 'logged'; 
        //tempo para ler msg, criar cookie e então recarregar tela já devidamente logado
        setTimeout(function(){ 
          //20h max-age=72000; encerra antes do horario comercial seguinte, 24h max-age=86400;, meia-hora max-age=1800;
          //document.cookie = "SESSION="+resposta+"; path=/; max-age=72000; SameSite=Strict";
          window.location.reload(true);
        }, 500);
      }
    });
  } 
}

